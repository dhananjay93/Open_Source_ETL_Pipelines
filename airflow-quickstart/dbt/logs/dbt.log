[0m17:57:44.927076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063edf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106417410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106417b10>]}


============================== 17:57:44.930416 | 0249eff9-610d-46d5-9230-daf856300241 ==============================
[0m17:57:44.930416 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:57:44.930742 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt', 'quiet': 'False', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/logs', 'indirect_selection': 'eager', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'printer_width': '80', 'no_print': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'empty': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'debug': 'False', 'write_json': 'True'}
[0m17:57:44.944957 [info ] [MainThread]: dbt version: 1.10.10
[0m17:57:44.945179 [info ] [MainThread]: python version: 3.11.5
[0m17:57:44.945343 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m17:57:44.945483 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m17:57:45.226601 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt
[0m17:57:45.226919 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/profiles.yml
[0m17:57:45.227094 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/dbt_project.yml
[0m17:57:45.227543 [info ] [MainThread]: adapter type: postgres
[0m17:57:45.227748 [info ] [MainThread]: adapter version: 1.8.2
[0m17:57:45.292241 [info ] [MainThread]: Configuration:
[0m17:57:45.292575 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:57:45.292723 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:57:45.292854 [info ] [MainThread]: Required dependencies:
[0m17:57:45.293297 [debug] [MainThread]: Executing "git --help"
[0m17:57:45.324651 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:57:45.325275 [debug] [MainThread]: STDERR: "b''"
[0m17:57:45.325464 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:57:45.325644 [info ] [MainThread]: Connection:
[0m17:57:45.325819 [info ] [MainThread]:   host: postgres
[0m17:57:45.325978 [info ] [MainThread]:   port: 5432
[0m17:57:45.326175 [info ] [MainThread]:   user: postgres
[0m17:57:45.326307 [info ] [MainThread]:   database: staging
[0m17:57:45.326429 [info ] [MainThread]:   schema: public
[0m17:57:45.326545 [info ] [MainThread]:   connect_timeout: 10
[0m17:57:45.326663 [info ] [MainThread]:   role: None
[0m17:57:45.326781 [info ] [MainThread]:   search_path: None
[0m17:57:45.326891 [info ] [MainThread]:   keepalives_idle: 0
[0m17:57:45.327003 [info ] [MainThread]:   sslmode: None
[0m17:57:45.327116 [info ] [MainThread]:   sslcert: None
[0m17:57:45.327230 [info ] [MainThread]:   sslkey: None
[0m17:57:45.327342 [info ] [MainThread]:   sslrootcert: None
[0m17:57:45.327459 [info ] [MainThread]:   application_name: dbt
[0m17:57:45.327568 [info ] [MainThread]:   retries: 1
[0m17:57:45.327882 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:57:45.387258 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:57:45.468458 [debug] [MainThread]: Using postgres connection "debug"
[0m17:57:45.468731 [debug] [MainThread]: On debug: select 1 as id
[0m17:57:45.468863 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:45.595930 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m17:57:45.599077 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m17:57:45.599222 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m17:57:45.599407 [debug] [MainThread]: On debug: No close available on handle
[0m17:57:45.599613 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m17:57:45.599798 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:57:45.599931 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m17:57:45.624680 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.7534907, "process_in_blocks": "0", "process_kernel_time": 0.292686, "process_mem_max_rss": "120782848", "process_out_blocks": "0", "process_user_time": 0.819974}
[0m17:57:45.625165 [debug] [MainThread]: Command `dbt debug` failed at 17:57:45.625092 after 0.75 seconds
[0m17:57:45.625420 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:57:45.625662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101010f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10636fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a11050>]}
[0m17:57:45.625953 [debug] [MainThread]: Flushing usage events
[0m17:57:47.441412 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:17.286886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11153f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115b8f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077f3e90>]}


============================== 17:59:17.290164 | 0f0a6e3c-0553-4dea-8b64-ca8f428840d7 ==============================
[0m17:59:17.290164 [info ] [MainThread]: Running with dbt=1.10.10
[0m17:59:17.290496 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'warn_error': 'None', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/logs', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt', 'partial_parse': 'True', 'introspect': 'True', 'static_parser': 'True', 'printer_width': '80', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_cache_events': 'False', 'debug': 'False', 'invocation_command': 'dbt debug', 'version_check': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:59:17.304961 [info ] [MainThread]: dbt version: 1.10.10
[0m17:59:17.305269 [info ] [MainThread]: python version: 3.11.5
[0m17:59:17.305464 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m17:59:17.305611 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m17:59:17.362750 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt
[0m17:59:17.363077 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/profiles.yml
[0m17:59:17.363228 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/dbt_project.yml
[0m17:59:17.363830 [info ] [MainThread]: adapter type: postgres
[0m17:59:17.364006 [info ] [MainThread]: adapter version: 1.8.2
[0m17:59:17.420880 [info ] [MainThread]: Configuration:
[0m17:59:17.421216 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:59:17.421379 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:59:17.421511 [info ] [MainThread]: Required dependencies:
[0m17:59:17.421968 [debug] [MainThread]: Executing "git --help"
[0m17:59:17.459688 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:59:17.460388 [debug] [MainThread]: STDERR: "b''"
[0m17:59:17.460578 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:59:17.460773 [info ] [MainThread]: Connection:
[0m17:59:17.460957 [info ] [MainThread]:   host: localhost
[0m17:59:17.461183 [info ] [MainThread]:   port: 5432
[0m17:59:17.461349 [info ] [MainThread]:   user: postgres
[0m17:59:17.461478 [info ] [MainThread]:   database: staging
[0m17:59:17.461606 [info ] [MainThread]:   schema: public
[0m17:59:17.461730 [info ] [MainThread]:   connect_timeout: 10
[0m17:59:17.461852 [info ] [MainThread]:   role: None
[0m17:59:17.461974 [info ] [MainThread]:   search_path: None
[0m17:59:17.462094 [info ] [MainThread]:   keepalives_idle: 0
[0m17:59:17.462215 [info ] [MainThread]:   sslmode: None
[0m17:59:17.462334 [info ] [MainThread]:   sslcert: None
[0m17:59:17.462446 [info ] [MainThread]:   sslkey: None
[0m17:59:17.462568 [info ] [MainThread]:   sslrootcert: None
[0m17:59:17.462688 [info ] [MainThread]:   application_name: dbt
[0m17:59:17.462799 [info ] [MainThread]:   retries: 1
[0m17:59:17.463265 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m17:59:17.515707 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m17:59:17.562370 [debug] [MainThread]: Using postgres connection "debug"
[0m17:59:17.562612 [debug] [MainThread]: On debug: select 1 as id
[0m17:59:17.562757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:17.679562 [debug] [MainThread]: SQL status: SELECT 1 in 0.117 seconds
[0m17:59:17.680246 [debug] [MainThread]: On debug: Close
[0m17:59:17.680460 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:59:17.680650 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:59:17.683351 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.453213, "process_in_blocks": "0", "process_kernel_time": 0.270062, "process_mem_max_rss": "125337600", "process_out_blocks": "0", "process_user_time": 0.815737}
[0m17:59:17.683735 [debug] [MainThread]: Command `dbt debug` succeeded at 17:59:17.683677 after 0.45 seconds
[0m17:59:17.683928 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:59:17.684133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11153d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11153e2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121e9690>]}
[0m17:59:17.684361 [debug] [MainThread]: Flushing usage events
[0m17:59:19.394135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:01:26.768407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099608d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099cfe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ffd50>]}


============================== 18:01:26.771818 | 475fe407-546f-4647-98d8-b627a0aa05a2 ==============================
[0m18:01:26.771818 [info ] [MainThread]: Running with dbt=1.10.10
[0m18:01:26.772149 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/logs', 'invocation_command': 'dbt run', 'fail_fast': 'False', 'version_check': 'True', 'empty': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt', 'log_format': 'default'}
[0m18:01:27.180739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '475fe407-546f-4647-98d8-b627a0aa05a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109961f50>]}
[0m18:01:27.215312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '475fe407-546f-4647-98d8-b627a0aa05a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10719c090>]}
[0m18:01:27.216122 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:01:27.267277 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m18:01:27.268034 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:01:27.268276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '475fe407-546f-4647-98d8-b627a0aa05a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099dab10>]}
[0m18:01:27.741568 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.elt_assignment.gold
[0m18:01:27.744369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '475fe407-546f-4647-98d8-b627a0aa05a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6c1c10>]}
[0m18:01:27.773061 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/manifest.json
[0m18:01:27.775150 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/semantic_manifest.json
[0m18:01:27.790918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '475fe407-546f-4647-98d8-b627a0aa05a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997d010>]}
[0m18:01:27.791223 [info ] [MainThread]: Found 2 models, 433 macros
[0m18:01:27.791387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '475fe407-546f-4647-98d8-b627a0aa05a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f4da50>]}
[0m18:01:27.792052 [info ] [MainThread]: 
[0m18:01:27.792232 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:01:27.792362 [info ] [MainThread]: 
[0m18:01:27.792596 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:01:27.794492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m18:01:27.794836 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m18:01:27.879224 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m18:01:27.879549 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m18:01:27.879806 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m18:01:27.880012 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m18:01:27.880175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:27.880320 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:27.918247 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.038 seconds
[0m18:01:27.918490 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.038 seconds
[0m18:01:27.919189 [debug] [ThreadPool]: On list_staging: Close
[0m18:01:27.919690 [debug] [ThreadPool]: On list_staging: Close
[0m18:01:27.920149 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_bronze)
[0m18:01:27.920374 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_bronze"
"
[0m18:01:27.922901 [debug] [ThreadPool]: Using postgres connection "create_staging_public_bronze"
[0m18:01:27.923079 [debug] [ThreadPool]: On create_staging_public_bronze: BEGIN
[0m18:01:27.923397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_silver)
[0m18:01:27.923573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:27.923763 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_silver"
"
[0m18:01:27.924948 [debug] [ThreadPool]: Using postgres connection "create_staging_public_silver"
[0m18:01:27.925127 [debug] [ThreadPool]: On create_staging_public_silver: BEGIN
[0m18:01:27.925253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:27.931992 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m18:01:27.932163 [debug] [ThreadPool]: Using postgres connection "create_staging_public_bronze"
[0m18:01:27.932293 [debug] [ThreadPool]: On create_staging_public_bronze: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "create_staging_public_bronze"} */
create schema if not exists "public_bronze"
[0m18:01:27.933169 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m18:01:27.933756 [debug] [ThreadPool]: On create_staging_public_bronze: COMMIT
[0m18:01:27.933957 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m18:01:27.934235 [debug] [ThreadPool]: Using postgres connection "create_staging_public_bronze"
[0m18:01:27.934390 [debug] [ThreadPool]: Using postgres connection "create_staging_public_silver"
[0m18:01:27.934528 [debug] [ThreadPool]: On create_staging_public_bronze: COMMIT
[0m18:01:27.934725 [debug] [ThreadPool]: On create_staging_public_silver: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "create_staging_public_silver"} */
create schema if not exists "public_silver"
[0m18:01:27.935687 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m18:01:27.936163 [debug] [ThreadPool]: On create_staging_public_silver: COMMIT
[0m18:01:27.936318 [debug] [ThreadPool]: Using postgres connection "create_staging_public_silver"
[0m18:01:27.936473 [debug] [ThreadPool]: On create_staging_public_silver: COMMIT
[0m18:01:27.936660 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m18:01:27.936826 [debug] [ThreadPool]: On create_staging_public_bronze: Close
[0m18:01:27.937389 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m18:01:27.937623 [debug] [ThreadPool]: On create_staging_public_silver: Close
[0m18:01:27.938367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_silver, now list_staging_public_bronze)
[0m18:01:27.941122 [debug] [ThreadPool]: Using postgres connection "list_staging_public_bronze"
[0m18:01:27.941442 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_bronze, now list_staging_public_silver)
[0m18:01:27.941694 [debug] [ThreadPool]: On list_staging_public_bronze: BEGIN
[0m18:01:27.942784 [debug] [ThreadPool]: Using postgres connection "list_staging_public_silver"
[0m18:01:27.942937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:27.943066 [debug] [ThreadPool]: On list_staging_public_silver: BEGIN
[0m18:01:27.943302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:01:27.954104 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:01:27.954395 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:01:27.954630 [debug] [ThreadPool]: Using postgres connection "list_staging_public_bronze"
[0m18:01:27.954880 [debug] [ThreadPool]: Using postgres connection "list_staging_public_silver"
[0m18:01:27.955101 [debug] [ThreadPool]: On list_staging_public_bronze: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging_public_bronze"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m18:01:27.955334 [debug] [ThreadPool]: On list_staging_public_silver: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging_public_silver"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m18:01:27.958395 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m18:01:27.958644 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m18:01:27.959308 [debug] [ThreadPool]: On list_staging_public_silver: ROLLBACK
[0m18:01:27.959883 [debug] [ThreadPool]: On list_staging_public_bronze: ROLLBACK
[0m18:01:27.960421 [debug] [ThreadPool]: On list_staging_public_bronze: Close
[0m18:01:27.960598 [debug] [ThreadPool]: On list_staging_public_silver: Close
[0m18:01:27.963162 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:27.963369 [debug] [MainThread]: On master: BEGIN
[0m18:01:27.963504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:27.970418 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:01:27.970660 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:27.970875 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:01:27.976792 [debug] [MainThread]: SQL status: SELECT 29 in 0.006 seconds
[0m18:01:27.977693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '475fe407-546f-4647-98d8-b627a0aa05a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b1210>]}
[0m18:01:27.977945 [debug] [MainThread]: On master: ROLLBACK
[0m18:01:27.978529 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:27.978686 [debug] [MainThread]: On master: BEGIN
[0m18:01:27.979533 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:01:27.979678 [debug] [MainThread]: On master: COMMIT
[0m18:01:27.979800 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:27.979913 [debug] [MainThread]: On master: COMMIT
[0m18:01:27.980347 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:01:27.980483 [debug] [MainThread]: On master: Close
[0m18:01:27.984831 [debug] [Thread-1 (]: Began running node model.elt_assignment.customers_clean
[0m18:01:27.985362 [info ] [Thread-1 (]: 1 of 2 START sql table model public_silver.customers_clean ..................... [RUN]
[0m18:01:27.986101 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_bronze, now model.elt_assignment.customers_clean)
[0m18:01:27.986567 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_raw
[0m18:01:27.987211 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customers_clean
[0m18:01:27.987943 [info ] [Thread-2 (]: 2 of 2 START sql table model public_bronze.customers_raw ....................... [RUN]
[0m18:01:27.991711 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m18:01:27.992294 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_staging_public_silver, now model.elt_assignment.customers_raw)
[0m18:01:27.993166 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_raw
[0m18:01:27.994168 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m18:01:27.996331 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_raw
[0m18:01:28.009744 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customers_clean
[0m18:01:28.015935 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m18:01:28.017892 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m18:01:28.019916 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:01:28.020111 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: BEGIN
[0m18:01:28.020267 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:01:28.020534 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:01:28.020711 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: BEGIN
[0m18:01:28.020859 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:28.033804 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m18:01:28.034146 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m18:01:28.034412 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:01:28.034583 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:01:28.034748 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "staging"."public_bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m18:01:28.035061 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "staging"."public_silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m18:01:28.039266 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.004 seconds
[0m18:01:28.044220 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:01:28.044424 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.009 seconds
[0m18:01:28.044626 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "staging"."public_bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m18:01:28.046111 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:01:28.046356 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "staging"."public_silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m18:01:28.046938 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:01:28.047177 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:01:28.053716 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: COMMIT
[0m18:01:28.054371 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: COMMIT
[0m18:01:28.054559 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:01:28.054716 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:01:28.054861 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: COMMIT
[0m18:01:28.055007 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: COMMIT
[0m18:01:28.058625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:01:28.061422 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_silver"."customers_clean__dbt_backup"
[0m18:01:28.063542 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:01:28.063715 [debug] [Thread-2 (]: SQL status: COMMIT in 0.009 seconds
[0m18:01:28.063907 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "staging"."public_silver"."customers_clean__dbt_backup" cascade
[0m18:01:28.064977 [debug] [Thread-2 (]: Applying DROP to: "staging"."public_bronze"."customers_raw__dbt_backup"
[0m18:01:28.065351 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:01:28.065521 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "staging"."public_bronze"."customers_raw__dbt_backup" cascade
[0m18:01:28.065697 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:01:28.066820 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: Close
[0m18:01:28.067006 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:01:28.068236 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: Close
[0m18:01:28.069098 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '475fe407-546f-4647-98d8-b627a0aa05a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab27f50>]}
[0m18:01:28.069475 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public_silver.customers_clean ................ [[32mSELECT 1000[0m in 0.08s]
[0m18:01:28.069725 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '475fe407-546f-4647-98d8-b627a0aa05a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a739690>]}
[0m18:01:28.070017 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customers_clean
[0m18:01:28.070337 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public_bronze.customers_raw .................. [[32mSELECT 1000[0m in 0.08s]
[0m18:01:28.070632 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_raw
[0m18:01:28.071317 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:28.071501 [debug] [MainThread]: On master: BEGIN
[0m18:01:28.071627 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:01:28.078376 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:01:28.078561 [debug] [MainThread]: On master: COMMIT
[0m18:01:28.078699 [debug] [MainThread]: Using postgres connection "master"
[0m18:01:28.078821 [debug] [MainThread]: On master: COMMIT
[0m18:01:28.079335 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:01:28.079459 [debug] [MainThread]: On master: Close
[0m18:01:28.079639 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:28.079759 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m18:01:28.079874 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m18:01:28.080036 [info ] [MainThread]: 
[0m18:01:28.080184 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m18:01:28.080521 [debug] [MainThread]: Command end result
[0m18:01:28.091176 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/manifest.json
[0m18:01:28.093463 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/semantic_manifest.json
[0m18:01:28.099062 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/run_results.json
[0m18:01:28.099349 [info ] [MainThread]: 
[0m18:01:28.099548 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:01:28.100301 [info ] [MainThread]: 
[0m18:01:28.100544 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:01:28.104570 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3864378, "process_in_blocks": "0", "process_kernel_time": 0.385907, "process_mem_max_rss": "139051008", "process_out_blocks": "0", "process_user_time": 1.491303}
[0m18:01:28.104962 [debug] [MainThread]: Command `dbt run` succeeded at 18:01:28.104915 after 1.39 seconds
[0m18:01:28.105171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ffe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099ffd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105920f50>]}
[0m18:01:28.105369 [debug] [MainThread]: Flushing usage events
[0m18:01:29.961283 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:15.038077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f03350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f779d0>]}


============================== 18:03:15.041418 | 89eda4cc-79a1-4816-b07d-c982308911ed ==============================
[0m18:03:15.041418 [info ] [MainThread]: Running with dbt=1.10.10
[0m18:03:15.041746 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'quiet': 'False', 'static_parser': 'True', 'empty': 'None', 'introspect': 'True', 'target_path': 'None', 'printer_width': '80', 'no_print': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'log_format': 'default', 'debug': 'False'}
[0m18:03:15.055098 [info ] [MainThread]: dbt version: 1.10.10
[0m18:03:15.055336 [info ] [MainThread]: python version: 3.11.5
[0m18:03:15.055503 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m18:03:15.055650 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m18:03:15.107194 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt
[0m18:03:15.107513 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/profiles.yml
[0m18:03:15.107668 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/dbt_project.yml
[0m18:03:15.108289 [info ] [MainThread]: adapter type: postgres
[0m18:03:15.108480 [info ] [MainThread]: adapter version: 1.8.2
[0m18:03:15.110106 [info ] [MainThread]: Configuration:
[0m18:03:15.110276 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:03:15.110408 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m18:03:15.110533 [info ] [MainThread]: Required dependencies:
[0m18:03:15.110783 [debug] [MainThread]: Executing "git --help"
[0m18:03:15.143988 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:03:15.144595 [debug] [MainThread]: STDERR: "b''"
[0m18:03:15.144789 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:03:15.144966 [info ] [MainThread]: Connection:
[0m18:03:15.145133 [info ] [MainThread]:   host: localhost
[0m18:03:15.145255 [info ] [MainThread]:   port: 5432
[0m18:03:15.145366 [info ] [MainThread]:   user: postgres
[0m18:03:15.145479 [info ] [MainThread]:   database: staging
[0m18:03:15.145587 [info ] [MainThread]:   schema: public
[0m18:03:15.145696 [info ] [MainThread]:   connect_timeout: 10
[0m18:03:15.145808 [info ] [MainThread]:   role: None
[0m18:03:15.145922 [info ] [MainThread]:   search_path: None
[0m18:03:15.146029 [info ] [MainThread]:   keepalives_idle: 0
[0m18:03:15.146135 [info ] [MainThread]:   sslmode: None
[0m18:03:15.146258 [info ] [MainThread]:   sslcert: None
[0m18:03:15.146363 [info ] [MainThread]:   sslkey: None
[0m18:03:15.146472 [info ] [MainThread]:   sslrootcert: None
[0m18:03:15.146581 [info ] [MainThread]:   application_name: dbt
[0m18:03:15.146692 [info ] [MainThread]:   retries: 1
[0m18:03:15.146987 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:03:15.194947 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:03:15.241327 [debug] [MainThread]: Using postgres connection "debug"
[0m18:03:15.241590 [debug] [MainThread]: On debug: select 1 as id
[0m18:03:15.241738 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:15.276014 [debug] [MainThread]: SQL status: SELECT 1 in 0.034 seconds
[0m18:03:15.276593 [debug] [MainThread]: On debug: Close
[0m18:03:15.276774 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:03:15.276940 [info ] [MainThread]: [31m1 check failed:[0m
[0m18:03:15.277076 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  Required "name" field not present in project

Error encountered in /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/dbt_project.yml


[0m18:03:15.279378 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.29338762, "process_in_blocks": "0", "process_kernel_time": 0.259869, "process_mem_max_rss": "123371520", "process_out_blocks": "0", "process_user_time": 0.731243}
[0m18:03:15.279698 [debug] [MainThread]: Command `dbt debug` failed at 18:03:15.279643 after 0.29 seconds
[0m18:03:15.279880 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:03:15.280056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101049090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10710e9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e5b50>]}
[0m18:03:15.280248 [debug] [MainThread]: Flushing usage events
[0m18:03:17.173074 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:45.286773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddbbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e29450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e7bb50>]}


============================== 18:03:45.290082 | 5527fba8-fe53-4be1-850a-028af4d48e2c ==============================
[0m18:03:45.290082 [info ] [MainThread]: Running with dbt=1.10.10
[0m18:03:45.290476 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/logs', 'use_colors': 'True', 'static_parser': 'True', 'log_format': 'default', 'use_experimental_parser': 'False', 'printer_width': '80', 'invocation_command': 'dbt debug', 'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt', 'fail_fast': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'empty': 'None', 'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True'}
[0m18:03:45.301220 [info ] [MainThread]: dbt version: 1.10.10
[0m18:03:45.301531 [info ] [MainThread]: python version: 3.11.5
[0m18:03:45.301709 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m18:03:45.301852 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m18:03:45.354666 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt
[0m18:03:45.355038 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/profiles.yml
[0m18:03:45.355197 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/dbt_project.yml
[0m18:03:45.355759 [info ] [MainThread]: adapter type: postgres
[0m18:03:45.355941 [info ] [MainThread]: adapter version: 1.8.2
[0m18:03:45.413822 [info ] [MainThread]: Configuration:
[0m18:03:45.414160 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:03:45.414303 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:03:45.414431 [info ] [MainThread]: Required dependencies:
[0m18:03:45.414894 [debug] [MainThread]: Executing "git --help"
[0m18:03:45.455253 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:03:45.456453 [debug] [MainThread]: STDERR: "b''"
[0m18:03:45.456742 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:03:45.456985 [info ] [MainThread]: Connection:
[0m18:03:45.457192 [info ] [MainThread]:   host: localhost
[0m18:03:45.457322 [info ] [MainThread]:   port: 5432
[0m18:03:45.457448 [info ] [MainThread]:   user: postgres
[0m18:03:45.457569 [info ] [MainThread]:   database: staging
[0m18:03:45.457684 [info ] [MainThread]:   schema: public
[0m18:03:45.457796 [info ] [MainThread]:   connect_timeout: 10
[0m18:03:45.457914 [info ] [MainThread]:   role: None
[0m18:03:45.458027 [info ] [MainThread]:   search_path: None
[0m18:03:45.458136 [info ] [MainThread]:   keepalives_idle: 0
[0m18:03:45.458252 [info ] [MainThread]:   sslmode: None
[0m18:03:45.458542 [info ] [MainThread]:   sslcert: None
[0m18:03:45.458740 [info ] [MainThread]:   sslkey: None
[0m18:03:45.458875 [info ] [MainThread]:   sslrootcert: None
[0m18:03:45.459017 [info ] [MainThread]:   application_name: dbt
[0m18:03:45.459137 [info ] [MainThread]:   retries: 1
[0m18:03:45.459537 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:03:45.508355 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:03:45.565932 [debug] [MainThread]: Using postgres connection "debug"
[0m18:03:45.566196 [debug] [MainThread]: On debug: select 1 as id
[0m18:03:45.566347 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:03:45.601847 [debug] [MainThread]: SQL status: SELECT 1 in 0.035 seconds
[0m18:03:45.602402 [debug] [MainThread]: On debug: Close
[0m18:03:45.602581 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:03:45.602741 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:03:45.604895 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.3736455, "process_in_blocks": "0", "process_kernel_time": 0.256725, "process_mem_max_rss": "123305984", "process_out_blocks": "0", "process_user_time": 0.806359}
[0m18:03:45.605221 [debug] [MainThread]: Command `dbt debug` succeeded at 18:03:45.605167 after 0.37 seconds
[0m18:03:45.605389 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:03:45.605565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d25090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10993dc50>]}
[0m18:03:45.605754 [debug] [MainThread]: Flushing usage events
[0m18:03:47.213757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:45.749639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057878d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105816e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105817510>]}


============================== 18:04:45.753007 | d9e0503d-ae4a-4faf-aaad-6aee26304514 ==============================
[0m18:04:45.753007 [info ] [MainThread]: Running with dbt=1.10.10
[0m18:04:45.753337 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/logs', 'use_colors': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'quiet': 'False', 'version_check': 'True', 'introspect': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt', 'use_experimental_parser': 'False', 'no_print': 'None', 'printer_width': '80', 'empty': 'False'}
[0m18:04:46.076140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9e0503d-ae4a-4faf-aaad-6aee26304514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3bb90>]}
[0m18:04:46.110456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9e0503d-ae4a-4faf-aaad-6aee26304514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fbcf50>]}
[0m18:04:46.111377 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:04:46.167896 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m18:04:46.209010 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:04:46.209342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd9e0503d-ae4a-4faf-aaad-6aee26304514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e8710>]}
[0m18:04:46.648996 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.elt_assignment.gold
[0m18:04:46.651194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9e0503d-ae4a-4faf-aaad-6aee26304514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036a0f50>]}
[0m18:04:46.677334 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/manifest.json
[0m18:04:46.679446 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/semantic_manifest.json
[0m18:04:46.695429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9e0503d-ae4a-4faf-aaad-6aee26304514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106628450>]}
[0m18:04:46.695726 [info ] [MainThread]: Found 2 models, 433 macros
[0m18:04:46.695897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9e0503d-ae4a-4faf-aaad-6aee26304514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b5f50>]}
[0m18:04:46.696560 [info ] [MainThread]: 
[0m18:04:46.696722 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:04:46.696856 [info ] [MainThread]: 
[0m18:04:46.697093 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:04:46.698934 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m18:04:46.699264 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m18:04:46.764962 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m18:04:46.765179 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m18:04:46.765373 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m18:04:46.765528 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m18:04:46.765670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:46.765799 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:04:46.805448 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.040 seconds
[0m18:04:46.805682 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.040 seconds
[0m18:04:46.806425 [debug] [ThreadPool]: On list_staging: Close
[0m18:04:46.807016 [debug] [ThreadPool]: On list_staging: Close
[0m18:04:46.807512 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_bronze)
[0m18:04:46.807711 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now create_staging_public_silver)
[0m18:04:46.807951 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_bronze"
"
[0m18:04:46.808175 [debug] [ThreadPool]: Creating schema "database: "staging"
schema: "public_silver"
"
[0m18:04:46.810825 [debug] [ThreadPool]: Using postgres connection "create_staging_public_bronze"
[0m18:04:46.811828 [debug] [ThreadPool]: Using postgres connection "create_staging_public_silver"
[0m18:04:46.811972 [debug] [ThreadPool]: On create_staging_public_bronze: BEGIN
[0m18:04:46.812107 [debug] [ThreadPool]: On create_staging_public_silver: BEGIN
[0m18:04:46.812225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:46.812353 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:46.823016 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:04:46.823352 [debug] [ThreadPool]: Using postgres connection "create_staging_public_silver"
[0m18:04:46.823555 [debug] [ThreadPool]: On create_staging_public_silver: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "create_staging_public_silver"} */
create schema if not exists "public_silver"
[0m18:04:46.823737 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:04:46.823920 [debug] [ThreadPool]: Using postgres connection "create_staging_public_bronze"
[0m18:04:46.824061 [debug] [ThreadPool]: On create_staging_public_bronze: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "create_staging_public_bronze"} */
create schema if not exists "public_bronze"
[0m18:04:46.824369 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m18:04:46.824951 [debug] [ThreadPool]: On create_staging_public_silver: COMMIT
[0m18:04:46.825129 [debug] [ThreadPool]: Using postgres connection "create_staging_public_silver"
[0m18:04:46.825256 [debug] [ThreadPool]: On create_staging_public_silver: COMMIT
[0m18:04:46.825406 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m18:04:46.825840 [debug] [ThreadPool]: On create_staging_public_bronze: COMMIT
[0m18:04:46.826072 [debug] [ThreadPool]: Using postgres connection "create_staging_public_bronze"
[0m18:04:46.826262 [debug] [ThreadPool]: On create_staging_public_bronze: COMMIT
[0m18:04:46.826433 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m18:04:46.826583 [debug] [ThreadPool]: On create_staging_public_silver: Close
[0m18:04:46.826999 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m18:04:46.827143 [debug] [ThreadPool]: On create_staging_public_bronze: Close
[0m18:04:46.827774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_silver, now list_staging_public_bronze)
[0m18:04:46.828001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_staging_public_bronze, now list_staging_public_silver)
[0m18:04:46.831011 [debug] [ThreadPool]: Using postgres connection "list_staging_public_bronze"
[0m18:04:46.832191 [debug] [ThreadPool]: Using postgres connection "list_staging_public_silver"
[0m18:04:46.832370 [debug] [ThreadPool]: On list_staging_public_bronze: BEGIN
[0m18:04:46.832492 [debug] [ThreadPool]: On list_staging_public_silver: BEGIN
[0m18:04:46.832620 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:46.832738 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:04:46.843643 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:04:46.843859 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m18:04:46.844102 [debug] [ThreadPool]: Using postgres connection "list_staging_public_silver"
[0m18:04:46.844230 [debug] [ThreadPool]: Using postgres connection "list_staging_public_bronze"
[0m18:04:46.844379 [debug] [ThreadPool]: On list_staging_public_silver: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging_public_silver"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_silver'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_silver'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_silver'
  
[0m18:04:46.844541 [debug] [ThreadPool]: On list_staging_public_bronze: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging_public_bronze"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_bronze'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_bronze'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_bronze'
  
[0m18:04:46.847400 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m18:04:46.847611 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m18:04:46.848250 [debug] [ThreadPool]: On list_staging_public_bronze: ROLLBACK
[0m18:04:46.848725 [debug] [ThreadPool]: On list_staging_public_silver: ROLLBACK
[0m18:04:46.849169 [debug] [ThreadPool]: On list_staging_public_bronze: Close
[0m18:04:46.849330 [debug] [ThreadPool]: On list_staging_public_silver: Close
[0m18:04:46.851693 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:46.851867 [debug] [MainThread]: On master: BEGIN
[0m18:04:46.851983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:04:46.858409 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:04:46.858624 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:46.858820 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:04:46.866213 [debug] [MainThread]: SQL status: SELECT 29 in 0.007 seconds
[0m18:04:46.867077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9e0503d-ae4a-4faf-aaad-6aee26304514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddad50>]}
[0m18:04:46.867350 [debug] [MainThread]: On master: ROLLBACK
[0m18:04:46.867789 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:46.867929 [debug] [MainThread]: On master: BEGIN
[0m18:04:46.868641 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:04:46.868887 [debug] [MainThread]: On master: COMMIT
[0m18:04:46.869037 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:46.869166 [debug] [MainThread]: On master: COMMIT
[0m18:04:46.869591 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:46.869772 [debug] [MainThread]: On master: Close
[0m18:04:46.872477 [debug] [Thread-1 (]: Began running node model.elt_assignment.customers_clean
[0m18:04:46.872681 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_raw
[0m18:04:46.872962 [info ] [Thread-1 (]: 1 of 2 START sql table model public_silver.customers_clean ..................... [RUN]
[0m18:04:46.873229 [info ] [Thread-2 (]: 2 of 2 START sql table model public_bronze.customers_raw ....................... [RUN]
[0m18:04:46.873495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_public_bronze, now model.elt_assignment.customers_clean)
[0m18:04:46.873740 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_staging_public_silver, now model.elt_assignment.customers_raw)
[0m18:04:46.873938 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customers_clean
[0m18:04:46.874092 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_raw
[0m18:04:46.877294 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m18:04:46.878213 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m18:04:46.879045 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customers_clean
[0m18:04:46.891005 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_raw
[0m18:04:46.898243 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m18:04:46.900050 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m18:04:46.901407 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:04:46.901608 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: BEGIN
[0m18:04:46.901764 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:04:46.902110 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:04:46.902291 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: BEGIN
[0m18:04:46.902436 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:04:46.913153 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m18:04:46.913466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m18:04:46.913715 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:04:46.914040 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:04:46.914258 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "staging"."public_bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m18:04:46.914509 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "staging"."public_silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m18:04:46.918552 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.004 seconds
[0m18:04:46.923224 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:04:46.923416 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.009 seconds
[0m18:04:46.923623 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "staging"."public_bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m18:04:46.925101 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:04:46.925312 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "staging"."public_silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m18:04:46.925722 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:46.925874 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:04:46.932254 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: COMMIT
[0m18:04:46.932844 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: COMMIT
[0m18:04:46.933023 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:04:46.933185 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:04:46.933328 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: COMMIT
[0m18:04:46.933467 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: COMMIT
[0m18:04:46.935259 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:04:46.935489 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m18:04:46.938350 [debug] [Thread-1 (]: Applying DROP to: "staging"."public_silver"."customers_clean__dbt_backup"
[0m18:04:46.939480 [debug] [Thread-2 (]: Applying DROP to: "staging"."public_bronze"."customers_raw__dbt_backup"
[0m18:04:46.941734 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:04:46.942073 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:04:46.942257 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "staging"."public_silver"."customers_clean__dbt_backup" cascade
[0m18:04:46.942445 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "staging"."public_bronze"."customers_raw__dbt_backup" cascade
[0m18:04:46.943060 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:04:46.943221 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:04:46.944387 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: Close
[0m18:04:46.944990 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: Close
[0m18:04:46.946449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e0503d-ae4a-4faf-aaad-6aee26304514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bf8350>]}
[0m18:04:46.946683 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9e0503d-ae4a-4faf-aaad-6aee26304514', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad5a90>]}
[0m18:04:46.947075 [info ] [Thread-2 (]: 2 of 2 OK created sql table model public_bronze.customers_raw .................. [[32mSELECT 1000[0m in 0.07s]
[0m18:04:46.947409 [info ] [Thread-1 (]: 1 of 2 OK created sql table model public_silver.customers_clean ................ [[32mSELECT 1000[0m in 0.07s]
[0m18:04:46.947688 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_raw
[0m18:04:46.947908 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customers_clean
[0m18:04:46.948662 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:46.948842 [debug] [MainThread]: On master: BEGIN
[0m18:04:46.948971 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:04:46.955512 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:04:46.955733 [debug] [MainThread]: On master: COMMIT
[0m18:04:46.955876 [debug] [MainThread]: Using postgres connection "master"
[0m18:04:46.956004 [debug] [MainThread]: On master: COMMIT
[0m18:04:46.956502 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:04:46.956738 [debug] [MainThread]: On master: Close
[0m18:04:46.956972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:04:46.957114 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m18:04:46.957234 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m18:04:46.957410 [info ] [MainThread]: 
[0m18:04:46.957567 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m18:04:46.957934 [debug] [MainThread]: Command end result
[0m18:04:46.971360 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/manifest.json
[0m18:04:46.981460 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/semantic_manifest.json
[0m18:04:46.985213 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/run_results.json
[0m18:04:46.985424 [info ] [MainThread]: 
[0m18:04:46.985609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:04:46.985747 [info ] [MainThread]: 
[0m18:04:46.985900 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:04:46.988628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2891656, "process_in_blocks": "0", "process_kernel_time": 0.336757, "process_mem_max_rss": "136380416", "process_out_blocks": "0", "process_user_time": 1.447131}
[0m18:04:46.988933 [debug] [MainThread]: Command `dbt run` succeeded at 18:04:46.988894 after 1.29 seconds
[0m18:04:46.989124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b7450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1015861d0>]}
[0m18:04:46.989308 [debug] [MainThread]: Flushing usage events
[0m18:04:48.765299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:08.263186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f77690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183d6c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183d72d0>]}


============================== 18:09:08.266431 | 7efea014-2dad-4790-be6a-9946c46f6f20 ==============================
[0m18:09:08.266431 [info ] [MainThread]: Running with dbt=1.10.10
[0m18:09:08.266759 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/logs', 'log_format': 'default', 'introspect': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'use_colors': 'True', 'static_parser': 'True', 'empty': 'None', 'partial_parse': 'True', 'quiet': 'False', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'invocation_command': 'dbt debug'}
[0m18:09:08.280423 [info ] [MainThread]: dbt version: 1.10.10
[0m18:09:08.280708 [info ] [MainThread]: python version: 3.11.5
[0m18:09:08.280886 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m18:09:08.281037 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m18:09:08.335282 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt
[0m18:09:08.335574 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/profiles.yml
[0m18:09:08.335722 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/dbt_project.yml
[0m18:09:08.336322 [info ] [MainThread]: adapter type: postgres
[0m18:09:08.336459 [info ] [MainThread]: adapter version: 1.8.2
[0m18:09:08.390861 [info ] [MainThread]: Configuration:
[0m18:09:08.391173 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m18:09:08.391312 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m18:09:08.391485 [info ] [MainThread]: Required dependencies:
[0m18:09:08.392014 [debug] [MainThread]: Executing "git --help"
[0m18:09:08.428113 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m18:09:08.428719 [debug] [MainThread]: STDERR: "b''"
[0m18:09:08.428907 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m18:09:08.429097 [info ] [MainThread]: Connection:
[0m18:09:08.429278 [info ] [MainThread]:   host: localhost
[0m18:09:08.429400 [info ] [MainThread]:   port: 5432
[0m18:09:08.429520 [info ] [MainThread]:   user: postgres
[0m18:09:08.429644 [info ] [MainThread]:   database: staging
[0m18:09:08.429762 [info ] [MainThread]:   schema: public
[0m18:09:08.429877 [info ] [MainThread]:   connect_timeout: 10
[0m18:09:08.429990 [info ] [MainThread]:   role: None
[0m18:09:08.430107 [info ] [MainThread]:   search_path: None
[0m18:09:08.430219 [info ] [MainThread]:   keepalives_idle: 0
[0m18:09:08.430330 [info ] [MainThread]:   sslmode: None
[0m18:09:08.430442 [info ] [MainThread]:   sslcert: None
[0m18:09:08.430551 [info ] [MainThread]:   sslkey: None
[0m18:09:08.430659 [info ] [MainThread]:   sslrootcert: None
[0m18:09:08.430776 [info ] [MainThread]:   application_name: dbt
[0m18:09:08.430887 [info ] [MainThread]:   retries: 1
[0m18:09:08.431197 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:09:08.479442 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m18:09:08.529198 [debug] [MainThread]: Using postgres connection "debug"
[0m18:09:08.529428 [debug] [MainThread]: On debug: select 1 as id
[0m18:09:08.529567 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:08.565965 [debug] [MainThread]: SQL status: SELECT 1 in 0.036 seconds
[0m18:09:08.566554 [debug] [MainThread]: On debug: Close
[0m18:09:08.566734 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m18:09:08.566901 [info ] [MainThread]: [32mAll checks passed![0m
[0m18:09:08.570229 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.359288, "process_in_blocks": "0", "process_kernel_time": 0.262859, "process_mem_max_rss": "125272064", "process_out_blocks": "0", "process_user_time": 0.789935}
[0m18:09:08.570578 [debug] [MainThread]: Command `dbt debug` succeeded at 18:09:08.570522 after 0.36 seconds
[0m18:09:08.570763 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m18:09:08.570956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fe9410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192b05d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10153dd50>]}
[0m18:09:08.571175 [debug] [MainThread]: Flushing usage events
[0m18:09:10.257306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:36.410030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e76e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11074fb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f13c10>]}


============================== 18:09:36.414266 | b88bcfa1-5883-47c0-b1a2-3914e98d0a78 ==============================
[0m18:09:36.414266 [info ] [MainThread]: Running with dbt=1.10.10
[0m18:09:36.414607 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'partial_parse': 'True', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt', 'log_cache_events': 'False', 'no_print': 'None', 'static_parser': 'True', 'debug': 'False', 'fail_fast': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'introspect': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/logs', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_format': 'default', 'write_json': 'True', 'printer_width': '80', 'target_path': 'None'}
[0m18:09:36.740142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b88bcfa1-5883-47c0-b1a2-3914e98d0a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f3dbd0>]}
[0m18:09:36.776195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b88bcfa1-5883-47c0-b1a2-3914e98d0a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10697cb90>]}
[0m18:09:36.778213 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m18:09:36.831878 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m18:09:36.875716 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:09:36.876091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b88bcfa1-5883-47c0-b1a2-3914e98d0a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107e06d0>]}
[0m18:09:37.346827 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.elt_assignment.gold
[0m18:09:37.349086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b88bcfa1-5883-47c0-b1a2-3914e98d0a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a08410>]}
[0m18:09:37.374689 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/manifest.json
[0m18:09:37.376709 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/semantic_manifest.json
[0m18:09:37.394020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b88bcfa1-5883-47c0-b1a2-3914e98d0a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e91350>]}
[0m18:09:37.394333 [info ] [MainThread]: Found 2 models, 434 macros
[0m18:09:37.394505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b88bcfa1-5883-47c0-b1a2-3914e98d0a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a1bb10>]}
[0m18:09:37.395179 [info ] [MainThread]: 
[0m18:09:37.395346 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:09:37.395471 [info ] [MainThread]: 
[0m18:09:37.395699 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:37.397571 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m18:09:37.397824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m18:09:37.468499 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m18:09:37.468765 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m18:09:37.468907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:37.469929 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m18:09:37.470118 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m18:09:37.470262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:37.504983 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.035 seconds
[0m18:09:37.505231 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.036 seconds
[0m18:09:37.505940 [debug] [ThreadPool]: On list_staging: Close
[0m18:09:37.506448 [debug] [ThreadPool]: On list_staging: Close
[0m18:09:37.507230 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_bronze)
[0m18:09:37.507507 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_silver)
[0m18:09:37.510352 [debug] [ThreadPool]: Using postgres connection "list_staging_bronze"
[0m18:09:37.511328 [debug] [ThreadPool]: Using postgres connection "list_staging_silver"
[0m18:09:37.511482 [debug] [ThreadPool]: On list_staging_bronze: BEGIN
[0m18:09:37.511612 [debug] [ThreadPool]: On list_staging_silver: BEGIN
[0m18:09:37.511730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:37.511852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:37.518821 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:09:37.519066 [debug] [ThreadPool]: Using postgres connection "list_staging_silver"
[0m18:09:37.519222 [debug] [ThreadPool]: On list_staging_silver: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging_silver"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m18:09:37.521439 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m18:09:37.521606 [debug] [ThreadPool]: Using postgres connection "list_staging_bronze"
[0m18:09:37.521761 [debug] [ThreadPool]: On list_staging_bronze: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging_bronze"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m18:09:37.521989 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m18:09:37.522682 [debug] [ThreadPool]: On list_staging_silver: ROLLBACK
[0m18:09:37.523184 [debug] [ThreadPool]: On list_staging_silver: Close
[0m18:09:37.523984 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m18:09:37.524641 [debug] [ThreadPool]: On list_staging_bronze: ROLLBACK
[0m18:09:37.525091 [debug] [ThreadPool]: On list_staging_bronze: Close
[0m18:09:37.527532 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:37.527758 [debug] [MainThread]: On master: BEGIN
[0m18:09:37.527888 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:37.534603 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:09:37.534841 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:37.535045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:37.542922 [debug] [MainThread]: SQL status: SELECT 29 in 0.008 seconds
[0m18:09:37.543780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b88bcfa1-5883-47c0-b1a2-3914e98d0a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11509ced0>]}
[0m18:09:37.544047 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:37.544756 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:37.544974 [debug] [MainThread]: On master: BEGIN
[0m18:09:37.545705 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:09:37.545875 [debug] [MainThread]: On master: COMMIT
[0m18:09:37.546016 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:37.546142 [debug] [MainThread]: On master: COMMIT
[0m18:09:37.546528 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:09:37.546688 [debug] [MainThread]: On master: Close
[0m18:09:37.551911 [debug] [Thread-1 (]: Began running node model.elt_assignment.customers_clean
[0m18:09:37.552122 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_raw
[0m18:09:37.552355 [info ] [Thread-1 (]: 1 of 2 START sql table model silver.customers_clean ............................ [RUN]
[0m18:09:37.552603 [info ] [Thread-2 (]: 2 of 2 START sql table model bronze.customers_raw .............................. [RUN]
[0m18:09:37.552831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_bronze, now model.elt_assignment.customers_clean)
[0m18:09:37.553016 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_staging_silver, now model.elt_assignment.customers_raw)
[0m18:09:37.553173 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customers_clean
[0m18:09:37.553313 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_raw
[0m18:09:37.556543 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m18:09:37.557433 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m18:09:37.558490 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customers_clean
[0m18:09:37.564876 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_raw
[0m18:09:37.576328 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m18:09:37.578082 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m18:09:37.579302 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:09:37.579477 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: BEGIN
[0m18:09:37.579623 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:09:37.579796 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:09:37.580038 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: BEGIN
[0m18:09:37.580180 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:37.592671 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m18:09:37.593020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m18:09:37.593294 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:09:37.593511 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:09:37.593691 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "staging"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m18:09:37.593907 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "staging"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m18:09:37.598234 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.004 seconds
[0m18:09:37.603954 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:09:37.604158 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.010 seconds
[0m18:09:37.604363 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "staging"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m18:09:37.605731 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:09:37.605947 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "staging"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m18:09:37.606435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:09:37.612690 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: COMMIT
[0m18:09:37.612978 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:09:37.613156 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: COMMIT
[0m18:09:37.615659 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:09:37.615884 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m18:09:37.619271 [debug] [Thread-1 (]: Applying DROP to: "staging"."silver"."customers_clean__dbt_backup"
[0m18:09:37.620821 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:09:37.623499 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m18:09:37.623739 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "staging"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m18:09:37.623997 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "staging"."silver"."customers_clean__dbt_backup" cascade
[0m18:09:37.624941 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:09:37.625116 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:09:37.626791 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: COMMIT
[0m18:09:37.627996 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: Close
[0m18:09:37.628211 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:09:37.628413 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: COMMIT
[0m18:09:37.629823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b88bcfa1-5883-47c0-b1a2-3914e98d0a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112313210>]}
[0m18:09:37.630071 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m18:09:37.631816 [debug] [Thread-2 (]: Applying DROP to: "staging"."bronze"."customers_raw__dbt_backup"
[0m18:09:37.630516 [info ] [Thread-1 (]: 1 of 2 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.08s]
[0m18:09:37.632145 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m18:09:37.632405 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customers_clean
[0m18:09:37.632580 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "staging"."bronze"."customers_raw__dbt_backup" cascade
[0m18:09:37.635631 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m18:09:37.636357 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: Close
[0m18:09:37.636642 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b88bcfa1-5883-47c0-b1a2-3914e98d0a78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fe69d0>]}
[0m18:09:37.636960 [info ] [Thread-2 (]: 2 of 2 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.08s]
[0m18:09:37.637288 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_raw
[0m18:09:37.637986 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:37.638196 [debug] [MainThread]: On master: BEGIN
[0m18:09:37.638345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:37.644960 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:09:37.645284 [debug] [MainThread]: On master: COMMIT
[0m18:09:37.645426 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:37.645546 [debug] [MainThread]: On master: COMMIT
[0m18:09:37.645925 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:09:37.646098 [debug] [MainThread]: On master: Close
[0m18:09:37.646327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:37.646459 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m18:09:37.646604 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m18:09:37.646785 [info ] [MainThread]: 
[0m18:09:37.646980 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m18:09:37.647386 [debug] [MainThread]: Command end result
[0m18:09:37.658301 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/manifest.json
[0m18:09:37.660625 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/semantic_manifest.json
[0m18:09:37.664025 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/run_results.json
[0m18:09:37.664254 [info ] [MainThread]: 
[0m18:09:37.664457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:37.664598 [info ] [MainThread]: 
[0m18:09:37.664751 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:09:37.667642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3046299, "process_in_blocks": "0", "process_kernel_time": 0.324821, "process_mem_max_rss": "134299648", "process_out_blocks": "0", "process_user_time": 1.43568}
[0m18:09:37.667945 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:37.667902 after 1.31 seconds
[0m18:09:37.668140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111eb69d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105029090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f92dd0>]}
[0m18:09:37.668308 [debug] [MainThread]: Flushing usage events
[0m18:09:39.336676 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:25:03.646817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cce83d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd13290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd13990>]}


============================== 20:25:03.650827 | 17c37f05-1da8-4e3f-a6a3-707b002ef19a ==============================
[0m20:25:03.650827 [info ] [MainThread]: Running with dbt=1.10.10
[0m20:25:03.651228 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/logs', 'use_colors': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt', 'printer_width': '80', 'empty': 'False', 'target_path': 'None', 'debug': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'warn_error': 'None', 'version_check': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'introspect': 'True'}
[0m20:25:04.011928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17c37f05-1da8-4e3f-a6a3-707b002ef19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d055f50>]}
[0m20:25:04.055575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17c37f05-1da8-4e3f-a6a3-707b002ef19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b10bd0>]}
[0m20:25:04.056890 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m20:25:04.121798 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m20:25:04.226054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:25:04.226444 [debug] [MainThread]: Partial parsing: added file: elt_assignment://models/gold/dim_customers.sql
[0m20:25:04.392993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17c37f05-1da8-4e3f-a6a3-707b002ef19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e253790>]}
[0m20:25:04.425868 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/manifest.json
[0m20:25:04.429078 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/semantic_manifest.json
[0m20:25:04.449470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17c37f05-1da8-4e3f-a6a3-707b002ef19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3ff090>]}
[0m20:25:04.449812 [info ] [MainThread]: Found 3 models, 434 macros
[0m20:25:04.450026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17c37f05-1da8-4e3f-a6a3-707b002ef19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d15e910>]}
[0m20:25:04.450854 [info ] [MainThread]: 
[0m20:25:04.451062 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:25:04.451219 [info ] [MainThread]: 
[0m20:25:04.451504 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m20:25:04.453778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m20:25:04.454107 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m20:25:04.460519 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging'
[0m20:25:04.568101 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m20:25:04.568366 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m20:25:04.568577 [debug] [ThreadPool]: Using postgres connection "list_staging"
[0m20:25:04.568800 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m20:25:04.568979 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m20:25:04.569146 [debug] [ThreadPool]: On list_staging: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging"} */

    select distinct nspname from pg_namespace
  
[0m20:25:04.569307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:04.569464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:04.569613 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:04.729891 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.160 seconds
[0m20:25:04.730375 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.161 seconds
[0m20:25:04.730687 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.161 seconds
[0m20:25:04.731615 [debug] [ThreadPool]: On list_staging: Close
[0m20:25:04.732369 [debug] [ThreadPool]: On list_staging: Close
[0m20:25:04.732997 [debug] [ThreadPool]: On list_staging: Close
[0m20:25:04.734374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_silver)
[0m20:25:04.734704 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_bronze)
[0m20:25:04.735032 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_staging, now list_staging_gold)
[0m20:25:04.738624 [debug] [ThreadPool]: Using postgres connection "list_staging_silver"
[0m20:25:04.739823 [debug] [ThreadPool]: Using postgres connection "list_staging_bronze"
[0m20:25:04.740899 [debug] [ThreadPool]: Using postgres connection "list_staging_gold"
[0m20:25:04.741085 [debug] [ThreadPool]: On list_staging_silver: BEGIN
[0m20:25:04.741247 [debug] [ThreadPool]: On list_staging_bronze: BEGIN
[0m20:25:04.741397 [debug] [ThreadPool]: On list_staging_gold: BEGIN
[0m20:25:04.741549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:04.741713 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:04.741860 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:25:04.752665 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m20:25:04.752939 [debug] [ThreadPool]: Using postgres connection "list_staging_gold"
[0m20:25:04.753139 [debug] [ThreadPool]: On list_staging_gold: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging_gold"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m20:25:04.757271 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m20:25:04.758017 [debug] [ThreadPool]: On list_staging_gold: ROLLBACK
[0m20:25:04.758527 [debug] [ThreadPool]: On list_staging_gold: Close
[0m20:25:09.767178 [debug] [ThreadPool]: SQL status: BEGIN in 5.025 seconds
[0m20:25:09.767940 [debug] [ThreadPool]: SQL status: BEGIN in 5.026 seconds
[0m20:25:09.768649 [debug] [ThreadPool]: Using postgres connection "list_staging_silver"
[0m20:25:09.769011 [debug] [ThreadPool]: Using postgres connection "list_staging_bronze"
[0m20:25:09.769402 [debug] [ThreadPool]: On list_staging_silver: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging_silver"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m20:25:09.769961 [debug] [ThreadPool]: On list_staging_bronze: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_staging_bronze"} */
select
      'staging' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'staging' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'staging' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m20:25:09.775879 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.005 seconds
[0m20:25:09.776419 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m20:25:09.777927 [debug] [ThreadPool]: On list_staging_silver: ROLLBACK
[0m20:25:09.779107 [debug] [ThreadPool]: On list_staging_bronze: ROLLBACK
[0m20:25:09.780077 [debug] [ThreadPool]: On list_staging_bronze: Close
[0m20:25:09.780362 [debug] [ThreadPool]: On list_staging_silver: Close
[0m20:25:09.786286 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:09.786709 [debug] [MainThread]: On master: BEGIN
[0m20:25:09.786969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:25:09.799815 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m20:25:09.800262 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:09.800639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m20:25:09.812907 [debug] [MainThread]: SQL status: SELECT 29 in 0.012 seconds
[0m20:25:09.814501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17c37f05-1da8-4e3f-a6a3-707b002ef19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e252190>]}
[0m20:25:09.814988 [debug] [MainThread]: On master: ROLLBACK
[0m20:25:09.815715 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:09.815988 [debug] [MainThread]: On master: BEGIN
[0m20:25:09.817077 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m20:25:09.817303 [debug] [MainThread]: On master: COMMIT
[0m20:25:09.817508 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:09.817695 [debug] [MainThread]: On master: COMMIT
[0m20:25:09.818428 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:25:09.818877 [debug] [MainThread]: On master: Close
[0m20:25:09.824656 [debug] [Thread-1 (]: Began running node model.elt_assignment.customers_clean
[0m20:25:09.825068 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_raw
[0m20:25:09.825585 [info ] [Thread-1 (]: 1 of 3 START sql table model silver.customers_clean ............................ [RUN]
[0m20:25:09.826345 [info ] [Thread-2 (]: 2 of 3 START sql table model bronze.customers_raw .............................. [RUN]
[0m20:25:09.826828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_staging_silver, now model.elt_assignment.customers_clean)
[0m20:25:09.827158 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_staging_bronze, now model.elt_assignment.customers_raw)
[0m20:25:09.827466 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customers_clean
[0m20:25:09.827760 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_raw
[0m20:25:09.833364 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m20:25:09.834981 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m20:25:09.836048 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_raw
[0m20:25:09.836311 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customers_clean
[0m20:25:09.866446 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m20:25:09.866981 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m20:25:09.868206 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m20:25:09.868493 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m20:25:09.868695 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: BEGIN
[0m20:25:09.868967 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: BEGIN
[0m20:25:09.869216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:25:09.869411 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:25:09.877284 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m20:25:09.877615 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m20:25:09.877853 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "staging"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m20:25:09.880139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m20:25:09.880439 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m20:25:09.880709 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "staging"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m20:25:09.881910 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.004 seconds
[0m20:25:09.887905 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m20:25:09.888193 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.007 seconds
[0m20:25:09.888409 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "staging"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m20:25:09.890209 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m20:25:09.890480 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "staging"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m20:25:09.891157 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m20:25:09.899220 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: COMMIT
[0m20:25:09.899473 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m20:25:09.899673 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: COMMIT
[0m20:25:09.901630 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m20:25:09.901885 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m20:25:09.905507 [debug] [Thread-1 (]: Applying DROP to: "staging"."silver"."customers_clean__dbt_backup"
[0m20:25:09.907268 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m20:25:09.910032 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m20:25:09.910279 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "staging"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m20:25:09.910505 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "staging"."silver"."customers_clean__dbt_backup" cascade
[0m20:25:09.911298 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:09.911579 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m20:25:09.913477 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: COMMIT
[0m20:25:09.914834 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: Close
[0m20:25:09.915070 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m20:25:09.915350 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: COMMIT
[0m20:25:09.916993 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m20:25:09.918441 [debug] [Thread-2 (]: Applying DROP to: "staging"."bronze"."customers_raw__dbt_backup"
[0m20:25:09.918756 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m20:25:09.918965 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "staging"."bronze"."customers_raw__dbt_backup" cascade
[0m20:25:09.919188 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c37f05-1da8-4e3f-a6a3-707b002ef19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bebdb10>]}
[0m20:25:09.919594 [info ] [Thread-1 (]: 1 of 3 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.09s]
[0m20:25:09.919921 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customers_clean
[0m20:25:09.920251 [debug] [Thread-4 (]: Began running node model.elt_assignment.dim_customers
[0m20:25:09.920534 [info ] [Thread-4 (]: 3 of 3 START sql table model gold.dim_customers ................................ [RUN]
[0m20:25:09.920855 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.elt_assignment.dim_customers'
[0m20:25:09.921061 [debug] [Thread-4 (]: Began compiling node model.elt_assignment.dim_customers
[0m20:25:09.922771 [debug] [Thread-4 (]: Writing injected SQL for node "model.elt_assignment.dim_customers"
[0m20:25:09.923013 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m20:25:09.923838 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: Close
[0m20:25:09.924177 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c37f05-1da8-4e3f-a6a3-707b002ef19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d057990>]}
[0m20:25:09.924610 [info ] [Thread-2 (]: 2 of 3 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.10s]
[0m20:25:09.924935 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_raw
[0m20:25:09.925148 [debug] [Thread-4 (]: Began executing node model.elt_assignment.dim_customers
[0m20:25:09.927194 [debug] [Thread-4 (]: Writing runtime sql for node "model.elt_assignment.dim_customers"
[0m20:25:09.928217 [debug] [Thread-4 (]: Using postgres connection "model.elt_assignment.dim_customers"
[0m20:25:09.928414 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: BEGIN
[0m20:25:09.928589 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:25:09.937266 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m20:25:09.937536 [debug] [Thread-4 (]: Using postgres connection "model.elt_assignment.dim_customers"
[0m20:25:09.937745 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.dim_customers"} */

  
    

  create  table "staging"."gold"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- Gold dimension: anonymized customers with cleaned attributes

SELECT
  customer_hash,
  gender,
  age,
  tenure_months,
  monthly_charges,
  total_charges,
  contract_type,
  internet_service,
  has_tech_support,
  _loaded_at
FROM "staging"."silver"."customers_clean"
  );
  
[0m20:25:09.942601 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.005 seconds
[0m20:25:09.946072 [debug] [Thread-4 (]: Using postgres connection "model.elt_assignment.dim_customers"
[0m20:25:09.946376 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.dim_customers"} */
alter table "staging"."gold"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m20:25:09.947329 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m20:25:09.948201 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: COMMIT
[0m20:25:09.948443 [debug] [Thread-4 (]: Using postgres connection "model.elt_assignment.dim_customers"
[0m20:25:09.948662 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: COMMIT
[0m20:25:09.950207 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m20:25:09.951751 [debug] [Thread-4 (]: Applying DROP to: "staging"."gold"."dim_customers__dbt_backup"
[0m20:25:09.952091 [debug] [Thread-4 (]: Using postgres connection "model.elt_assignment.dim_customers"
[0m20:25:09.952328 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.dim_customers"} */
drop table if exists "staging"."gold"."dim_customers__dbt_backup" cascade
[0m20:25:09.952971 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m20:25:09.953845 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: Close
[0m20:25:09.954269 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c37f05-1da8-4e3f-a6a3-707b002ef19a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7dbe50>]}
[0m20:25:09.954682 [info ] [Thread-4 (]: 3 of 3 OK created sql table model gold.dim_customers ........................... [[32mSELECT 1000[0m in 0.03s]
[0m20:25:09.955012 [debug] [Thread-4 (]: Finished running node model.elt_assignment.dim_customers
[0m20:25:09.955850 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:09.956048 [debug] [MainThread]: On master: BEGIN
[0m20:25:09.956199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:25:09.964187 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m20:25:09.964496 [debug] [MainThread]: On master: COMMIT
[0m20:25:09.964676 [debug] [MainThread]: Using postgres connection "master"
[0m20:25:09.964834 [debug] [MainThread]: On master: COMMIT
[0m20:25:09.965361 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m20:25:09.965650 [debug] [MainThread]: On master: Close
[0m20:25:09.965930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:25:09.966096 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m20:25:09.966237 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m20:25:09.966373 [debug] [MainThread]: Connection 'list_staging_gold' was properly closed.
[0m20:25:09.966504 [debug] [MainThread]: Connection 'model.elt_assignment.dim_customers' was properly closed.
[0m20:25:09.966726 [info ] [MainThread]: 
[0m20:25:09.966917 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.52 seconds (5.52s).
[0m20:25:09.967403 [debug] [MainThread]: Command end result
[0m20:25:09.980028 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/manifest.json
[0m20:25:09.981986 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/semantic_manifest.json
[0m20:25:09.986199 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/dbt/target/run_results.json
[0m20:25:09.986427 [info ] [MainThread]: 
[0m20:25:09.986660 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:25:09.986828 [info ] [MainThread]: 
[0m20:25:09.987004 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m20:25:09.989823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4133506, "process_in_blocks": "0", "process_kernel_time": 0.413333, "process_mem_max_rss": "137641984", "process_out_blocks": "0", "process_user_time": 1.551493}
[0m20:25:09.990176 [debug] [MainThread]: Command `dbt run` succeeded at 20:25:09.990119 after 6.41 seconds
[0m20:25:09.990412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd0fe10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c06cd0>]}
[0m20:25:09.990636 [debug] [MainThread]: Flushing usage events
[0m20:25:11.485024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:04:13.371784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a3150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058369d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058370d0>]}


============================== 14:04:13.377099 | 518aec2c-0a3d-4e2b-8c47-ac5fe6da6796 ==============================
[0m14:04:13.377099 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:04:13.377427 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'empty': 'None', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'fail_fast': 'False', 'target_path': 'None', 'version_check': 'True', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'quiet': 'False', 'debug': 'False', 'introspect': 'True', 'write_json': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'printer_width': '80', 'warn_error': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'static_parser': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:04:13.392722 [info ] [MainThread]: dbt version: 1.10.10
[0m14:04:13.392955 [info ] [MainThread]: python version: 3.11.5
[0m14:04:13.393125 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m14:04:13.393270 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m14:04:13.444417 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt
[0m14:04:13.444728 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/profiles.yml
[0m14:04:13.444888 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/dbt_project.yml
[0m14:04:13.445366 [info ] [MainThread]: adapter type: postgres
[0m14:04:13.445522 [info ] [MainThread]: adapter version: 1.8.2
[0m14:04:13.501534 [info ] [MainThread]: Configuration:
[0m14:04:13.501843 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:04:13.501988 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:04:13.502115 [info ] [MainThread]: Required dependencies:
[0m14:04:13.502604 [debug] [MainThread]: Executing "git --help"
[0m14:04:13.536111 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:04:13.536780 [debug] [MainThread]: STDERR: "b''"
[0m14:04:13.536982 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:04:13.537182 [info ] [MainThread]: Connection:
[0m14:04:13.537372 [info ] [MainThread]:   host: localhost
[0m14:04:13.537499 [info ] [MainThread]:   port: 5432
[0m14:04:13.537624 [info ] [MainThread]:   user: postgres
[0m14:04:13.537736 [info ] [MainThread]:   database: staging
[0m14:04:13.537846 [info ] [MainThread]:   schema: public
[0m14:04:13.537960 [info ] [MainThread]:   connect_timeout: 10
[0m14:04:13.538072 [info ] [MainThread]:   role: None
[0m14:04:13.538186 [info ] [MainThread]:   search_path: None
[0m14:04:13.538298 [info ] [MainThread]:   keepalives_idle: 0
[0m14:04:13.538407 [info ] [MainThread]:   sslmode: None
[0m14:04:13.538518 [info ] [MainThread]:   sslcert: None
[0m14:04:13.538643 [info ] [MainThread]:   sslkey: None
[0m14:04:13.538753 [info ] [MainThread]:   sslrootcert: None
[0m14:04:13.538867 [info ] [MainThread]:   application_name: dbt
[0m14:04:13.538976 [info ] [MainThread]:   retries: 1
[0m14:04:13.539319 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:04:13.586582 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:04:13.639556 [debug] [MainThread]: Using postgres connection "debug"
[0m14:04:13.639811 [debug] [MainThread]: On debug: select 1 as id
[0m14:04:13.639952 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:13.777921 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "postgres"

[0m14:04:13.781216 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:04:13.781476 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:04:13.781701 [debug] [MainThread]: On debug: No close available on handle
[0m14:04:13.782098 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:04:13.782325 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:04:13.782474 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "postgres"
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:04:13.785057 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.468451, "process_in_blocks": "0", "process_kernel_time": 0.271365, "process_mem_max_rss": "125255680", "process_out_blocks": "0", "process_user_time": 0.792067}
[0m14:04:13.785411 [debug] [MainThread]: Command `dbt debug` failed at 14:04:13.785350 after 0.47 seconds
[0m14:04:13.785610 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:04:13.785793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ad2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10581a890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105819bd0>]}
[0m14:04:13.786022 [debug] [MainThread]: Flushing usage events
[0m14:04:15.389848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:10:17.059834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d7b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0f190>]}


============================== 14:10:17.064069 | 94103a58-9163-4f66-a904-25a41c116a29 ==============================
[0m14:10:17.064069 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:10:17.064492 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'write_json': 'True', 'debug': 'False', 'log_format': 'default', 'target_path': 'None', 'log_cache_events': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'invocation_command': 'dbt debug', 'printer_width': '80', 'indirect_selection': 'eager', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True'}
[0m14:10:17.080430 [info ] [MainThread]: dbt version: 1.10.10
[0m14:10:17.080787 [info ] [MainThread]: python version: 3.11.5
[0m14:10:17.080995 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m14:10:17.081171 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m14:10:17.163068 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt
[0m14:10:17.163438 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/profiles.yml
[0m14:10:17.163636 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/dbt_project.yml
[0m14:10:17.164352 [info ] [MainThread]: adapter type: postgres
[0m14:10:17.164592 [info ] [MainThread]: adapter version: 1.8.2
[0m14:10:17.242095 [info ] [MainThread]: Configuration:
[0m14:10:17.242497 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:10:17.242688 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:10:17.242852 [info ] [MainThread]: Required dependencies:
[0m14:10:17.243334 [debug] [MainThread]: Executing "git --help"
[0m14:10:17.280362 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:10:17.281129 [debug] [MainThread]: STDERR: "b''"
[0m14:10:17.281382 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:10:17.281640 [info ] [MainThread]: Connection:
[0m14:10:17.281867 [info ] [MainThread]:   host: airflow
[0m14:10:17.282029 [info ] [MainThread]:   port: 5432
[0m14:10:17.282181 [info ] [MainThread]:   user: airflow
[0m14:10:17.282326 [info ] [MainThread]:   database: staging
[0m14:10:17.282473 [info ] [MainThread]:   schema: airflow
[0m14:10:17.282625 [info ] [MainThread]:   connect_timeout: 10
[0m14:10:17.282767 [info ] [MainThread]:   role: None
[0m14:10:17.282916 [info ] [MainThread]:   search_path: None
[0m14:10:17.283054 [info ] [MainThread]:   keepalives_idle: 0
[0m14:10:17.283195 [info ] [MainThread]:   sslmode: None
[0m14:10:17.283338 [info ] [MainThread]:   sslcert: None
[0m14:10:17.283477 [info ] [MainThread]:   sslkey: None
[0m14:10:17.283621 [info ] [MainThread]:   sslrootcert: None
[0m14:10:17.283768 [info ] [MainThread]:   application_name: dbt
[0m14:10:17.283907 [info ] [MainThread]:   retries: 1
[0m14:10:17.284325 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:10:17.345309 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:10:17.415036 [debug] [MainThread]: Using postgres connection "debug"
[0m14:10:17.415353 [debug] [MainThread]: On debug: select 1 as id
[0m14:10:17.415537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:17.484261 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "airflow" to address: nodename nor servname provided, or not known

[0m14:10:17.487896 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:10:17.488095 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:10:17.488306 [debug] [MainThread]: On debug: No close available on handle
[0m14:10:17.488531 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:10:17.488734 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:10:17.488903 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "airflow" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:10:17.491804 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.49579534, "process_in_blocks": "0", "process_kernel_time": 0.307048, "process_mem_max_rss": "120061952", "process_out_blocks": "0", "process_user_time": 1.013733}
[0m14:10:17.492235 [debug] [MainThread]: Command `dbt debug` failed at 14:10:17.492165 after 0.50 seconds
[0m14:10:17.492483 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:10:17.492728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2cd550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1b0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9e0c50>]}
[0m14:10:17.492996 [debug] [MainThread]: Flushing usage events
[0m14:10:19.098713 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:21.307999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123106990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12319aad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12319b1d0>]}


============================== 14:11:21.311853 | 33180509-da2f-4533-9134-65db002fa2da ==============================
[0m14:11:21.311853 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:11:21.312261 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'empty': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt debug', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'static_parser': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True'}
[0m14:11:21.336892 [info ] [MainThread]: dbt version: 1.10.10
[0m14:11:21.337323 [info ] [MainThread]: python version: 3.11.5
[0m14:11:21.337588 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m14:11:21.337893 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m14:11:21.392463 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt
[0m14:11:21.392856 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/profiles.yml
[0m14:11:21.393048 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/dbt_project.yml
[0m14:11:21.395307 [info ] [MainThread]: adapter type: postgres
[0m14:11:21.395490 [info ] [MainThread]: adapter version: 1.8.2
[0m14:11:21.470340 [info ] [MainThread]: Configuration:
[0m14:11:21.470718 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:11:21.470900 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:11:21.471061 [info ] [MainThread]: Required dependencies:
[0m14:11:21.471533 [debug] [MainThread]: Executing "git --help"
[0m14:11:21.516271 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:11:21.516934 [debug] [MainThread]: STDERR: "b''"
[0m14:11:21.517155 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:11:21.517386 [info ] [MainThread]: Connection:
[0m14:11:21.517624 [info ] [MainThread]:   host: localhost
[0m14:11:21.517779 [info ] [MainThread]:   port: 5432
[0m14:11:21.517926 [info ] [MainThread]:   user: airflow
[0m14:11:21.518068 [info ] [MainThread]:   database: staging
[0m14:11:21.518209 [info ] [MainThread]:   schema: airflow
[0m14:11:21.518661 [info ] [MainThread]:   connect_timeout: 10
[0m14:11:21.518915 [info ] [MainThread]:   role: None
[0m14:11:21.519089 [info ] [MainThread]:   search_path: None
[0m14:11:21.519260 [info ] [MainThread]:   keepalives_idle: 0
[0m14:11:21.519412 [info ] [MainThread]:   sslmode: None
[0m14:11:21.519559 [info ] [MainThread]:   sslcert: None
[0m14:11:21.519704 [info ] [MainThread]:   sslkey: None
[0m14:11:21.519845 [info ] [MainThread]:   sslrootcert: None
[0m14:11:21.519991 [info ] [MainThread]:   application_name: dbt
[0m14:11:21.520132 [info ] [MainThread]:   retries: 1
[0m14:11:21.520539 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:11:21.581022 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:11:21.647369 [debug] [MainThread]: Using postgres connection "debug"
[0m14:11:21.647669 [debug] [MainThread]: On debug: select 1 as id
[0m14:11:21.647856 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:21.692020 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "staging" does not exist

[0m14:11:21.695666 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m14:11:21.695944 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m14:11:21.696152 [debug] [MainThread]: On debug: No close available on handle
[0m14:11:21.696361 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m14:11:21.696562 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:11:21.696740 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: FATAL:  database "staging" does not exist
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m14:11:21.699624 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.45543513, "process_in_blocks": "0", "process_kernel_time": 0.327458, "process_mem_max_rss": "126779392", "process_out_blocks": "0", "process_user_time": 1.01604}
[0m14:11:21.700132 [debug] [MainThread]: Command `dbt debug` failed at 14:11:21.700054 after 0.46 seconds
[0m14:11:21.700389 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:11:21.700633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12317e950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ee5790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123894ed0>]}
[0m14:11:21.700922 [debug] [MainThread]: Flushing usage events
[0m14:11:22.966962 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:50.013007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10757fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f1690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770f8d0>]}


============================== 14:11:50.016902 | aedef105-ae3c-4d61-95e2-bbb2c6d325ca ==============================
[0m14:11:50.016902 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:11:50.017366 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'quiet': 'False', 'use_colors': 'True', 'printer_width': '80', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'no_print': 'None', 'fail_fast': 'False', 'warn_error': 'None', 'version_check': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'log_format': 'default', 'write_json': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'debug': 'False', 'partial_parse': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:11:50.029139 [info ] [MainThread]: dbt version: 1.10.10
[0m14:11:50.029461 [info ] [MainThread]: python version: 3.11.5
[0m14:11:50.029675 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m14:11:50.029850 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m14:11:50.086070 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt
[0m14:11:50.086459 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/profiles.yml
[0m14:11:50.086658 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/dbt_project.yml
[0m14:11:50.087357 [info ] [MainThread]: adapter type: postgres
[0m14:11:50.087683 [info ] [MainThread]: adapter version: 1.8.2
[0m14:11:50.164136 [info ] [MainThread]: Configuration:
[0m14:11:50.164530 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:11:50.164723 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:11:50.164891 [info ] [MainThread]: Required dependencies:
[0m14:11:50.169857 [debug] [MainThread]: Executing "git --help"
[0m14:11:50.211772 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:11:50.212601 [debug] [MainThread]: STDERR: "b''"
[0m14:11:50.212843 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:11:50.213116 [info ] [MainThread]: Connection:
[0m14:11:50.213399 [info ] [MainThread]:   host: localhost
[0m14:11:50.213562 [info ] [MainThread]:   port: 5432
[0m14:11:50.213719 [info ] [MainThread]:   user: airflow
[0m14:11:50.213870 [info ] [MainThread]:   database: airflow
[0m14:11:50.214018 [info ] [MainThread]:   schema: airflow
[0m14:11:50.214166 [info ] [MainThread]:   connect_timeout: 10
[0m14:11:50.214314 [info ] [MainThread]:   role: None
[0m14:11:50.214463 [info ] [MainThread]:   search_path: None
[0m14:11:50.214604 [info ] [MainThread]:   keepalives_idle: 0
[0m14:11:50.214750 [info ] [MainThread]:   sslmode: None
[0m14:11:50.214899 [info ] [MainThread]:   sslcert: None
[0m14:11:50.215041 [info ] [MainThread]:   sslkey: None
[0m14:11:50.215188 [info ] [MainThread]:   sslrootcert: None
[0m14:11:50.215334 [info ] [MainThread]:   application_name: dbt
[0m14:11:50.215478 [info ] [MainThread]:   retries: 1
[0m14:11:50.215871 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:11:50.281083 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:11:50.347347 [debug] [MainThread]: Using postgres connection "debug"
[0m14:11:50.347698 [debug] [MainThread]: On debug: select 1 as id
[0m14:11:50.347892 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:50.376783 [debug] [MainThread]: SQL status: SELECT 1 in 0.029 seconds
[0m14:11:50.377489 [debug] [MainThread]: On debug: Close
[0m14:11:50.377734 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:11:50.377947 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:11:50.380667 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.44360638, "process_in_blocks": "0", "process_kernel_time": 0.298539, "process_mem_max_rss": "123584512", "process_out_blocks": "0", "process_user_time": 1.021686}
[0m14:11:50.381072 [debug] [MainThread]: Command `dbt debug` succeeded at 14:11:50.381006 after 0.44 seconds
[0m14:11:50.381276 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:11:50.381494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e39290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f0250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fedd50>]}
[0m14:11:50.381751 [debug] [MainThread]: Flushing usage events
[0m14:11:52.181091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:37.986608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d7f890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e06f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e075d0>]}


============================== 14:13:37.990451 | 17b3c364-f293-4c8a-b9f1-e065ded0fa5d ==============================
[0m14:13:37.990451 [info ] [MainThread]: Running with dbt=1.10.10
[0m14:13:37.990884 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'quiet': 'False', 'write_json': 'True', 'no_print': 'None', 'introspect': 'True', 'fail_fast': 'False', 'log_cache_events': 'False', 'version_check': 'True', 'log_format': 'default', 'empty': 'None', 'warn_error': 'None', 'partial_parse': 'True', 'static_parser': 'True', 'target_path': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'printer_width': '80', 'cache_selected_only': 'False'}
[0m14:13:38.296216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17b3c364-f293-4c8a-b9f1-e065ded0fa5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f34f90>]}
[0m14:13:38.317728 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:13:38.320279 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m14:13:38.322967 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.40451795, "process_in_blocks": "0", "process_kernel_time": 0.298463, "process_mem_max_rss": "113033216", "process_out_blocks": "0", "process_user_time": 0.978113}
[0m14:13:38.323426 [debug] [MainThread]: Command `dbt deps` succeeded at 14:13:38.323346 after 0.41 seconds
[0m14:13:38.323691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e0bf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e0bd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039acf50>]}
[0m14:13:38.323925 [debug] [MainThread]: Flushing usage events
[0m14:13:39.981186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:34:13.819290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa8ba0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f18770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7ff2c30>]}


============================== 09:34:13.827530 | 291a6d19-21c7-45d1-8e62-208d579413da ==============================
[0m09:34:13.827530 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:34:13.828593 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_experimental_parser': 'False', 'log_path': '/opt/airflow/dbt/logs', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/dbt/profiles', 'quiet': 'False', 'debug': 'False', 'introspect': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'printer_width': '80', 'invocation_command': 'dbt deps', 'log_format': 'default', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'empty': 'None', 'write_json': 'True', 'target_path': 'None', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_cache_events': 'False'}
[0m09:34:13.962815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '291a6d19-21c7-45d1-8e62-208d579413da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa4e8320>]}
[0m09:34:13.976815 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:34:13.980835 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:34:13.982312 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.20831104, "process_in_blocks": "1840", "process_kernel_time": 0.607814, "process_mem_max_rss": "105292", "process_out_blocks": "1515", "process_user_time": 1.712659}
[0m09:34:13.982922 [debug] [MainThread]: Command `dbt deps` succeeded at 09:34:13.982843 after 0.21 seconds
[0m09:34:13.983331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d3ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8b29fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa88ec9b0>]}
[0m09:34:13.983744 [debug] [MainThread]: Flushing usage events
[0m09:34:15.586329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:43.963875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b0eb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b0f210>]}


============================== 15:04:43.967448 | 7231b2c6-874c-4fe5-b519-a5f384dec1ce ==============================
[0m15:04:43.967448 [info ] [MainThread]: Running with dbt=1.10.10
[0m15:04:43.967851 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'quiet': 'False', 'fail_fast': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'empty': 'None', 'no_print': 'None', 'warn_error': 'None', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt'}
[0m15:04:43.983784 [info ] [MainThread]: dbt version: 1.10.10
[0m15:04:43.984088 [info ] [MainThread]: python version: 3.11.5
[0m15:04:43.984305 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m15:04:43.984493 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m15:04:44.048646 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt
[0m15:04:44.049022 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/profiles.yml
[0m15:04:44.049218 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/dbt_project.yml
[0m15:04:44.049886 [info ] [MainThread]: adapter type: postgres
[0m15:04:44.050055 [info ] [MainThread]: adapter version: 1.8.2
[0m15:04:44.120865 [info ] [MainThread]: Configuration:
[0m15:04:44.121229 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:04:44.121413 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:04:44.121576 [info ] [MainThread]: Required dependencies:
[0m15:04:44.122009 [debug] [MainThread]: Executing "git --help"
[0m15:04:44.160173 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:04:44.160931 [debug] [MainThread]: STDERR: "b''"
[0m15:04:44.161168 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:04:44.161408 [info ] [MainThread]: Connection:
[0m15:04:44.161630 [info ] [MainThread]:   host: localhost
[0m15:04:44.161784 [info ] [MainThread]:   port: 5432
[0m15:04:44.161935 [info ] [MainThread]:   user: airflow
[0m15:04:44.162083 [info ] [MainThread]:   database: airflow
[0m15:04:44.162248 [info ] [MainThread]:   schema: airflow
[0m15:04:44.162390 [info ] [MainThread]:   connect_timeout: 10
[0m15:04:44.162536 [info ] [MainThread]:   role: None
[0m15:04:44.162681 [info ] [MainThread]:   search_path: None
[0m15:04:44.162821 [info ] [MainThread]:   keepalives_idle: 0
[0m15:04:44.162965 [info ] [MainThread]:   sslmode: None
[0m15:04:44.163104 [info ] [MainThread]:   sslcert: None
[0m15:04:44.163246 [info ] [MainThread]:   sslkey: None
[0m15:04:44.163393 [info ] [MainThread]:   sslrootcert: None
[0m15:04:44.163537 [info ] [MainThread]:   application_name: dbt
[0m15:04:44.163682 [info ] [MainThread]:   retries: 1
[0m15:04:44.164043 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:04:44.221000 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:04:44.283026 [debug] [MainThread]: Using postgres connection "debug"
[0m15:04:44.283328 [debug] [MainThread]: On debug: select 1 as id
[0m15:04:44.283513 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:44.287275 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m15:04:44.288141 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m15:04:44.288325 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m15:04:44.288511 [debug] [MainThread]: On debug: No close available on handle
[0m15:04:44.288721 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:04:44.288915 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:04:44.289092 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:04:44.291636 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.3945769, "process_in_blocks": "0", "process_kernel_time": 0.301427, "process_mem_max_rss": "119619584", "process_out_blocks": "0", "process_user_time": 0.990392}
[0m15:04:44.292015 [debug] [MainThread]: Command `dbt debug` failed at 15:04:44.291957 after 0.40 seconds
[0m15:04:44.292228 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:04:44.292446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fcbb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105104b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a67b90>]}
[0m15:04:44.292680 [debug] [MainThread]: Flushing usage events
[0m15:04:45.668152 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:12.948203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cbee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d57390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d57a90>]}


============================== 15:05:12.951750 | 25aa9fe0-0384-4bb9-a2df-40cdcca99f6d ==============================
[0m15:05:12.951750 [info ] [MainThread]: Running with dbt=1.10.10
[0m15:05:12.952151 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'invocation_command': 'dbt debug', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'no_print': 'None', 'static_parser': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_format': 'default', 'introspect': 'True', 'write_json': 'True', 'quiet': 'False', 'debug': 'False', 'printer_width': '80', 'empty': 'None'}
[0m15:05:12.968230 [info ] [MainThread]: dbt version: 1.10.10
[0m15:05:12.968590 [info ] [MainThread]: python version: 3.11.5
[0m15:05:12.968806 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m15:05:12.968993 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m15:05:13.032085 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt
[0m15:05:13.032443 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/profiles.yml
[0m15:05:13.032635 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/dbt_project.yml
[0m15:05:13.033236 [info ] [MainThread]: adapter type: postgres
[0m15:05:13.033462 [info ] [MainThread]: adapter version: 1.8.2
[0m15:05:13.103428 [info ] [MainThread]: Configuration:
[0m15:05:13.103791 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:05:13.103975 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:05:13.104146 [info ] [MainThread]: Required dependencies:
[0m15:05:13.104689 [debug] [MainThread]: Executing "git --help"
[0m15:05:13.160319 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:05:13.162016 [debug] [MainThread]: STDERR: "b''"
[0m15:05:13.162393 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:05:13.162680 [info ] [MainThread]: Connection:
[0m15:05:13.163124 [info ] [MainThread]:   host: localhost
[0m15:05:13.163479 [info ] [MainThread]:   port: 5432
[0m15:05:13.163942 [info ] [MainThread]:   user: airflow
[0m15:05:13.164454 [info ] [MainThread]:   database: airflow
[0m15:05:13.164782 [info ] [MainThread]:   schema: airflow
[0m15:05:13.165296 [info ] [MainThread]:   connect_timeout: 10
[0m15:05:13.165689 [info ] [MainThread]:   role: None
[0m15:05:13.165940 [info ] [MainThread]:   search_path: None
[0m15:05:13.166243 [info ] [MainThread]:   keepalives_idle: 0
[0m15:05:13.166530 [info ] [MainThread]:   sslmode: None
[0m15:05:13.166929 [info ] [MainThread]:   sslcert: None
[0m15:05:13.167102 [info ] [MainThread]:   sslkey: None
[0m15:05:13.167409 [info ] [MainThread]:   sslrootcert: None
[0m15:05:13.167566 [info ] [MainThread]:   application_name: dbt
[0m15:05:13.167715 [info ] [MainThread]:   retries: 1
[0m15:05:13.168166 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:05:13.228972 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:05:13.289689 [debug] [MainThread]: Using postgres connection "debug"
[0m15:05:13.290000 [debug] [MainThread]: On debug: select 1 as id
[0m15:05:13.290181 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:05:13.293954 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m15:05:13.294791 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m15:05:13.294981 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m15:05:13.295171 [debug] [MainThread]: On debug: No close available on handle
[0m15:05:13.295378 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:05:13.295587 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:05:13.295764 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:05:13.298340 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.41330644, "process_in_blocks": "0", "process_kernel_time": 0.273091, "process_mem_max_rss": "119160832", "process_out_blocks": "0", "process_user_time": 0.993696}
[0m15:05:13.298766 [debug] [MainThread]: Command `dbt debug` failed at 15:05:13.298702 after 0.41 seconds
[0m15:05:13.299008 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:05:13.299234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d27f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d27d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf8650>]}
[0m15:05:13.299503 [debug] [MainThread]: Flushing usage events
[0m15:05:14.640624 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:06:16.366287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10957b9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960eb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10960f290>]}


============================== 15:06:16.370156 | 6ab1dc48-cfdf-4a71-a1f8-e35b80f17a11 ==============================
[0m15:06:16.370156 [info ] [MainThread]: Running with dbt=1.10.10
[0m15:06:16.370600 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'empty': 'None', 'write_json': 'True', 'invocation_command': 'dbt debug', 'fail_fast': 'False', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'indirect_selection': 'eager', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'target_path': 'None', 'quiet': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'static_parser': 'True', 'version_check': 'True', 'introspect': 'True', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None'}
[0m15:06:16.387972 [info ] [MainThread]: dbt version: 1.10.10
[0m15:06:16.388320 [info ] [MainThread]: python version: 3.11.5
[0m15:06:16.388543 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m15:06:16.388722 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m15:06:16.445190 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt
[0m15:06:16.445546 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/profiles.yml
[0m15:06:16.445739 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/dbt_project.yml
[0m15:06:16.446492 [info ] [MainThread]: adapter type: postgres
[0m15:06:16.446677 [info ] [MainThread]: adapter version: 1.8.2
[0m15:06:16.518184 [info ] [MainThread]: Configuration:
[0m15:06:16.518557 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:06:16.518740 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:06:16.518899 [info ] [MainThread]: Required dependencies:
[0m15:06:16.519374 [debug] [MainThread]: Executing "git --help"
[0m15:06:16.554828 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:06:16.555579 [debug] [MainThread]: STDERR: "b''"
[0m15:06:16.555815 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:06:16.556045 [info ] [MainThread]: Connection:
[0m15:06:16.556254 [info ] [MainThread]:   host: localhost
[0m15:06:16.556407 [info ] [MainThread]:   port: 5432
[0m15:06:16.556552 [info ] [MainThread]:   user: airflow
[0m15:06:16.556695 [info ] [MainThread]:   database: airflow
[0m15:06:16.556836 [info ] [MainThread]:   schema: airflow
[0m15:06:16.556985 [info ] [MainThread]:   connect_timeout: 10
[0m15:06:16.557200 [info ] [MainThread]:   role: None
[0m15:06:16.557422 [info ] [MainThread]:   search_path: None
[0m15:06:16.557582 [info ] [MainThread]:   keepalives_idle: 0
[0m15:06:16.557736 [info ] [MainThread]:   sslmode: None
[0m15:06:16.557879 [info ] [MainThread]:   sslcert: None
[0m15:06:16.558021 [info ] [MainThread]:   sslkey: None
[0m15:06:16.558161 [info ] [MainThread]:   sslrootcert: None
[0m15:06:16.558305 [info ] [MainThread]:   application_name: dbt
[0m15:06:16.558445 [info ] [MainThread]:   retries: 1
[0m15:06:16.558817 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:06:16.620816 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:06:16.693524 [debug] [MainThread]: Using postgres connection "debug"
[0m15:06:16.693882 [debug] [MainThread]: On debug: select 1 as id
[0m15:06:16.694069 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:06:16.697725 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m15:06:16.698429 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m15:06:16.698605 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m15:06:16.698793 [debug] [MainThread]: On debug: No close available on handle
[0m15:06:16.699001 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:06:16.699194 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:06:16.699466 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:06:16.702279 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.4043135, "process_in_blocks": "0", "process_kernel_time": 0.303063, "process_mem_max_rss": "118931456", "process_out_blocks": "0", "process_user_time": 1.011706}
[0m15:06:16.702799 [debug] [MainThread]: Command `dbt debug` failed at 15:06:16.702661 after 0.40 seconds
[0m15:06:16.703129 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:06:16.703390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095e3f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1eced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d37510>]}
[0m15:06:16.703673 [debug] [MainThread]: Flushing usage events
[0m15:06:18.328673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:48.169483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a0a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7c110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9bbd0>]}


============================== 15:07:48.173183 | 02349be6-a095-4f4d-9035-1cbc1516b0ef ==============================
[0m15:07:48.173183 [info ] [MainThread]: Running with dbt=1.10.10
[0m15:07:48.173591 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt debug', 'no_print': 'None', 'printer_width': '80', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'write_json': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'empty': 'None'}
[0m15:07:48.192996 [info ] [MainThread]: dbt version: 1.10.10
[0m15:07:48.193347 [info ] [MainThread]: python version: 3.11.5
[0m15:07:48.193554 [info ] [MainThread]: python path: /Users/dhananjayhawal/anaconda3/bin/python
[0m15:07:48.193730 [info ] [MainThread]: os info: macOS-15.6-arm64-arm-64bit
[0m15:07:48.250217 [info ] [MainThread]: Using profiles dir at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt
[0m15:07:48.250562 [info ] [MainThread]: Using profiles.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/profiles.yml
[0m15:07:48.250756 [info ] [MainThread]: Using dbt_project.yml file at /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/dbt_project.yml
[0m15:07:48.251620 [info ] [MainThread]: adapter type: postgres
[0m15:07:48.251843 [info ] [MainThread]: adapter version: 1.8.2
[0m15:07:48.321601 [info ] [MainThread]: Configuration:
[0m15:07:48.321969 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:07:48.322161 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:07:48.322323 [info ] [MainThread]: Required dependencies:
[0m15:07:48.322742 [debug] [MainThread]: Executing "git --help"
[0m15:07:48.355860 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m15:07:48.356589 [debug] [MainThread]: STDERR: "b''"
[0m15:07:48.356824 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m15:07:48.357045 [info ] [MainThread]: Connection:
[0m15:07:48.357270 [info ] [MainThread]:   host: postgres
[0m15:07:48.357428 [info ] [MainThread]:   port: 5432
[0m15:07:48.357581 [info ] [MainThread]:   user: airflow
[0m15:07:48.357729 [info ] [MainThread]:   database: airflow
[0m15:07:48.357872 [info ] [MainThread]:   schema: airflow
[0m15:07:48.358014 [info ] [MainThread]:   connect_timeout: 10
[0m15:07:48.358162 [info ] [MainThread]:   role: None
[0m15:07:48.358307 [info ] [MainThread]:   search_path: None
[0m15:07:48.358451 [info ] [MainThread]:   keepalives_idle: 0
[0m15:07:48.358588 [info ] [MainThread]:   sslmode: None
[0m15:07:48.358728 [info ] [MainThread]:   sslcert: None
[0m15:07:48.358865 [info ] [MainThread]:   sslkey: None
[0m15:07:48.359006 [info ] [MainThread]:   sslrootcert: None
[0m15:07:48.359150 [info ] [MainThread]:   application_name: dbt
[0m15:07:48.359287 [info ] [MainThread]:   retries: 1
[0m15:07:48.359675 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:07:48.420546 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:07:48.494973 [debug] [MainThread]: Using postgres connection "debug"
[0m15:07:48.495303 [debug] [MainThread]: On debug: select 1 as id
[0m15:07:48.495494 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:48.499957 [debug] [MainThread]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m15:07:48.502185 [debug] [MainThread]: Postgres adapter: Error running SQL: select 1 as id
[0m15:07:48.502410 [debug] [MainThread]: Postgres adapter: Rolling back transaction.
[0m15:07:48.502610 [debug] [MainThread]: On debug: No close available on handle
[0m15:07:48.502823 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m15:07:48.503021 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:07:48.503193 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m15:07:48.505881 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.40132675, "process_in_blocks": "0", "process_kernel_time": 0.31535, "process_mem_max_rss": "121487360", "process_out_blocks": "0", "process_user_time": 1.023774}
[0m15:07:48.506340 [debug] [MainThread]: Command `dbt debug` failed at 15:07:48.506274 after 0.40 seconds
[0m15:07:48.506578 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:07:48.506800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b3e390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a10610>]}
[0m15:07:48.507061 [debug] [MainThread]: Flushing usage events
[0m15:07:50.135270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:43:30.550667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3badf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb58220c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3790bc0>]}


============================== 09:43:30.556828 | ceb7d41b-9167-4e6d-86aa-14d4e6b2c305 ==============================
[0m09:43:30.556828 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:43:30.557700 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'static_parser': 'True', 'log_path': '/opt/airflow/dbt/logs', 'debug': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/dbt/profiles', 'partial_parse': 'True', 'version_check': 'True', 'no_print': 'None', 'warn_error': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'printer_width': '80', 'write_json': 'True', 'use_experimental_parser': 'False', 'invocation_command': 'dbt deps'}
[0m09:43:30.652883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ceb7d41b-9167-4e6d-86aa-14d4e6b2c305', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2d3c3e0>]}
[0m09:43:30.663772 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:43:30.668350 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:43:30.669520 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.15804596, "process_in_blocks": "0", "process_kernel_time": 0.276615, "process_mem_max_rss": "105204", "process_out_blocks": "1515", "process_user_time": 1.620605}
[0m09:43:30.670189 [debug] [MainThread]: Command `dbt deps` succeeded at 09:43:30.670088 after 0.16 seconds
[0m09:43:30.670678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb3a9f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb37e57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb2ab7050>]}
[0m09:43:30.671161 [debug] [MainThread]: Flushing usage events
[0m09:43:32.212301 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:46:00.933316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa39544a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3a7b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3c93920>]}


============================== 09:46:00.939578 | 153eab7a-bc3c-4448-a741-99e22b69a2a7 ==============================
[0m09:46:00.939578 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:46:00.940507 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'static_parser': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'debug': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error': 'None', 'empty': 'None', 'use_colors': 'True', 'invocation_command': 'dbt deps', 'log_path': '/opt/airflow/dbt/logs', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'partial_parse': 'True', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True'}
[0m09:46:01.035158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '153eab7a-bc3c-4448-a741-99e22b69a2a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2afa660>]}
[0m09:46:01.045605 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:46:01.049689 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m09:46:01.050789 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.16005063, "process_in_blocks": "0", "process_kernel_time": 0.329493, "process_mem_max_rss": "105040", "process_out_blocks": "3", "process_user_time": 1.602122}
[0m09:46:01.051326 [debug] [MainThread]: Command `dbt deps` succeeded at 09:46:01.051239 after 0.16 seconds
[0m09:46:01.051776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2985130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29a62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa29ebfe0>]}
[0m09:46:01.052245 [debug] [MainThread]: Flushing usage events
[0m09:46:02.624146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:46:05.539754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa5958f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3faa300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa3930bf0>]}


============================== 09:46:05.545396 | 99ee9719-b19e-4313-ae5c-15393a2a74e8 ==============================
[0m09:46:05.545396 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:46:05.546172 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'use_colors': 'True', 'warn_error': 'None', 'debug': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'printer_width': '80', 'target_path': 'None', 'introspect': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'partial_parse': 'True', 'write_json': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'static_parser': 'True', 'quiet': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --project-dir . --profiles-dir /opt/airflow/dbt'}
[0m09:46:05.673092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99ee9719-b19e-4313-ae5c-15393a2a74e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa292f890>]}
[0m09:46:05.711892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99ee9719-b19e-4313-ae5c-15393a2a74e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f6eff0>]}
[0m09:46:05.712685 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:46:05.764556 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:46:05.819602 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m09:46:05.820498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '99ee9719-b19e-4313-ae5c-15393a2a74e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa38b1b80>]}
[0m09:46:06.404766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99ee9719-b19e-4313-ae5c-15393a2a74e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1760710>]}
[0m09:46:06.450791 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m09:46:06.455298 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m09:46:06.475600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99ee9719-b19e-4313-ae5c-15393a2a74e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1e2a000>]}
[0m09:46:06.476172 [info ] [MainThread]: Found 3 models, 434 macros
[0m09:46:06.476860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99ee9719-b19e-4313-ae5c-15393a2a74e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f33920>]}
[0m09:46:06.478432 [info ] [MainThread]: 
[0m09:46:06.479017 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:46:06.479410 [info ] [MainThread]: 
[0m09:46:06.479885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:46:06.483907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m09:46:06.485068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m09:46:06.491764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m09:46:06.522693 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m09:46:06.523074 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m09:46:06.523460 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m09:46:06.523929 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m09:46:06.524355 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m09:46:06.524797 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m09:46:06.525163 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:06.525520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:06.525858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:46:06.530969 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.005 seconds
[0m09:46:06.531309 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m09:46:06.531572 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m09:46:06.532680 [debug] [ThreadPool]: On list_airflow: Close
[0m09:46:06.533716 [debug] [ThreadPool]: On list_airflow: Close
[0m09:46:06.534716 [debug] [ThreadPool]: On list_airflow: Close
[0m09:46:06.536219 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_gold)
[0m09:46:06.536675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_silver)
[0m09:46:06.537208 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "gold"
"
[0m09:46:06.537773 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "silver"
"
[0m09:46:06.541761 [debug] [ThreadPool]: Using postgres connection "create_airflow_gold"
[0m09:46:06.543217 [debug] [ThreadPool]: Using postgres connection "create_airflow_silver"
[0m09:46:06.543695 [debug] [ThreadPool]: On create_airflow_gold: BEGIN
[0m09:46:06.544153 [debug] [ThreadPool]: On create_airflow_silver: BEGIN
[0m09:46:06.544549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:06.544915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:06.547632 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m09:46:06.547965 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m09:46:06.548377 [debug] [ThreadPool]: Using postgres connection "create_airflow_gold"
[0m09:46:06.548807 [debug] [ThreadPool]: Using postgres connection "create_airflow_silver"
[0m09:46:06.549199 [debug] [ThreadPool]: On create_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "create_airflow_gold"} */
create schema if not exists "gold"
[0m09:46:06.549579 [debug] [ThreadPool]: On create_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "create_airflow_silver"} */
create schema if not exists "silver"
[0m09:46:06.550439 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m09:46:06.550673 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m09:46:06.551486 [debug] [ThreadPool]: On create_airflow_gold: COMMIT
[0m09:46:06.552258 [debug] [ThreadPool]: On create_airflow_silver: COMMIT
[0m09:46:06.552665 [debug] [ThreadPool]: Using postgres connection "create_airflow_gold"
[0m09:46:06.553049 [debug] [ThreadPool]: Using postgres connection "create_airflow_silver"
[0m09:46:06.553433 [debug] [ThreadPool]: On create_airflow_gold: COMMIT
[0m09:46:06.553855 [debug] [ThreadPool]: On create_airflow_silver: COMMIT
[0m09:46:06.554719 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m09:46:06.554977 [debug] [ThreadPool]: SQL status: COMMIT in 0.001 seconds
[0m09:46:06.555304 [debug] [ThreadPool]: On create_airflow_gold: Close
[0m09:46:06.555674 [debug] [ThreadPool]: On create_airflow_silver: Close
[0m09:46:06.557269 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_silver, now list_airflow_gold)
[0m09:46:06.557770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_gold, now list_airflow_silver)
[0m09:46:06.562009 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m09:46:06.562438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_bronze)
[0m09:46:06.563838 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m09:46:06.564267 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m09:46:06.565553 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m09:46:06.565943 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m09:46:06.566306 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:06.566729 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m09:46:06.567111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:06.567740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:46:06.569909 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m09:46:06.570435 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m09:46:06.570757 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m09:46:06.571182 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m09:46:06.571474 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m09:46:06.571798 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m09:46:06.572359 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m09:46:06.572937 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m09:46:06.573361 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m09:46:06.574812 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m09:46:06.576011 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m09:46:06.576374 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m09:46:06.576689 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m09:46:06.577031 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m09:46:06.577953 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m09:46:06.578926 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m09:46:06.579701 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m09:46:06.580059 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m09:46:06.583685 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:06.584283 [debug] [MainThread]: On master: BEGIN
[0m09:46:06.584652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:46:06.587407 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m09:46:06.587826 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:06.588255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:46:06.590812 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m09:46:06.591839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99ee9719-b19e-4313-ae5c-15393a2a74e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1bee960>]}
[0m09:46:06.592377 [debug] [MainThread]: On master: ROLLBACK
[0m09:46:06.592845 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:06.593180 [debug] [MainThread]: On master: BEGIN
[0m09:46:06.593782 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:46:06.594147 [debug] [MainThread]: On master: COMMIT
[0m09:46:06.594469 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:06.594805 [debug] [MainThread]: On master: COMMIT
[0m09:46:06.595222 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:46:06.595570 [debug] [MainThread]: On master: Close
[0m09:46:06.600355 [debug] [Thread-1 (]: Began running node model.elt_assignment.customers_clean
[0m09:46:06.600709 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_raw
[0m09:46:06.601213 [info ] [Thread-1 (]: 1 of 3 START sql table model silver.customers_clean ............................ [RUN]
[0m09:46:06.601938 [info ] [Thread-2 (]: 2 of 3 START sql table model bronze.customers_raw .............................. [RUN]
[0m09:46:06.602481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now model.elt_assignment.customers_clean)
[0m09:46:06.602894 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_bronze, now model.elt_assignment.customers_raw)
[0m09:46:06.603298 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customers_clean
[0m09:46:06.603710 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_raw
[0m09:46:06.608118 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m09:46:06.609500 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m09:46:06.612807 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customers_clean
[0m09:46:06.613086 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_raw
[0m09:46:06.644568 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m09:46:06.646952 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m09:46:06.650050 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m09:46:06.650414 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m09:46:06.650782 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: BEGIN
[0m09:46:06.651158 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: BEGIN
[0m09:46:06.651551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:46:06.651937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:46:06.655039 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m09:46:06.655399 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m09:46:06.655795 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m09:46:06.656178 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m09:46:06.656635 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "airflow"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m09:46:06.657123 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "airflow"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m09:46:06.663647 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.006 seconds
[0m09:46:06.670761 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m09:46:06.671055 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.013 seconds
[0m09:46:06.671435 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m09:46:06.673458 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m09:46:06.674084 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m09:46:06.674700 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:06.684348 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: COMMIT
[0m09:46:06.684815 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m09:46:06.685219 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: COMMIT
[0m09:46:06.687050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:46:06.687450 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m09:46:06.692453 [debug] [Thread-1 (]: Applying DROP to: "airflow"."silver"."customers_clean__dbt_backup"
[0m09:46:06.695068 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m09:46:06.703323 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m09:46:06.703991 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m09:46:06.704751 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "airflow"."silver"."customers_clean__dbt_backup" cascade
[0m09:46:06.706863 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m09:46:06.710079 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:46:06.723677 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: Close
[0m09:46:06.727640 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: COMMIT
[0m09:46:06.729814 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ee9719-b19e-4313-ae5c-15393a2a74e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0bcf3b0>]}
[0m09:46:06.730260 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m09:46:06.731153 [info ] [Thread-1 (]: 1 of 3 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.13s]
[0m09:46:06.732832 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: COMMIT
[0m09:46:06.734146 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customers_clean
[0m09:46:06.740281 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m09:46:06.740853 [debug] [Thread-4 (]: Began running node model.elt_assignment.dim_customers
[0m09:46:06.743295 [debug] [Thread-2 (]: Applying DROP to: "airflow"."bronze"."customers_raw__dbt_backup"
[0m09:46:06.745924 [info ] [Thread-4 (]: 3 of 3 START sql table model gold.dim_customers ................................ [RUN]
[0m09:46:06.748416 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m09:46:06.751046 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.elt_assignment.dim_customers'
[0m09:46:06.752925 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "airflow"."bronze"."customers_raw__dbt_backup" cascade
[0m09:46:06.756942 [debug] [Thread-4 (]: Began compiling node model.elt_assignment.dim_customers
[0m09:46:06.760694 [debug] [Thread-4 (]: Writing injected SQL for node "model.elt_assignment.dim_customers"
[0m09:46:06.763856 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m09:46:06.766180 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: Close
[0m09:46:06.766827 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ee9719-b19e-4313-ae5c-15393a2a74e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0bce930>]}
[0m09:46:06.767220 [debug] [Thread-4 (]: Began executing node model.elt_assignment.dim_customers
[0m09:46:06.768297 [info ] [Thread-2 (]: 2 of 3 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.16s]
[0m09:46:06.771123 [debug] [Thread-4 (]: Writing runtime sql for node "model.elt_assignment.dim_customers"
[0m09:46:06.772102 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_raw
[0m09:46:06.779740 [debug] [Thread-4 (]: Using postgres connection "model.elt_assignment.dim_customers"
[0m09:46:06.784089 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: BEGIN
[0m09:46:06.786880 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:46:06.794000 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m09:46:06.796541 [debug] [Thread-4 (]: Using postgres connection "model.elt_assignment.dim_customers"
[0m09:46:06.798742 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.dim_customers"} */

  
    

  create  table "airflow"."gold"."dim_customers__dbt_tmp"
  
  
    as
  
  (
    -- Gold dimension: anonymized customers with cleaned attributes

SELECT
  customer_hash,
  gender,
  age,
  tenure_months,
  monthly_charges,
  total_charges,
  contract_type,
  internet_service,
  has_tech_support,
  _loaded_at
FROM "airflow"."silver"."customers_clean"
  );
  
[0m09:46:06.809827 [debug] [Thread-4 (]: SQL status: SELECT 1000 in 0.010 seconds
[0m09:46:06.813641 [debug] [Thread-4 (]: Using postgres connection "model.elt_assignment.dim_customers"
[0m09:46:06.816271 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.dim_customers"} */
alter table "airflow"."gold"."dim_customers__dbt_tmp" rename to "dim_customers"
[0m09:46:06.819356 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:46:06.822184 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: COMMIT
[0m09:46:06.822795 [debug] [Thread-4 (]: Using postgres connection "model.elt_assignment.dim_customers"
[0m09:46:06.823217 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: COMMIT
[0m09:46:06.824967 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:46:06.826860 [debug] [Thread-4 (]: Applying DROP to: "airflow"."gold"."dim_customers__dbt_backup"
[0m09:46:06.827473 [debug] [Thread-4 (]: Using postgres connection "model.elt_assignment.dim_customers"
[0m09:46:06.827852 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.dim_customers"} */
drop table if exists "airflow"."gold"."dim_customers__dbt_backup" cascade
[0m09:46:06.828457 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m09:46:06.829566 [debug] [Thread-4 (]: On model.elt_assignment.dim_customers: Close
[0m09:46:06.830126 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99ee9719-b19e-4313-ae5c-15393a2a74e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa0748c80>]}
[0m09:46:06.830816 [info ] [Thread-4 (]: 3 of 3 OK created sql table model gold.dim_customers ........................... [[32mSELECT 1000[0m in 0.08s]
[0m09:46:06.831638 [debug] [Thread-4 (]: Finished running node model.elt_assignment.dim_customers
[0m09:46:06.833144 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:06.833524 [debug] [MainThread]: On master: BEGIN
[0m09:46:06.833797 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:46:06.836765 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m09:46:06.837196 [debug] [MainThread]: On master: COMMIT
[0m09:46:06.837629 [debug] [MainThread]: Using postgres connection "master"
[0m09:46:06.837958 [debug] [MainThread]: On master: COMMIT
[0m09:46:06.838359 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:46:06.838730 [debug] [MainThread]: On master: Close
[0m09:46:06.839124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:46:06.839425 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m09:46:06.839682 [debug] [MainThread]: Connection 'list_airflow_gold' was properly closed.
[0m09:46:06.839919 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m09:46:06.840180 [debug] [MainThread]: Connection 'model.elt_assignment.dim_customers' was properly closed.
[0m09:46:06.840573 [info ] [MainThread]: 
[0m09:46:06.841151 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m09:46:06.842019 [debug] [MainThread]: Command end result
[0m09:46:06.860118 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m09:46:06.862152 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m09:46:06.867170 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m09:46:06.867543 [info ] [MainThread]: 
[0m09:46:06.868134 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:46:06.868587 [info ] [MainThread]: 
[0m09:46:06.868966 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m09:46:06.869985 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3703904, "process_in_blocks": "1512", "process_kernel_time": 0.191402, "process_mem_max_rss": "125672", "process_out_blocks": "2567", "process_user_time": 2.483223}
[0m09:46:06.870487 [debug] [MainThread]: Command `dbt run` succeeded at 09:46:06.870418 after 1.37 seconds
[0m09:46:06.870864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa2cdfb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa1f6d6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa50e6b70>]}
[0m09:46:06.871300 [debug] [MainThread]: Flushing usage events
[0m09:46:08.273054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:46:10.613716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9b442f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbadecd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8b7d190>]}


============================== 09:46:10.618793 | 4b098188-4522-4811-891a-64642bb4344c ==============================
[0m09:46:10.618793 [info ] [MainThread]: Running with dbt=1.10.11
[0m09:46:10.619567 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'quiet': 'False', 'use_colors': 'True', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'version_check': 'True', 'log_path': 'logs', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'introspect': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/opt/airflow/dbt', 'empty': 'None', 'invocation_command': 'dbt test --project-dir . --profiles-dir /opt/airflow/dbt', 'partial_parse': 'True', 'printer_width': '80', 'static_parser': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'warn_error': 'None'}
[0m09:46:10.737300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b098188-4522-4811-891a-64642bb4344c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e7e0c0>]}
[0m09:46:10.776034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b098188-4522-4811-891a-64642bb4344c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb929a180>]}
[0m09:46:10.776781 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m09:46:10.827363 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m09:46:10.895110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:46:10.895665 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:46:10.914080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b098188-4522-4811-891a-64642bb4344c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb73e7b00>]}
[0m09:46:10.958264 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m09:46:10.960873 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m09:46:10.985412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b098188-4522-4811-891a-64642bb4344c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6e94620>]}
[0m09:46:10.985957 [info ] [MainThread]: Found 3 models, 434 macros
[0m09:46:10.986616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b098188-4522-4811-891a-64642bb4344c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb731aed0>]}
[0m09:46:10.988373 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:46:10.989869 [debug] [MainThread]: Command end result
[0m09:46:11.009685 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m09:46:11.011879 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m09:46:11.015208 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m09:46:11.016047 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44025576, "process_in_blocks": "0", "process_kernel_time": 0.121353, "process_mem_max_rss": "116112", "process_out_blocks": "1664", "process_user_time": 1.766144}
[0m09:46:11.016536 [debug] [MainThread]: Command `dbt test` succeeded at 09:46:11.016466 after 0.44 seconds
[0m09:46:11.016905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7f9a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb744ede0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6e743e0>]}
[0m09:46:11.017269 [debug] [MainThread]: Flushing usage events
[0m09:46:12.429302 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:09.797720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10737be10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107413450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107413b50>]}


============================== 19:36:09.801540 | b621880f-5b6c-4651-afe2-aba0c94b245d ==============================
[0m19:36:09.801540 [info ] [MainThread]: Running with dbt=1.10.10
[0m19:36:09.801916 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'invocation_command': 'dbt run --select customers_clean', 'fail_fast': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'quiet': 'False', 'write_json': 'True', 'printer_width': '80', 'warn_error': 'None', 'log_format': 'default', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'partial_parse': 'True', 'introspect': 'True', 'static_parser': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m19:36:10.100938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b621880f-5b6c-4651-afe2-aba0c94b245d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073dff50>]}
[0m19:36:10.138825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b621880f-5b6c-4651-afe2-aba0c94b245d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781c950>]}
[0m19:36:10.139924 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:36:10.188754 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:36:10.191266 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.45077074, "process_in_blocks": "0", "process_kernel_time": 0.292771, "process_mem_max_rss": "115851264", "process_out_blocks": "0", "process_user_time": 0.845125}
[0m19:36:10.191662 [debug] [MainThread]: Command `dbt run` failed at 19:36:10.191608 after 0.45 seconds
[0m19:36:10.191929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107413810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073aa790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107801290>]}
[0m19:36:10.192139 [debug] [MainThread]: Flushing usage events
[0m19:36:13.047092 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:18.768164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a67bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a713490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a713b90>]}


============================== 19:36:18.771183 | 0ec474d5-25fa-47e4-a34c-992ba755578b ==============================
[0m19:36:18.771183 [info ] [MainThread]: Running with dbt=1.10.10
[0m19:36:18.771525 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'empty': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --select customers_clean.sql', 'no_print': 'None', 'use_colors': 'True', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'target_path': 'None', 'printer_width': '80', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:36:18.965140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ec474d5-25fa-47e4-a34c-992ba755578b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa43fd0>]}
[0m19:36:19.008525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ec474d5-25fa-47e4-a34c-992ba755578b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c79090>]}
[0m19:36:19.009404 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:36:19.062715 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m19:36:19.065074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.35068533, "process_in_blocks": "0", "process_kernel_time": 0.251844, "process_mem_max_rss": "116342784", "process_out_blocks": "0", "process_user_time": 0.85086}
[0m19:36:19.065479 [debug] [MainThread]: Command `dbt run` failed at 19:36:19.065426 after 0.35 seconds
[0m19:36:19.065751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a713590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a713990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad3fd0>]}
[0m19:36:19.065962 [debug] [MainThread]: Flushing usage events
[0m19:36:20.870138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:30.440414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b17f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b206e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b207510>]}


============================== 19:36:30.443610 | aa93b246-5552-4af9-84c8-9ab084d92b59 ==============================
[0m19:36:30.443610 [info ] [MainThread]: Running with dbt=1.10.10
[0m19:36:30.443939 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'debug': 'False', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'fail_fast': 'False', 'log_format': 'default', 'printer_width': '80', 'cache_selected_only': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'version_check': 'True', 'empty': 'None', 'no_print': 'None', 'partial_parse': 'True'}
[0m19:36:30.580233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa93b246-5552-4af9-84c8-9ab084d92b59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b359990>]}
[0m19:36:30.597092 [debug] [MainThread]: Set downloads directory='/var/folders/w8/tqn1xf5s0q5fhcvjg8fg_nbc0000gn/T/dbt-downloads-jo50wqp6'
[0m19:36:30.597474 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:36:32.743941 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:36:32.747559 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:36:33.024939 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:36:33.048311 [info ] [MainThread]: Updating lock file in file path: /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/package-lock.yml
[0m19:36:33.054564 [debug] [MainThread]: Set downloads directory='/var/folders/w8/tqn1xf5s0q5fhcvjg8fg_nbc0000gn/T/dbt-downloads-qzwtxduk'
[0m19:36:33.058716 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:36:34.040184 [info ] [MainThread]: Installed from version 1.3.0
[0m19:36:34.040505 [info ] [MainThread]: Up to date!
[0m19:36:34.040768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aa93b246-5552-4af9-84c8-9ab084d92b59', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b31c750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2f24d0>]}
[0m19:36:34.043763 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.6562946, "process_in_blocks": "0", "process_kernel_time": 0.30369, "process_mem_max_rss": "117260288", "process_out_blocks": "0", "process_user_time": 0.939711}
[0m19:36:34.044129 [debug] [MainThread]: Command `dbt deps` succeeded at 19:36:34.044075 after 3.66 seconds
[0m19:36:34.044324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b20bb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b20bbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a844950>]}
[0m19:36:34.044505 [debug] [MainThread]: Flushing usage events
[0m19:36:35.442643 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:36:42.881156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11230ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112396f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112397610>]}


============================== 19:36:42.884653 | 31000ad1-e564-4ab3-88ee-35b2e365a9be ==============================
[0m19:36:42.884653 [info ] [MainThread]: Running with dbt=1.10.10
[0m19:36:42.885007 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'warn_error': 'None', 'partial_parse': 'True', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'log_format': 'default', 'use_experimental_parser': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --select customers_clean.sql', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'target_path': 'None', 'printer_width': '80', 'indirect_selection': 'eager', 'debug': 'False', 'empty': 'False', 'quiet': 'False', 'write_json': 'True', 'introspect': 'True'}
[0m19:36:43.072234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '31000ad1-e564-4ab3-88ee-35b2e365a9be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113140290>]}
[0m19:36:43.107781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '31000ad1-e564-4ab3-88ee-35b2e365a9be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107407450>]}
[0m19:36:43.108891 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:36:43.165984 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m19:36:43.207768 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m19:36:43.208086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '31000ad1-e564-4ab3-88ee-35b2e365a9be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111547210>]}
[0m19:36:43.809274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31000ad1-e564-4ab3-88ee-35b2e365a9be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113981010>]}
[0m19:36:43.842965 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/target/manifest.json
[0m19:36:43.845666 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/target/semantic_manifest.json
[0m19:36:43.868920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31000ad1-e564-4ab3-88ee-35b2e365a9be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c93d90>]}
[0m19:36:43.869194 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m19:36:43.869373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31000ad1-e564-4ab3-88ee-35b2e365a9be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132dfdd0>]}
[0m19:36:43.869986 [info ] [MainThread]: 
[0m19:36:43.870151 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:36:43.870283 [info ] [MainThread]: 
[0m19:36:43.870505 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:36:43.870892 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m19:36:43.939018 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m19:36:43.939288 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:36:43.939425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:44.112869 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m19:36:44.117452 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.10.10", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m19:36:44.117617 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:36:44.117848 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m19:36:44.117976 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:36:44.118138 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m19:36:44.118640 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:44.118770 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m19:36:44.118918 [info ] [MainThread]: 
[0m19:36:44.119101 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m19:36:44.119412 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  
[0m19:36:44.122136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2993279, "process_in_blocks": "0", "process_kernel_time": 0.275804, "process_mem_max_rss": "132464640", "process_out_blocks": "0", "process_user_time": 1.462575}
[0m19:36:44.122389 [debug] [MainThread]: Command `dbt run` failed at 19:36:44.122351 after 1.30 seconds
[0m19:36:44.122560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120c3090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11230b510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b6fad0>]}
[0m19:36:44.122740 [debug] [MainThread]: Flushing usage events
[0m19:36:45.582933 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:23.962409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b107410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa375d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b197b50>]}


============================== 19:39:23.965765 | 6d331644-7042-4de1-8f06-efdc3769fcab ==============================
[0m19:39:23.965765 [info ] [MainThread]: Running with dbt=1.10.10
[0m19:39:23.966256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'write_json': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt', 'log_path': '/Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/logs', 'log_format': 'default', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'partial_parse': 'True', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt compile', 'log_cache_events': 'False', 'static_parser': 'True'}
[0m19:39:24.305299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d331644-7042-4de1-8f06-efdc3769fcab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b281850>]}
[0m19:39:24.340923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d331644-7042-4de1-8f06-efdc3769fcab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106807a10>]}
[0m19:39:24.341828 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m19:39:24.403760 [debug] [MainThread]: checksum: 502a0dc23e9052e1ae09f7c44ee219ef7a02dfea7e7d66580d54c304c14d553b, vars: {}, profile: , target: , version: 1.10.10
[0m19:39:24.512109 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:39:24.512444 [debug] [MainThread]: Partial parsing: updated file: elt_assignment://models/gold/customer_360.sql
[0m19:39:24.657973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d331644-7042-4de1-8f06-efdc3769fcab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c980a50>]}
[0m19:39:24.691470 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/target/manifest.json
[0m19:39:24.694208 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/dhananjayhawal/Documents/GitHub/Open_Source_ETL_Pipelines/airflow-quickstart/dbt/target/semantic_manifest.json
[0m19:39:24.713364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d331644-7042-4de1-8f06-efdc3769fcab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb649d0>]}
[0m19:39:24.713651 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m19:39:24.713836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d331644-7042-4de1-8f06-efdc3769fcab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c862490>]}
[0m19:39:24.714625 [info ] [MainThread]: 
[0m19:39:24.714797 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:39:24.714925 [info ] [MainThread]: 
[0m19:39:24.715152 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m19:39:24.715605 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_silver'
[0m19:39:24.715962 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_gold'
[0m19:39:24.721025 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_bronze'
[0m19:39:24.810180 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m19:39:24.810393 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m19:39:24.810554 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m19:39:24.810717 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m19:39:24.810872 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m19:39:24.811006 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m19:39:24.811146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:24.811278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:24.811404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:39:24.815753 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m19:39:24.815972 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m19:39:24.816207 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "postgres" to address: nodename nor servname provided, or not known

[0m19:39:24.819594 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m19:39:24.819766 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m19:39:24.819938 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m19:39:24.820055 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:39:24.820193 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:39:24.820330 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:39:24.820517 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m19:39:24.820696 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m19:39:24.820857 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m19:39:24.820992 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:39:24.821119 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:39:24.821246 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m19:39:24.821386 [debug] [ThreadPool]: On list_airflow_gold: No close available on handle
[0m19:39:24.821528 [debug] [ThreadPool]: On list_airflow_silver: No close available on handle
[0m19:39:24.821669 [debug] [ThreadPool]: On list_airflow_bronze: No close available on handle
[0m19:39:24.822334 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:39:24.822556 [debug] [MainThread]: Connection 'list_airflow_silver' was properly closed.
[0m19:39:24.822695 [debug] [MainThread]: Connection 'list_airflow_gold' was properly closed.
[0m19:39:24.822815 [debug] [MainThread]: Connection 'list_airflow_bronze' was properly closed.
[0m19:39:24.823064 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "postgres" to address: nodename nor servname provided, or not known
  
[0m19:39:24.825369 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": false, "command_wall_clock_time": 0.92131954, "process_in_blocks": "0", "process_kernel_time": 0.31867, "process_mem_max_rss": "132628480", "process_out_blocks": "0", "process_user_time": 1.119132}
[0m19:39:24.825698 [debug] [MainThread]: Command `dbt compile` failed at 19:39:24.825653 after 0.92 seconds
[0m19:39:24.825893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1972d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b197950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c2f8850>]}
[0m19:39:24.826090 [debug] [MainThread]: Flushing usage events
[0m19:39:26.695593 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:11:58.244130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96c00e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98cf9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96a48890>]}


============================== 14:11:58.251030 | 36966cc2-f5ef-420f-ad98-6055904e4e67 ==============================
[0m14:11:58.251030 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:11:58.252724 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_cache_events': 'False', 'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'target_path': 'None', 'write_json': 'True', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/opt/airflow/dbt/logs', 'invocation_command': 'dbt deps', 'introspect': 'True', 'fail_fast': 'False', 'log_format': 'default', 'use_colors': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'partial_parse': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'debug': 'False', 'static_parser': 'True'}
[0m14:11:58.357579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36966cc2-f5ef-420f-ad98-6055904e4e67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff969af2c0>]}
[0m14:11:58.594570 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ojf1ojrp'
[0m14:11:58.595085 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:12:00.537381 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:12:00.539294 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:12:00.753692 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:12:00.756933 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:12:01.951561 [info ] [MainThread]: Installed from version 1.3.0
[0m14:12:01.952643 [info ] [MainThread]: Up to date!
[0m14:12:01.953252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '36966cc2-f5ef-420f-ad98-6055904e4e67', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff967d8d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff967c0fb0>]}
[0m14:12:01.954879 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.7487779, "process_in_blocks": "10208", "process_kernel_time": 0.546571, "process_mem_max_rss": "105808", "process_out_blocks": "2245", "process_user_time": 1.455184}
[0m14:12:01.955633 [debug] [MainThread]: Command `dbt deps` succeeded at 14:12:01.955467 after 3.75 seconds
[0m14:12:01.956187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98609880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c92ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c92960>]}
[0m14:12:01.956648 [debug] [MainThread]: Flushing usage events
[0m14:12:03.630149 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:12:06.028671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8b03320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbabc9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb86e8bf0>]}


============================== 14:12:06.032975 | 14d22aef-dae3-4ad9-9305-df61133b7e3a ==============================
[0m14:12:06.032975 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:12:06.033639 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_format': 'default', 'quiet': 'False', 'debug': 'False', 'use_experimental_parser': 'False', 'no_print': 'None', 'static_parser': 'True', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'version_check': 'True', 'log_path': 'logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --project-dir . --profiles-dir /opt/airflow/dbt', 'use_colors': 'True', 'empty': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'partial_parse': 'True', 'log_cache_events': 'False'}
[0m14:12:06.134926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14d22aef-dae3-4ad9-9305-df61133b7e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7bfdd60>]}
[0m14:12:06.167043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14d22aef-dae3-4ad9-9305-df61133b7e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7be2ed0>]}
[0m14:12:06.167782 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:12:06.221032 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:12:06.269359 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m14:12:06.270149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '14d22aef-dae3-4ad9-9305-df61133b7e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba0001d0>]}
[0m14:12:06.981205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14d22aef-dae3-4ad9-9305-df61133b7e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6d40bf0>]}
[0m14:12:07.026863 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:12:07.029319 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:12:07.057630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14d22aef-dae3-4ad9-9305-df61133b7e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6c746b0>]}
[0m14:12:07.058106 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m14:12:07.058881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14d22aef-dae3-4ad9-9305-df61133b7e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6cd1040>]}
[0m14:12:07.060333 [info ] [MainThread]: 
[0m14:12:07.061174 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:12:07.061796 [info ] [MainThread]: 
[0m14:12:07.062537 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:12:07.065155 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:12:07.065740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:12:07.072029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:12:07.097024 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:12:07.097376 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:12:07.097591 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:12:07.097886 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:12:07.098199 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:12:07.098487 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:12:07.098763 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:07.099039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:07.099295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:07.104861 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m14:12:07.106065 [debug] [ThreadPool]: On list_airflow: Close
[0m14:12:07.106299 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.008 seconds
[0m14:12:07.109594 [debug] [ThreadPool]: On list_airflow: Close
[0m14:12:07.114192 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m14:12:07.115068 [debug] [ThreadPool]: On list_airflow: Close
[0m14:12:07.115565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_gold)
[0m14:12:07.115808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now create_airflow_silver)
[0m14:12:07.116302 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "gold"
"
[0m14:12:07.116651 [debug] [ThreadPool]: Creating schema "database: "airflow"
schema: "silver"
"
[0m14:12:07.120419 [debug] [ThreadPool]: Using postgres connection "create_airflow_gold"
[0m14:12:07.121667 [debug] [ThreadPool]: Using postgres connection "create_airflow_silver"
[0m14:12:07.122017 [debug] [ThreadPool]: On create_airflow_gold: BEGIN
[0m14:12:07.122298 [debug] [ThreadPool]: On create_airflow_silver: BEGIN
[0m14:12:07.122566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:07.122812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:07.125036 [debug] [ThreadPool]: SQL status: BEGIN in 0.002 seconds
[0m14:12:07.125299 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:12:07.125557 [debug] [ThreadPool]: Using postgres connection "create_airflow_silver"
[0m14:12:07.125825 [debug] [ThreadPool]: Using postgres connection "create_airflow_gold"
[0m14:12:07.126102 [debug] [ThreadPool]: On create_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "create_airflow_silver"} */
create schema if not exists "silver"
[0m14:12:07.126372 [debug] [ThreadPool]: On create_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "create_airflow_gold"} */
create schema if not exists "gold"
[0m14:12:07.127096 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.000 seconds
[0m14:12:07.127260 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.001 seconds
[0m14:12:07.128885 [debug] [ThreadPool]: On create_airflow_gold: COMMIT
[0m14:12:07.129537 [debug] [ThreadPool]: On create_airflow_silver: COMMIT
[0m14:12:07.129824 [debug] [ThreadPool]: Using postgres connection "create_airflow_gold"
[0m14:12:07.130116 [debug] [ThreadPool]: Using postgres connection "create_airflow_silver"
[0m14:12:07.130381 [debug] [ThreadPool]: On create_airflow_gold: COMMIT
[0m14:12:07.130644 [debug] [ThreadPool]: On create_airflow_silver: COMMIT
[0m14:12:07.131296 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m14:12:07.131488 [debug] [ThreadPool]: SQL status: COMMIT in 0.000 seconds
[0m14:12:07.131728 [debug] [ThreadPool]: On create_airflow_gold: Close
[0m14:12:07.131998 [debug] [ThreadPool]: On create_airflow_silver: Close
[0m14:12:07.133398 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_silver, now list_airflow_gold)
[0m14:12:07.133739 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_airflow_gold, now list_airflow_silver)
[0m14:12:07.134083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_bronze)
[0m14:12:07.137325 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:12:07.138482 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:12:07.139507 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:12:07.139787 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m14:12:07.140048 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m14:12:07.140273 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m14:12:07.140521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:07.140769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:07.141063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:07.143469 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:12:07.143752 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:12:07.144175 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:12:07.144408 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:12:07.144724 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:12:07.145086 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:12:07.145496 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:12:07.145908 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:12:07.146274 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m14:12:07.149488 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m14:12:07.150368 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:12:07.151220 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m14:12:07.152075 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m14:12:07.152287 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.006 seconds
[0m14:12:07.152631 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m14:12:07.152908 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m14:12:07.153540 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m14:12:07.154485 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m14:12:07.157426 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:07.157808 [debug] [MainThread]: On master: BEGIN
[0m14:12:07.158109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:07.161344 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:12:07.161676 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:07.162020 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:12:07.167339 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m14:12:07.168595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14d22aef-dae3-4ad9-9305-df61133b7e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba282c30>]}
[0m14:12:07.169050 [debug] [MainThread]: On master: ROLLBACK
[0m14:12:07.169471 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:07.169740 [debug] [MainThread]: On master: BEGIN
[0m14:12:07.170159 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:12:07.170425 [debug] [MainThread]: On master: COMMIT
[0m14:12:07.170675 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:07.170914 [debug] [MainThread]: On master: COMMIT
[0m14:12:07.171239 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:12:07.171498 [debug] [MainThread]: On master: Close
[0m14:12:07.175164 [debug] [Thread-1 (]: Began running node model.elt_assignment.customer_360
[0m14:12:07.175438 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_clean
[0m14:12:07.175673 [debug] [Thread-3 (]: Began running node model.elt_assignment.customers_raw
[0m14:12:07.176101 [info ] [Thread-1 (]: 1 of 3 START sql table model gold.customer_360 ................................. [RUN]
[0m14:12:07.176812 [info ] [Thread-2 (]: 2 of 3 START sql table model silver.customers_clean ............................ [RUN]
[0m14:12:07.177273 [info ] [Thread-3 (]: 3 of 3 START sql table model bronze.customers_raw .............................. [RUN]
[0m14:12:07.177700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now model.elt_assignment.customer_360)
[0m14:12:07.178049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_bronze, now model.elt_assignment.customers_clean)
[0m14:12:07.178363 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airflow_gold, now model.elt_assignment.customers_raw)
[0m14:12:07.178657 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customer_360
[0m14:12:07.178938 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_clean
[0m14:12:07.179249 [debug] [Thread-3 (]: Began compiling node model.elt_assignment.customers_raw
[0m14:12:07.183653 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customer_360"
[0m14:12:07.184855 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m14:12:07.186404 [debug] [Thread-3 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m14:12:07.190692 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customer_360
[0m14:12:07.191089 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_clean
[0m14:12:07.202580 [debug] [Thread-3 (]: Began executing node model.elt_assignment.customers_raw
[0m14:12:07.220184 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m14:12:07.221616 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customer_360"
[0m14:12:07.223509 [debug] [Thread-3 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m14:12:07.227098 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:12:07.227411 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:12:07.227790 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: BEGIN
[0m14:12:07.228140 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:12:07.228409 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: BEGIN
[0m14:12:07.228718 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:12:07.229033 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: BEGIN
[0m14:12:07.229351 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:12:07.229964 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:12:07.232353 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m14:12:07.232678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:12:07.233060 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:12:07.233293 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m14:12:07.233559 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:12:07.233896 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "airflow"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m14:12:07.234254 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:12:07.234571 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */

  
    

  create  table "airflow"."gold"."customer_360__dbt_tmp"
  
  
    as
  
  (
    

SELECT * FROM "airflow"."silver"."customer_churn"
  );
  
[0m14:12:07.235079 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "airflow"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m14:12:07.235918 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "silver.customer_churn" does not exist
LINE 14: SELECT * FROM "airflow"."silver"."customer_churn"
                       ^

[0m14:12:07.236395 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: ROLLBACK
[0m14:12:07.237060 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: Close
[0m14:12:07.241131 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.005 seconds
[0m14:12:07.247825 [debug] [Thread-1 (]: Database Error in model customer_360 (models/gold/customer_360.sql)
  relation "silver.customer_churn" does not exist
  LINE 14: SELECT * FROM "airflow"."silver"."customer_churn"
                         ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql
[0m14:12:07.248083 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.013 seconds
[0m14:12:07.247084 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:12:07.249297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d22aef-dae3-4ad9-9305-df61133b7e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6ac7230>]}
[0m14:12:07.250909 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:12:07.251266 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m14:12:07.251756 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model gold.customer_360 ........................ [[31mERROR[0m in 0.07s]
[0m14:12:07.252307 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m14:12:07.252831 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customer_360
[0m14:12:07.253339 [debug] [Thread-7 (]: Marking all children of 'model.elt_assignment.customer_360' to be skipped because of status 'error'.  Reason: Database Error in model customer_360 (models/gold/customer_360.sql)
  relation "silver.customer_churn" does not exist
  LINE 14: SELECT * FROM "airflow"."silver"."customer_churn"
                         ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql.
[0m14:12:07.253551 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:12:07.261711 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:12:07.262102 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:12:07.262416 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:12:07.268505 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m14:12:07.268800 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m14:12:07.272354 [debug] [Thread-2 (]: Applying DROP to: "airflow"."silver"."customers_clean__dbt_backup"
[0m14:12:07.275644 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:12:07.279348 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:12:07.279817 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m14:12:07.280243 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "airflow"."silver"."customers_clean__dbt_backup" cascade
[0m14:12:07.280905 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:12:07.281143 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:12:07.283240 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:12:07.284736 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: Close
[0m14:12:07.285115 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:12:07.285649 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d22aef-dae3-4ad9-9305-df61133b7e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb5b96ab0>]}
[0m14:12:07.286015 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:12:07.286557 [info ] [Thread-2 (]: 2 of 3 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.11s]
[0m14:12:07.287473 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_clean
[0m14:12:07.287848 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:12:07.289481 [debug] [Thread-3 (]: Applying DROP to: "airflow"."bronze"."customers_raw__dbt_backup"
[0m14:12:07.289892 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:12:07.290189 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "airflow"."bronze"."customers_raw__dbt_backup" cascade
[0m14:12:07.292761 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:12:07.293632 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: Close
[0m14:12:07.294105 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14d22aef-dae3-4ad9-9305-df61133b7e3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb6ac6ba0>]}
[0m14:12:07.294578 [info ] [Thread-3 (]: 3 of 3 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.12s]
[0m14:12:07.295279 [debug] [Thread-3 (]: Finished running node model.elt_assignment.customers_raw
[0m14:12:07.296387 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:07.296677 [debug] [MainThread]: On master: BEGIN
[0m14:12:07.296944 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:07.303823 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:12:07.304218 [debug] [MainThread]: On master: COMMIT
[0m14:12:07.304487 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:07.304734 [debug] [MainThread]: On master: COMMIT
[0m14:12:07.305058 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:12:07.305309 [debug] [MainThread]: On master: Close
[0m14:12:07.305627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:07.305897 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m14:12:07.306238 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m14:12:07.306483 [debug] [MainThread]: Connection 'model.elt_assignment.customer_360' was properly closed.
[0m14:12:07.306789 [info ] [MainThread]: 
[0m14:12:07.307238 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m14:12:07.307922 [debug] [MainThread]: Command end result
[0m14:12:07.330364 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:12:07.334936 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:12:07.339396 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:12:07.339725 [info ] [MainThread]: 
[0m14:12:07.340381 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:12:07.340851 [info ] [MainThread]: 
[0m14:12:07.341444 [error] [MainThread]: [31mFailure in model customer_360 (models/gold/customer_360.sql)[0m
[0m14:12:07.341888 [error] [MainThread]:   Database Error in model customer_360 (models/gold/customer_360.sql)
  relation "silver.customer_churn" does not exist
  LINE 14: SELECT * FROM "airflow"."silver"."customer_churn"
                         ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql
[0m14:12:07.342285 [info ] [MainThread]: 
[0m14:12:07.342775 [info ] [MainThread]:   compiled code at target/compiled/elt_assignment/models/gold/customer_360.sql
[0m14:12:07.343334 [info ] [MainThread]: 
[0m14:12:07.343688 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:12:07.344471 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3468314, "process_in_blocks": "1536", "process_kernel_time": 0.312607, "process_mem_max_rss": "128752", "process_out_blocks": "3346", "process_user_time": 2.162121}
[0m14:12:07.344862 [debug] [MainThread]: Command `dbt run` failed at 14:12:07.344808 after 1.35 seconds
[0m14:12:07.345182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7ca6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9030440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb57451f0>]}
[0m14:12:07.345478 [debug] [MainThread]: Flushing usage events
[0m14:12:09.095315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:13:55.656524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80171b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f9055e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7ee54890>]}


============================== 14:13:55.662931 | a1a7cc1a-d482-4f26-ae32-6645fa0d8413 ==============================
[0m14:13:55.662931 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:13:55.663644 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'empty': 'None', 'log_path': '/opt/airflow/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'version_check': 'True', 'target_path': 'None', 'write_json': 'True', 'printer_width': '80', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'use_colors': 'True'}
[0m14:13:55.747007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1a7cc1a-d482-4f26-ae32-6645fa0d8413', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eb56bd0>]}
[0m14:13:55.888466 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ni8ux59p'
[0m14:13:55.889005 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:13:59.095483 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:13:59.097764 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:13:59.883022 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:13:59.891610 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:14:01.080397 [info ] [MainThread]: Installed from version 1.3.0
[0m14:14:01.082333 [info ] [MainThread]: Up to date!
[0m14:14:01.083085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a1a7cc1a-d482-4f26-ae32-6645fa0d8413', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7f885af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fa4f500>]}
[0m14:14:01.085643 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.4620976, "process_in_blocks": "216", "process_kernel_time": 0.69202, "process_mem_max_rss": "105752", "process_out_blocks": "733", "process_user_time": 1.474697}
[0m14:14:01.086363 [debug] [MainThread]: Command `dbt deps` succeeded at 14:14:01.086290 after 5.46 seconds
[0m14:14:01.086833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff80146d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7fd50b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff7eadfc50>]}
[0m14:14:01.087217 [debug] [MainThread]: Flushing usage events
[0m14:14:02.749973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:05.196808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1fe210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9dee0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e1fe3f0>]}


============================== 14:14:05.201686 | 620891eb-e8b7-48ac-8e62-a40c6e7ecb24 ==============================
[0m14:14:05.201686 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:14:05.202544 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'quiet': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir . --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_path': 'logs', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'log_format': 'default', 'log_cache_events': 'False', 'introspect': 'True', 'empty': 'False'}
[0m14:14:05.319497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '620891eb-e8b7-48ac-8e62-a40c6e7ecb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9e0e4b30>]}
[0m14:14:05.353886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '620891eb-e8b7-48ac-8e62-a40c6e7ecb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f3b65d0>]}
[0m14:14:05.354658 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:14:05.401545 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:14:05.511230 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:14:05.511869 [debug] [MainThread]: Partial parsing: updated file: elt_assignment://models/silver.yml
[0m14:14:05.512187 [debug] [MainThread]: Partial parsing: updated file: elt_assignment://models/gold/customer_360.sql
[0m14:14:05.687654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '620891eb-e8b7-48ac-8e62-a40c6e7ecb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c1cd490>]}
[0m14:14:05.735059 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:14:05.737710 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:14:05.752895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '620891eb-e8b7-48ac-8e62-a40c6e7ecb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bea78c0>]}
[0m14:14:05.753337 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m14:14:05.753899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '620891eb-e8b7-48ac-8e62-a40c6e7ecb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bba1220>]}
[0m14:14:05.755047 [info ] [MainThread]: 
[0m14:14:05.755479 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:14:05.755825 [info ] [MainThread]: 
[0m14:14:05.756289 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:14:05.758610 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:14:05.759078 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:14:05.765403 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:14:05.790052 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:14:05.790356 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:14:05.790650 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:14:05.790859 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:14:05.791172 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:14:05.791486 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:14:05.791793 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:05.792077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:05.792372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:05.797958 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m14:14:05.798282 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m14:14:05.799569 [debug] [ThreadPool]: On list_airflow: Close
[0m14:14:05.799835 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m14:14:05.800598 [debug] [ThreadPool]: On list_airflow: Close
[0m14:14:05.801774 [debug] [ThreadPool]: On list_airflow: Close
[0m14:14:05.803801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_silver)
[0m14:14:05.804403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_bronze)
[0m14:14:05.805098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_gold)
[0m14:14:05.808843 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:14:05.810546 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:14:05.811740 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:14:05.812146 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m14:14:05.812640 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m14:14:05.813051 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m14:14:05.813447 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:05.813791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:05.814048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:14:05.817188 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:14:05.817794 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:14:05.818079 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:14:05.818403 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:14:05.818724 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:14:05.819212 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m14:14:05.819635 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:14:05.819925 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:14:05.820283 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:14:05.821284 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:14:05.821555 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:14:05.822542 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m14:14:05.823512 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m14:14:05.823796 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m14:14:05.824134 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m14:14:05.824407 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m14:14:05.825047 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m14:14:05.826370 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m14:14:05.829546 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:05.829904 [debug] [MainThread]: On master: BEGIN
[0m14:14:05.830132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:05.832782 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:14:05.833101 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:05.833387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:14:05.835569 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:14:05.836409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '620891eb-e8b7-48ac-8e62-a40c6e7ecb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b796690>]}
[0m14:14:05.836765 [debug] [MainThread]: On master: ROLLBACK
[0m14:14:05.837158 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:05.837391 [debug] [MainThread]: On master: BEGIN
[0m14:14:05.837941 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:14:05.838304 [debug] [MainThread]: On master: COMMIT
[0m14:14:05.838587 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:05.838871 [debug] [MainThread]: On master: COMMIT
[0m14:14:05.839214 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:14:05.839457 [debug] [MainThread]: On master: Close
[0m14:14:05.842518 [debug] [Thread-1 (]: Began running node model.elt_assignment.customer_360
[0m14:14:05.842800 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_clean
[0m14:14:05.843038 [debug] [Thread-3 (]: Began running node model.elt_assignment.customers_raw
[0m14:14:05.843453 [info ] [Thread-1 (]: 1 of 3 START sql table model gold.customer_360 ................................. [RUN]
[0m14:14:05.844191 [info ] [Thread-2 (]: 2 of 3 START sql table model silver.customers_clean ............................ [RUN]
[0m14:14:05.844721 [info ] [Thread-3 (]: 3 of 3 START sql table model bronze.customers_raw .............................. [RUN]
[0m14:14:05.845201 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_gold, now model.elt_assignment.customer_360)
[0m14:14:05.845599 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_bronze, now model.elt_assignment.customers_clean)
[0m14:14:05.845975 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now model.elt_assignment.customers_raw)
[0m14:14:05.846417 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customer_360
[0m14:14:05.846846 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_clean
[0m14:14:05.847178 [debug] [Thread-3 (]: Began compiling node model.elt_assignment.customers_raw
[0m14:14:05.851370 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customer_360"
[0m14:14:05.852554 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m14:14:05.853648 [debug] [Thread-3 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m14:14:05.856686 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customer_360
[0m14:14:05.863636 [debug] [Thread-3 (]: Began executing node model.elt_assignment.customers_raw
[0m14:14:05.869911 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_clean
[0m14:14:05.920457 [debug] [Thread-3 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m14:14:05.920879 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customer_360"
[0m14:14:05.922576 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m14:14:05.926374 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:14:05.927470 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: BEGIN
[0m14:14:05.927917 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:14:05.928142 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:14:05.928363 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:14:05.928683 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: BEGIN
[0m14:14:05.929163 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: BEGIN
[0m14:14:05.929740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:05.930055 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:14:05.931552 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m14:14:05.931990 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:14:05.932460 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "airflow"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m14:14:05.933413 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:14:05.933743 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m14:14:05.934125 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:14:05.934641 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:14:05.935084 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */

  
    

  create  table "airflow"."gold"."customer_360__dbt_tmp"
  
  
    as
  
  (
    

SELECT * FROM "airflow"."silver"."customer_clean"
  );
  
[0m14:14:05.936090 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "airflow"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m14:14:05.937087 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "silver.customer_clean" does not exist
LINE 14: SELECT * FROM "airflow"."silver"."customer_clean"
                       ^

[0m14:14:05.937390 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: ROLLBACK
[0m14:14:05.938020 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: Close
[0m14:14:05.939388 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.006 seconds
[0m14:14:05.942194 [debug] [Thread-1 (]: Database Error in model customer_360 (models/gold/customer_360.sql)
  relation "silver.customer_clean" does not exist
  LINE 14: SELECT * FROM "airflow"."silver"."customer_clean"
                         ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql
[0m14:14:05.948478 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:14:05.948819 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.012 seconds
[0m14:14:05.950038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620891eb-e8b7-48ac-8e62-a40c6e7ecb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9af62cc0>]}
[0m14:14:05.950386 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m14:14:05.952354 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:14:05.952843 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model gold.customer_360 ........................ [[31mERROR[0m in 0.10s]
[0m14:14:05.953355 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean" rename to "customers_clean__dbt_backup"
[0m14:14:05.953788 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customer_360
[0m14:14:05.954724 [debug] [Thread-7 (]: Marking all children of 'model.elt_assignment.customer_360' to be skipped because of status 'error'.  Reason: Database Error in model customer_360 (models/gold/customer_360.sql)
  relation "silver.customer_clean" does not exist
  LINE 14: SELECT * FROM "airflow"."silver"."customer_clean"
                         ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql.
[0m14:14:05.955034 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:14:05.957723 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:14:05.958055 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m14:14:05.958520 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:14:05.971887 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:14:05.972377 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:14:05.972832 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:14:05.973799 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:14:05.974055 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m14:14:05.977574 [debug] [Thread-2 (]: Applying DROP to: "airflow"."silver"."customers_clean__dbt_backup"
[0m14:14:05.979716 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:14:05.982674 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:14:05.983055 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m14:14:05.983381 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "airflow"."silver"."customers_clean__dbt_backup" cascade
[0m14:14:05.983967 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:14:05.984961 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:14:05.985327 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:14:05.985641 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:14:05.986209 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m14:14:05.988666 [debug] [Thread-3 (]: Applying DROP to: "airflow"."bronze"."customers_raw__dbt_backup"
[0m14:14:05.988962 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.005 seconds
[0m14:14:05.989368 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:14:05.990804 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: Close
[0m14:14:05.991135 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "airflow"."bronze"."customers_raw__dbt_backup" cascade
[0m14:14:05.991644 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620891eb-e8b7-48ac-8e62-a40c6e7ecb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cca8170>]}
[0m14:14:05.992312 [info ] [Thread-2 (]: 2 of 3 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.15s]
[0m14:14:05.993291 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_clean
[0m14:14:05.993556 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:14:05.994641 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: Close
[0m14:14:05.995064 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '620891eb-e8b7-48ac-8e62-a40c6e7ecb24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ccaad20>]}
[0m14:14:05.995485 [info ] [Thread-3 (]: 3 of 3 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.15s]
[0m14:14:05.996040 [debug] [Thread-3 (]: Finished running node model.elt_assignment.customers_raw
[0m14:14:05.997199 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:05.997557 [debug] [MainThread]: On master: BEGIN
[0m14:14:05.997848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:14:06.005156 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:14:06.005499 [debug] [MainThread]: On master: COMMIT
[0m14:14:06.005779 [debug] [MainThread]: Using postgres connection "master"
[0m14:14:06.005976 [debug] [MainThread]: On master: COMMIT
[0m14:14:06.006228 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:14:06.006425 [debug] [MainThread]: On master: Close
[0m14:14:06.006719 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:06.006923 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m14:14:06.007115 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m14:14:06.007304 [debug] [MainThread]: Connection 'model.elt_assignment.customer_360' was properly closed.
[0m14:14:06.007601 [info ] [MainThread]: 
[0m14:14:06.008114 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m14:14:06.008742 [debug] [MainThread]: Command end result
[0m14:14:06.031139 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:14:06.033816 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:14:06.038936 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:14:06.039235 [info ] [MainThread]: 
[0m14:14:06.039781 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:14:06.040180 [info ] [MainThread]: 
[0m14:14:06.040614 [error] [MainThread]: [31mFailure in model customer_360 (models/gold/customer_360.sql)[0m
[0m14:14:06.040948 [error] [MainThread]:   Database Error in model customer_360 (models/gold/customer_360.sql)
  relation "silver.customer_clean" does not exist
  LINE 14: SELECT * FROM "airflow"."silver"."customer_clean"
                         ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql
[0m14:14:06.041200 [info ] [MainThread]: 
[0m14:14:06.041503 [info ] [MainThread]:   compiled code at target/compiled/elt_assignment/models/gold/customer_360.sql
[0m14:14:06.041977 [info ] [MainThread]: 
[0m14:14:06.042484 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:14:06.043359 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8841181, "process_in_blocks": "0", "process_kernel_time": 0.307758, "process_mem_max_rss": "130160", "process_out_blocks": "3341", "process_user_time": 1.806453}
[0m14:14:06.043781 [debug] [MainThread]: Command `dbt run` failed at 14:14:06.043725 after 0.88 seconds
[0m14:14:06.044095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9cef3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d1c3020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bc91040>]}
[0m14:14:06.044428 [debug] [MainThread]: Flushing usage events
[0m14:14:07.559141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:14:57.765549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff86720950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85fe0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f677a0>]}


============================== 14:14:57.770058 | 8c084b88-28eb-4c35-a0a7-c57d0e5fe817 ==============================
[0m14:14:57.770058 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:14:57.770675 [debug] [MainThread]: running dbt with arguments {'log_path': '/opt/airflow/dbt/logs', 'use_colors': 'True', 'warn_error': 'None', 'log_format': 'default', 'debug': 'False', 'version_check': 'True', 'introspect': 'True', 'target_path': 'None', 'partial_parse': 'True', 'printer_width': '80', 'profiles_dir': '/opt/airflow/dbt', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'static_parser': 'True', 'empty': 'None', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_cache_events': 'False', 'use_experimental_parser': 'False'}
[0m14:14:57.903301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c084b88-28eb-4c35-a0a7-c57d0e5fe817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff87b183b0>]}
[0m14:14:58.062080 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-39hv5etf'
[0m14:14:58.062577 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:14:58.297511 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:14:58.298352 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:14:58.459649 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:14:58.466035 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:15:00.119656 [info ] [MainThread]: Installed from version 1.3.0
[0m14:15:00.120194 [info ] [MainThread]: Up to date!
[0m14:15:00.120731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8c084b88-28eb-4c35-a0a7-c57d0e5fe817', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853ed940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8530f3e0>]}
[0m14:15:00.121973 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.3872998, "process_in_blocks": "184", "process_kernel_time": 0.382308, "process_mem_max_rss": "105780", "process_out_blocks": "733", "process_user_time": 1.320426}
[0m14:15:00.122452 [debug] [MainThread]: Command `dbt deps` succeeded at 14:15:00.122371 after 2.39 seconds
[0m14:15:00.122777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff853ed940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f679b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85f67710>]}
[0m14:15:00.123091 [debug] [MainThread]: Flushing usage events
[0m14:15:01.543004 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:03.721645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990458b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99763830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff98c00740>]}


============================== 14:15:03.725962 | 12aa986f-240c-4dad-b5ac-cac183a0e52a ==============================
[0m14:15:03.725962 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:15:03.726979 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'printer_width': '80', 'profiles_dir': '/opt/airflow/dbt', 'log_cache_events': 'False', 'fail_fast': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'static_parser': 'True', 'no_print': 'None', 'log_path': 'logs', 'invocation_command': 'dbt run --project-dir . --profiles-dir /opt/airflow/dbt', 'cache_selected_only': 'False', 'write_json': 'True', 'log_format': 'default', 'partial_parse': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'debug': 'False', 'use_colors': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m14:15:03.828955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12aa986f-240c-4dad-b5ac-cac183a0e52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99cc8d70>]}
[0m14:15:03.859895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12aa986f-240c-4dad-b5ac-cac183a0e52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff990d5a90>]}
[0m14:15:03.860488 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:03.908614 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:15:04.011309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:15:04.012015 [debug] [MainThread]: Partial parsing: updated file: elt_assignment://models/silver.yml
[0m14:15:04.012413 [debug] [MainThread]: Partial parsing: updated file: elt_assignment://models/gold/customer_360.sql
[0m14:15:04.190333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12aa986f-240c-4dad-b5ac-cac183a0e52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9802ade0>]}
[0m14:15:04.230155 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:15:04.232349 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:15:04.246424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12aa986f-240c-4dad-b5ac-cac183a0e52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9787d730>]}
[0m14:15:04.246886 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m14:15:04.247494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12aa986f-240c-4dad-b5ac-cac183a0e52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97ecbdd0>]}
[0m14:15:04.248619 [info ] [MainThread]: 
[0m14:15:04.249061 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:04.249369 [info ] [MainThread]: 
[0m14:15:04.249811 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:15:04.252061 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:15:04.252530 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:15:04.258272 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:15:04.281461 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:15:04.281771 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:15:04.282008 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:15:04.282317 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:15:04.282630 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:15:04.282951 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:15:04.283300 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:04.283576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:04.283839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:04.287814 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m14:15:04.288112 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.004 seconds
[0m14:15:04.288358 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m14:15:04.289234 [debug] [ThreadPool]: On list_airflow: Close
[0m14:15:04.289991 [debug] [ThreadPool]: On list_airflow: Close
[0m14:15:04.290768 [debug] [ThreadPool]: On list_airflow: Close
[0m14:15:04.292350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_bronze)
[0m14:15:04.292722 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_silver)
[0m14:15:04.293165 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_gold)
[0m14:15:04.296471 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:15:04.297681 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:15:04.298774 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:15:04.299108 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m14:15:04.299468 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m14:15:04.299765 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m14:15:04.300061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:04.300337 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:04.300613 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:15:04.303324 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:15:04.303667 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:15:04.304086 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:15:04.304401 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:15:04.304699 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:15:04.305020 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m14:15:04.306537 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:15:04.306933 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:15:04.307291 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:15:04.307506 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:15:04.307691 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:15:04.308746 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m14:15:04.309558 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m14:15:04.309974 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m14:15:04.310257 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m14:15:04.311663 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m14:15:04.312499 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m14:15:04.312906 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m14:15:04.315851 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:04.316203 [debug] [MainThread]: On master: BEGIN
[0m14:15:04.316412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:04.318341 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:15:04.318639 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:04.318922 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:15:04.320823 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:15:04.321671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12aa986f-240c-4dad-b5ac-cac183a0e52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff979293a0>]}
[0m14:15:04.322094 [debug] [MainThread]: On master: ROLLBACK
[0m14:15:04.322456 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:04.322697 [debug] [MainThread]: On master: BEGIN
[0m14:15:04.323082 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:15:04.323308 [debug] [MainThread]: On master: COMMIT
[0m14:15:04.323537 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:04.323771 [debug] [MainThread]: On master: COMMIT
[0m14:15:04.324131 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:04.324380 [debug] [MainThread]: On master: Close
[0m14:15:04.327949 [debug] [Thread-1 (]: Began running node model.elt_assignment.customer_360
[0m14:15:04.328229 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_clean
[0m14:15:04.328445 [debug] [Thread-3 (]: Began running node model.elt_assignment.customers_raw
[0m14:15:04.328843 [info ] [Thread-1 (]: 1 of 3 START sql table model gold.customer_360 ................................. [RUN]
[0m14:15:04.329447 [info ] [Thread-2 (]: 2 of 3 START sql table model silver.customers_clean ............................ [RUN]
[0m14:15:04.329906 [info ] [Thread-3 (]: 3 of 3 START sql table model bronze.customers_raw .............................. [RUN]
[0m14:15:04.330300 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_gold, now model.elt_assignment.customer_360)
[0m14:15:04.330617 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_bronze, now model.elt_assignment.customers_clean)
[0m14:15:04.330942 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now model.elt_assignment.customers_raw)
[0m14:15:04.331245 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customer_360
[0m14:15:04.331534 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_clean
[0m14:15:04.331807 [debug] [Thread-3 (]: Began compiling node model.elt_assignment.customers_raw
[0m14:15:04.335930 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customer_360"
[0m14:15:04.337128 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m14:15:04.338152 [debug] [Thread-3 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m14:15:04.341095 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customer_360
[0m14:15:04.342142 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_clean
[0m14:15:04.399556 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customer_360"
[0m14:15:04.401362 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m14:15:04.401657 [debug] [Thread-3 (]: Began executing node model.elt_assignment.customers_raw
[0m14:15:04.405781 [debug] [Thread-3 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m14:15:04.406092 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:15:04.406700 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:15:04.407562 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: BEGIN
[0m14:15:04.407983 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:15:04.408192 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: BEGIN
[0m14:15:04.408489 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:15:04.408771 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: BEGIN
[0m14:15:04.409482 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:15:04.410715 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:15:04.412446 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:15:04.413072 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:15:04.413628 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m14:15:04.413963 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */

  
    

  create  table "airflow"."gold"."customer_360__dbt_tmp"
  
  
    as
  
  (
    

SELECT * FROM "airflow"."silver"."customers_clean"
  );
  
[0m14:15:04.414360 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m14:15:04.414663 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:15:04.415164 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:15:04.415586 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "airflow"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m14:15:04.416034 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "airflow"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m14:15:04.420746 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.006 seconds
[0m14:15:04.421098 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.005 seconds
[0m14:15:04.426737 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:15:04.427031 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.011 seconds
[0m14:15:04.428678 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:15:04.429003 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
alter table "airflow"."gold"."customer_360__dbt_tmp" rename to "customer_360"
[0m14:15:04.430620 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:15:04.430995 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m14:15:04.431420 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean" rename to "customers_clean__dbt_backup"
[0m14:15:04.431640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:04.439291 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: COMMIT
[0m14:15:04.439655 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:15:04.439965 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: COMMIT
[0m14:15:04.443914 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:15:04.444135 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m14:15:04.447526 [debug] [Thread-1 (]: Applying DROP to: "airflow"."gold"."customer_360__dbt_backup"
[0m14:15:04.449214 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:15:04.451866 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:15:04.452218 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m14:15:04.452535 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
drop table if exists "airflow"."gold"."customer_360__dbt_backup" cascade
[0m14:15:04.453073 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:04.453273 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m14:15:04.455051 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:15:04.456439 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: Close
[0m14:15:04.456789 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:15:04.457929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12aa986f-240c-4dad-b5ac-cac183a0e52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff99e61520>]}
[0m14:15:04.458192 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:15:04.458712 [info ] [Thread-1 (]: 1 of 3 OK created sql table model gold.customer_360 ............................ [[32mSELECT 1000[0m in 0.13s]
[0m14:15:04.459627 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customer_360
[0m14:15:04.459902 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.028 seconds
[0m14:15:04.460161 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:15:04.462917 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:15:04.464211 [debug] [Thread-2 (]: Applying DROP to: "airflow"."silver"."customers_clean__dbt_backup"
[0m14:15:04.464547 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m14:15:04.464951 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:15:04.465429 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "airflow"."silver"."customers_clean__dbt_backup" cascade
[0m14:15:04.465631 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:15:04.466572 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:15:04.466906 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:15:04.467239 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:15:04.467794 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m14:15:04.469289 [debug] [Thread-3 (]: Applying DROP to: "airflow"."bronze"."customers_raw__dbt_backup"
[0m14:15:04.469510 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:15:04.469882 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:15:04.470677 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: Close
[0m14:15:04.471028 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "airflow"."bronze"."customers_raw__dbt_backup" cascade
[0m14:15:04.471488 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12aa986f-240c-4dad-b5ac-cac183a0e52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97f15250>]}
[0m14:15:04.472072 [info ] [Thread-2 (]: 2 of 3 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.14s]
[0m14:15:04.472792 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_clean
[0m14:15:04.473026 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:15:04.474004 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: Close
[0m14:15:04.474391 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12aa986f-240c-4dad-b5ac-cac183a0e52a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96520da0>]}
[0m14:15:04.474835 [info ] [Thread-3 (]: 3 of 3 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.14s]
[0m14:15:04.475389 [debug] [Thread-3 (]: Finished running node model.elt_assignment.customers_raw
[0m14:15:04.476549 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:04.476850 [debug] [MainThread]: On master: BEGIN
[0m14:15:04.477128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:15:04.479375 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:15:04.479710 [debug] [MainThread]: On master: COMMIT
[0m14:15:04.479975 [debug] [MainThread]: Using postgres connection "master"
[0m14:15:04.480224 [debug] [MainThread]: On master: COMMIT
[0m14:15:04.480520 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:15:04.480756 [debug] [MainThread]: On master: Close
[0m14:15:04.481077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:04.481353 [debug] [MainThread]: Connection 'model.elt_assignment.customer_360' was properly closed.
[0m14:15:04.481600 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m14:15:04.481838 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m14:15:04.482151 [info ] [MainThread]: 
[0m14:15:04.482590 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m14:15:04.483242 [debug] [MainThread]: Command end result
[0m14:15:04.504892 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:15:04.507192 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:15:04.511404 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:15:04.511676 [info ] [MainThread]: 
[0m14:15:04.512167 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:15:04.512525 [info ] [MainThread]: 
[0m14:15:04.512906 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:15:04.513610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8234025, "process_in_blocks": "24", "process_kernel_time": 0.310355, "process_mem_max_rss": "129584", "process_out_blocks": "3342", "process_user_time": 1.79906}
[0m14:15:04.514015 [debug] [MainThread]: Command `dbt run` succeeded at 14:15:04.513962 after 0.82 seconds
[0m14:15:04.514313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96567800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97523ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff97c1a240>]}
[0m14:15:04.514605 [debug] [MainThread]: Flushing usage events
[0m14:15:06.346808 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:08.444457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f2dd670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f24cbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f13f740>]}


============================== 14:15:08.449003 | b0231270-3064-4d9e-8271-8589905ef9d8 ==============================
[0m14:15:08.449003 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:15:08.449740 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'log_path': 'logs', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'log_format': 'default', 'printer_width': '80', 'profiles_dir': '/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'warn_error': 'None', 'target_path': 'None', 'empty': 'None', 'no_print': 'None', 'invocation_command': 'dbt test --project-dir . --profiles-dir /opt/airflow/dbt'}
[0m14:15:08.544689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0231270-3064-4d9e-8271-8589905ef9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f13c4d0>]}
[0m14:15:08.574327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0231270-3064-4d9e-8271-8589905ef9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9efdaf00>]}
[0m14:15:08.574993 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:15:08.618237 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:15:08.718274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:08.718701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:08.735655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0231270-3064-4d9e-8271-8589905ef9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d8c0f80>]}
[0m14:15:08.780859 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:15:08.783194 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:15:08.802092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0231270-3064-4d9e-8271-8589905ef9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d5382f0>]}
[0m14:15:08.802516 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m14:15:08.803109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0231270-3064-4d9e-8271-8589905ef9d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d91a090>]}
[0m14:15:08.804148 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:15:08.805390 [debug] [MainThread]: Command end result
[0m14:15:08.826614 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:15:08.829095 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:15:08.831972 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:15:08.832655 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.419496, "process_in_blocks": "1072", "process_kernel_time": 0.139085, "process_mem_max_rss": "117436", "process_out_blocks": "2178", "process_user_time": 1.413866}
[0m14:15:08.833047 [debug] [MainThread]: Command `dbt test` succeeded at 14:15:08.832977 after 0.42 seconds
[0m14:15:08.833374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f218aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa30c7020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f8684a0>]}
[0m14:15:08.833671 [debug] [MainThread]: Flushing usage events
[0m14:15:10.490915 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:30.409133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94555b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93cd28d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff948adfa0>]}


============================== 14:39:30.415406 | cb30d033-704d-4b3f-9bff-4279df80b93c ==============================
[0m14:39:30.415406 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:39:30.416191 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'log_path': '/opt/airflow/dbt/logs', 'log_format': 'default', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'static_parser': 'True', 'empty': 'None', 'invocation_command': 'dbt deps', 'profiles_dir': '/opt/airflow/dbt', 'partial_parse': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'version_check': 'True'}
[0m14:39:30.507929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cb30d033-704d-4b3f-9bff-4279df80b93c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92fbfb90>]}
[0m14:39:30.723267 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-2eqgjbca'
[0m14:39:30.723830 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:39:34.309732 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:39:34.313521 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:39:34.603619 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:39:34.611913 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:39:38.479498 [info ] [MainThread]: Installed from version 1.3.0
[0m14:39:38.481037 [info ] [MainThread]: Up to date!
[0m14:39:38.481993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cb30d033-704d-4b3f-9bff-4279df80b93c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff930836b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93acefc0>]}
[0m14:39:38.484725 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 8.113963, "process_in_blocks": "0", "process_kernel_time": 0.676601, "process_mem_max_rss": "105664", "process_out_blocks": "733", "process_user_time": 1.444826}
[0m14:39:38.485575 [debug] [MainThread]: Command `dbt deps` succeeded at 14:39:38.485454 after 8.12 seconds
[0m14:39:38.486274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93310050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93c5b710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9307e060>]}
[0m14:39:38.486782 [debug] [MainThread]: Flushing usage events
[0m14:39:40.861476 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:44.195087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff92ea5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94829340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9375b350>]}


============================== 14:39:44.201306 | 5e0d4db8-c34c-4eab-9e8e-e7efea318d3b ==============================
[0m14:39:44.201306 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:39:44.202588 [debug] [MainThread]: running dbt with arguments {'empty': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir . --profiles-dir /opt/airflow/dbt', 'fail_fast': 'False', 'log_path': 'logs', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'no_print': 'None', 'printer_width': '80'}
[0m14:39:44.317810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e0d4db8-c34c-4eab-9e8e-e7efea318d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90e1b680>]}
[0m14:39:44.352065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e0d4db8-c34c-4eab-9e8e-e7efea318d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff918e3e60>]}
[0m14:39:44.352777 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:39:44.406602 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:39:44.536975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:44.537653 [debug] [MainThread]: Partial parsing: updated file: elt_assignment://models/gold/customer_360.sql
[0m14:39:44.705097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e0d4db8-c34c-4eab-9e8e-e7efea318d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9085aba0>]}
[0m14:39:44.751404 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:39:44.753877 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:39:44.772701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e0d4db8-c34c-4eab-9e8e-e7efea318d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90aef800>]}
[0m14:39:44.773157 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m14:39:44.773724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e0d4db8-c34c-4eab-9e8e-e7efea318d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9259faa0>]}
[0m14:39:44.774792 [info ] [MainThread]: 
[0m14:39:44.775329 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:39:44.775716 [info ] [MainThread]: 
[0m14:39:44.776234 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:39:44.778530 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:39:44.779042 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:39:44.785203 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:39:44.814931 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:39:44.815218 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:39:44.815451 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:39:44.815771 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:39:44.816287 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:39:44.816696 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:39:44.817055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:44.817378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:44.817655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:44.827140 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m14:39:44.827476 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.010 seconds
[0m14:39:44.828486 [debug] [ThreadPool]: On list_airflow: Close
[0m14:39:44.829501 [debug] [ThreadPool]: On list_airflow: Close
[0m14:39:44.830078 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m14:39:44.831616 [debug] [ThreadPool]: On list_airflow: Close
[0m14:39:44.832790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_bronze)
[0m14:39:44.833234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_silver)
[0m14:39:44.833668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_gold)
[0m14:39:44.838486 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:39:44.839702 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:39:44.840751 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:39:44.841080 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m14:39:44.841371 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m14:39:44.841606 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m14:39:44.841926 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:44.842176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:44.842460 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:44.845363 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:39:44.846050 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:39:44.846392 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:39:44.846678 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m14:39:44.846977 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:39:44.847429 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:39:44.849735 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:39:44.850711 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m14:39:44.851122 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m14:39:44.851363 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:39:44.851546 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m14:39:44.852338 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m14:39:44.852662 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:39:44.853616 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m14:39:44.853964 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:39:44.860670 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.006 seconds
[0m14:39:44.861753 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m14:39:44.862163 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m14:39:44.865516 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:44.865973 [debug] [MainThread]: On master: BEGIN
[0m14:39:44.866369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:44.871128 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m14:39:44.871610 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:44.871992 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:39:44.874744 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:39:44.875744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e0d4db8-c34c-4eab-9e8e-e7efea318d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90811850>]}
[0m14:39:44.876200 [debug] [MainThread]: On master: ROLLBACK
[0m14:39:44.876619 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:44.876878 [debug] [MainThread]: On master: BEGIN
[0m14:39:44.877302 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:39:44.877625 [debug] [MainThread]: On master: COMMIT
[0m14:39:44.877901 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:44.878137 [debug] [MainThread]: On master: COMMIT
[0m14:39:44.878438 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:39:44.878697 [debug] [MainThread]: On master: Close
[0m14:39:44.881925 [debug] [Thread-1 (]: Began running node model.elt_assignment.customer_360
[0m14:39:44.882230 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_clean
[0m14:39:44.882495 [debug] [Thread-3 (]: Began running node model.elt_assignment.customers_raw
[0m14:39:44.882955 [info ] [Thread-1 (]: 1 of 3 START sql table model gold.customer_360 ................................. [RUN]
[0m14:39:44.883674 [info ] [Thread-2 (]: 2 of 3 START sql table model silver.customers_clean ............................ [RUN]
[0m14:39:44.884097 [info ] [Thread-3 (]: 3 of 3 START sql table model bronze.customers_raw .............................. [RUN]
[0m14:39:44.884559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now model.elt_assignment.customer_360)
[0m14:39:44.884933 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_bronze, now model.elt_assignment.customers_clean)
[0m14:39:44.885349 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airflow_gold, now model.elt_assignment.customers_raw)
[0m14:39:44.885695 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customer_360
[0m14:39:44.886007 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_clean
[0m14:39:44.886326 [debug] [Thread-3 (]: Began compiling node model.elt_assignment.customers_raw
[0m14:39:44.891181 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customer_360"
[0m14:39:44.892563 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m14:39:44.893761 [debug] [Thread-3 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m14:39:44.897272 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customer_360
[0m14:39:44.897756 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_clean
[0m14:39:44.910679 [debug] [Thread-3 (]: Began executing node model.elt_assignment.customers_raw
[0m14:39:44.919357 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customer_360"
[0m14:39:44.921884 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m14:39:44.923511 [debug] [Thread-3 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m14:39:44.926037 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:39:44.926657 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: BEGIN
[0m14:39:44.926951 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:39:44.927329 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:44.927611 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:39:44.927903 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: BEGIN
[0m14:39:44.928508 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: BEGIN
[0m14:39:44.928899 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:39:44.929269 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:39:44.930786 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:39:44.931129 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:39:44.931551 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */

  
    

  create  table "airflow"."gold"."customer_360__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  cc.customer_hash,
  cc.age,
  cc.gender,
  CASE
    WHEN cc.age < 25 THEN 'Under 25'
    WHEN cc.age BETWEEN 25 AND 34 THEN '25-34'
    WHEN cc.age BETWEEN 35 AND 44 THEN '35-44'
    WHEN cc.age BETWEEN 45 AND 54 THEN '45-54'
    WHEN cc.age BETWEEN 55 AND 64 THEN '55-64'
    WHEN cc.age >= 65 THEN '65+'
    ELSE 'Unknown'
  END AS age_band,
  cc.tenure_months,
  CASE
    WHEN cc.tenure_months < 3     THEN 'New ( <3m )'
    WHEN cc.tenure_months < 12    THEN '4-12m'      -- NOTE: 3-month edge is excluded by design here
    WHEN cc.tenure_months < 24    THEN '12-24m'
    WHEN cc.tenure_months < 36    THEN '24-36m'
    ELSE '36m+'
  END AS tenure_band,
  cc.monthly_charges,
  cc.total_charges,
  cc.contract_type,
  cc.internet_service,
  cc.has_tech_support,
  CASE
    WHEN cc.has_tech_support IS TRUE  THEN 'Yes'
    WHEN cc.has_tech_support IS FALSE THEN 'No'
    ELSE 'Unknown'
  END AS tech_support_label,
  cc.is_churned,
  CASE
    WHEN cc.is_churned IS TRUE  THEN 'Churned'
    WHEN cc.is_churned IS FALSE THEN 'Active'
    ELSE 'Unknown'
  END AS churn_status,
  cc.monthly_charges AS arpu,
  (cc.monthly_charges * GREATEST(cc.tenure_months, 0))::NUMERIC(12,2) AS ltv_estimate,
  CASE
    WHEN cc.monthly_charges >= 100 THEN 'High'
    WHEN cc.monthly_charges >= 60  THEN 'Medium'
    ELSE 'Low'
  END AS revenue_bucket,
  cc._loaded_at
FROM "airflow"."silver"."customers_clean" AS cc;
  );
  
[0m14:39:44.931853 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m14:39:44.932331 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:39:44.932599 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 59: FROM "airflow"."silver"."customers_clean" AS cc;
                                                        ^

[0m14:39:44.932884 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "airflow"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m14:39:44.933203 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: ROLLBACK
[0m14:39:44.933789 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: Close
[0m14:39:44.936899 [debug] [Thread-1 (]: Database Error in model customer_360 (models/gold/customer_360.sql)
  syntax error at or near ";"
  LINE 59: FROM "airflow"."silver"."customers_clean" AS cc;
                                                          ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql
[0m14:39:44.938564 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m14:39:44.938946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0d4db8-c34c-4eab-9e8e-e7efea318d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff90812cc0>]}
[0m14:39:44.939233 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.006 seconds
[0m14:39:44.939552 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:39:44.940056 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model gold.customer_360 ........................ [[31mERROR[0m in 0.05s]
[0m14:39:44.945837 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:39:44.946182 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "airflow"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m14:39:44.946645 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customer_360
[0m14:39:44.946973 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m14:39:44.947616 [debug] [Thread-7 (]: Marking all children of 'model.elt_assignment.customer_360' to be skipped because of status 'error'.  Reason: Database Error in model customer_360 (models/gold/customer_360.sql)
  syntax error at or near ";"
  LINE 59: FROM "airflow"."silver"."customers_clean" AS cc;
                                                          ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql.
[0m14:39:44.956858 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.009 seconds
[0m14:39:44.959718 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:39:44.960149 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean" rename to "customers_clean__dbt_backup"
[0m14:39:44.960919 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:39:44.963107 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:39:44.963471 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m14:39:44.963968 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:39:44.977324 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:39:44.977817 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:39:44.978106 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:39:44.979929 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:39:44.980164 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m14:39:44.983559 [debug] [Thread-2 (]: Applying DROP to: "airflow"."silver"."customers_clean__dbt_backup"
[0m14:39:44.985248 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:39:44.988144 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:39:44.988482 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m14:39:44.988798 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "airflow"."silver"."customers_clean__dbt_backup" cascade
[0m14:39:44.989359 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:39:44.990208 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:39:44.990526 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:39:44.990846 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:39:44.991522 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m14:39:44.993080 [debug] [Thread-3 (]: Applying DROP to: "airflow"."bronze"."customers_raw__dbt_backup"
[0m14:39:44.993358 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:39:44.993660 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:39:44.995120 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: Close
[0m14:39:44.995459 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "airflow"."bronze"."customers_raw__dbt_backup" cascade
[0m14:39:44.995971 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0d4db8-c34c-4eab-9e8e-e7efea318d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff945cbcb0>]}
[0m14:39:44.996738 [info ] [Thread-2 (]: 2 of 3 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.11s]
[0m14:39:44.997784 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_clean
[0m14:39:44.998009 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:39:44.999049 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: Close
[0m14:39:44.999481 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e0d4db8-c34c-4eab-9e8e-e7efea318d3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb5a9c0>]}
[0m14:39:44.999945 [info ] [Thread-3 (]: 3 of 3 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.11s]
[0m14:39:45.000509 [debug] [Thread-3 (]: Finished running node model.elt_assignment.customers_raw
[0m14:39:45.001538 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:45.001843 [debug] [MainThread]: On master: BEGIN
[0m14:39:45.002088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:45.004411 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:39:45.004744 [debug] [MainThread]: On master: COMMIT
[0m14:39:45.005005 [debug] [MainThread]: Using postgres connection "master"
[0m14:39:45.005247 [debug] [MainThread]: On master: COMMIT
[0m14:39:45.005621 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:39:45.005900 [debug] [MainThread]: On master: Close
[0m14:39:45.006219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:45.006488 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m14:39:45.006753 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m14:39:45.007018 [debug] [MainThread]: Connection 'model.elt_assignment.customer_360' was properly closed.
[0m14:39:45.007334 [info ] [MainThread]: 
[0m14:39:45.007755 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m14:39:45.008388 [debug] [MainThread]: Command end result
[0m14:39:45.091408 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:39:45.094223 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:39:45.099527 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:39:45.099882 [info ] [MainThread]: 
[0m14:39:45.100903 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:39:45.102874 [info ] [MainThread]: 
[0m14:39:45.103879 [error] [MainThread]: [31mFailure in model customer_360 (models/gold/customer_360.sql)[0m
[0m14:39:45.104508 [error] [MainThread]:   Database Error in model customer_360 (models/gold/customer_360.sql)
  syntax error at or near ";"
  LINE 59: FROM "airflow"."silver"."customers_clean" AS cc;
                                                          ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql
[0m14:39:45.105231 [info ] [MainThread]: 
[0m14:39:45.105837 [info ] [MainThread]:   compiled code at target/compiled/elt_assignment/models/gold/customer_360.sql
[0m14:39:45.106347 [info ] [MainThread]: 
[0m14:39:45.106772 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:39:45.107830 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9519435, "process_in_blocks": "0", "process_kernel_time": 0.578109, "process_mem_max_rss": "128548", "process_out_blocks": "3366", "process_user_time": 1.796556}
[0m14:39:45.108319 [debug] [MainThread]: Command `dbt run` failed at 14:39:45.108238 after 0.95 seconds
[0m14:39:45.108699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9291f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb8f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8fb8f530>]}
[0m14:39:45.109047 [debug] [MainThread]: Flushing usage events
[0m14:39:46.906754 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:42:11.483138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff966147d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff968a8560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9664e1e0>]}


============================== 14:42:11.491128 | a0a48574-4fc9-43c7-847d-7838fd7c37b6 ==============================
[0m14:42:11.491128 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:42:11.492372 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'target_path': 'None', 'version_check': 'True', 'no_print': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'debug': 'False', 'empty': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'log_format': 'default', 'log_path': '/opt/airflow/dbt/logs', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'invocation_command': 'dbt deps', 'profiles_dir': '/opt/airflow/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'cache_selected_only': 'False'}
[0m14:42:11.592200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0a48574-4fc9-43c7-847d-7838fd7c37b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff957fa960>]}
[0m14:42:11.845110 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-jnl6s4r9'
[0m14:42:11.845941 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:42:13.810617 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:42:13.811456 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:42:14.078710 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:42:14.088021 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:42:15.157298 [info ] [MainThread]: Installed from version 1.3.0
[0m14:42:15.158068 [info ] [MainThread]: Up to date!
[0m14:42:15.158747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a0a48574-4fc9-43c7-847d-7838fd7c37b6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff956eff50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff956ee210>]}
[0m14:42:15.159863 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.716855, "process_in_blocks": "8", "process_kernel_time": 0.887756, "process_mem_max_rss": "105576", "process_out_blocks": "733", "process_user_time": 1.415967}
[0m14:42:15.160333 [debug] [MainThread]: Command `dbt deps` succeeded at 14:42:15.160277 after 3.72 seconds
[0m14:42:15.160671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff958f80e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95693680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96d45520>]}
[0m14:42:15.160998 [debug] [MainThread]: Flushing usage events
[0m14:42:17.805722 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:42:20.365574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabf65fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa91ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa9193d0>]}


============================== 14:42:20.370413 | d24902d4-668c-43ae-b377-5eec27c0a0e0 ==============================
[0m14:42:20.370413 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:42:20.371489 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'use_colors': 'True', 'debug': 'False', 'warn_error': 'None', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'printer_width': '80', 'invocation_command': 'dbt run --project-dir . --profiles-dir /opt/airflow/dbt', 'log_path': 'logs', 'write_json': 'True', 'empty': 'False', 'profiles_dir': '/opt/airflow/dbt', 'no_print': 'None', 'cache_selected_only': 'False'}
[0m14:42:20.481961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd24902d4-668c-43ae-b377-5eec27c0a0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa88d3290>]}
[0m14:42:20.514179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd24902d4-668c-43ae-b377-5eec27c0a0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaba56510>]}
[0m14:42:20.515053 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:42:20.565858 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:42:20.672025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:20.672614 [debug] [MainThread]: Partial parsing: updated file: elt_assignment://models/gold/customer_360.sql
[0m14:42:20.800339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd24902d4-668c-43ae-b377-5eec27c0a0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8838e60>]}
[0m14:42:20.847444 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:42:20.849942 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:42:20.866120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd24902d4-668c-43ae-b377-5eec27c0a0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa85c34a0>]}
[0m14:42:20.866623 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m14:42:20.867184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd24902d4-668c-43ae-b377-5eec27c0a0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8309df0>]}
[0m14:42:20.868343 [info ] [MainThread]: 
[0m14:42:20.868754 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:20.869024 [info ] [MainThread]: 
[0m14:42:20.869485 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:42:20.871901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:42:20.872492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:42:20.878809 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:42:20.912963 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:42:20.913259 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:42:20.913477 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:42:20.913787 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:42:20.914083 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:42:20.914378 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:42:20.914671 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:20.914940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:20.915191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:20.919825 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m14:42:20.920194 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m14:42:20.921073 [debug] [ThreadPool]: On list_airflow: Close
[0m14:42:20.921877 [debug] [ThreadPool]: On list_airflow: Close
[0m14:42:20.927609 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.013 seconds
[0m14:42:20.928566 [debug] [ThreadPool]: On list_airflow: Close
[0m14:42:20.929612 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_gold)
[0m14:42:20.930024 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_silver)
[0m14:42:20.930376 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_bronze)
[0m14:42:20.934670 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:42:20.935914 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:42:20.936945 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:42:20.937235 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m14:42:20.937520 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m14:42:20.937778 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m14:42:20.938031 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:20.938302 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:20.938621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:20.941517 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:42:20.941775 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:42:20.941963 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:42:20.942216 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:42:20.942566 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:42:20.942862 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:42:20.943157 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m14:42:20.943498 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:42:20.943847 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:42:20.946785 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:42:20.947027 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:42:20.947207 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:42:20.948050 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m14:42:20.949014 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m14:42:20.949916 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m14:42:20.950346 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m14:42:20.950697 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m14:42:20.951036 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m14:42:20.954603 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:20.955021 [debug] [MainThread]: On master: BEGIN
[0m14:42:20.955333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:20.957491 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:42:20.957792 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:20.958071 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:42:20.960289 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:42:20.961077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd24902d4-668c-43ae-b377-5eec27c0a0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab028e00>]}
[0m14:42:20.961412 [debug] [MainThread]: On master: ROLLBACK
[0m14:42:20.961734 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:20.961964 [debug] [MainThread]: On master: BEGIN
[0m14:42:20.962371 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:42:20.962601 [debug] [MainThread]: On master: COMMIT
[0m14:42:20.962804 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:20.962999 [debug] [MainThread]: On master: COMMIT
[0m14:42:20.963286 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:42:20.963513 [debug] [MainThread]: On master: Close
[0m14:42:20.966557 [debug] [Thread-1 (]: Began running node model.elt_assignment.customers_clean
[0m14:42:20.966847 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_raw
[0m14:42:20.967223 [info ] [Thread-1 (]: 1 of 3 START sql table model silver.customers_clean ............................ [RUN]
[0m14:42:20.967770 [info ] [Thread-2 (]: 2 of 3 START sql table model bronze.customers_raw .............................. [RUN]
[0m14:42:20.968313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_gold, now model.elt_assignment.customers_clean)
[0m14:42:20.968700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now model.elt_assignment.customers_raw)
[0m14:42:20.969058 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customers_clean
[0m14:42:20.969382 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_raw
[0m14:42:20.972858 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m14:42:20.974041 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m14:42:20.977481 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customers_clean
[0m14:42:20.977706 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_raw
[0m14:42:21.000175 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m14:42:21.002632 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m14:42:21.005092 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:42:21.005439 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:42:21.005733 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: BEGIN
[0m14:42:21.006081 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: BEGIN
[0m14:42:21.006373 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:21.006656 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:21.009474 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m14:42:21.009710 [debug] [Thread-1 (]: SQL status: BEGIN in 0.003 seconds
[0m14:42:21.009989 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:42:21.010291 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:42:21.010601 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "airflow"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m14:42:21.010911 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "airflow"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m14:42:21.016436 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.005 seconds
[0m14:42:21.023414 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:42:21.023684 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.010 seconds
[0m14:42:21.024005 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m14:42:21.026098 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:42:21.026885 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean" rename to "customers_clean__dbt_backup"
[0m14:42:21.027712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:42:21.029583 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:42:21.030006 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m14:42:21.030712 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:42:21.039731 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:42:21.040193 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:42:21.040557 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:42:21.042287 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:42:21.042552 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m14:42:21.045913 [debug] [Thread-1 (]: Applying DROP to: "airflow"."silver"."customers_clean__dbt_backup"
[0m14:42:21.047652 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:42:21.050375 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:42:21.050727 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m14:42:21.051057 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "airflow"."silver"."customers_clean__dbt_backup" cascade
[0m14:42:21.051617 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:42:21.052570 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:42:21.052909 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:42:21.053239 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:42:21.053884 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m14:42:21.054106 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:42:21.055401 [debug] [Thread-2 (]: Applying DROP to: "airflow"."bronze"."customers_raw__dbt_backup"
[0m14:42:21.056850 [debug] [Thread-1 (]: On model.elt_assignment.customers_clean: Close
[0m14:42:21.057309 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:42:21.058665 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "airflow"."bronze"."customers_raw__dbt_backup" cascade
[0m14:42:21.059002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd24902d4-668c-43ae-b377-5eec27c0a0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffabdb1160>]}
[0m14:42:21.061045 [info ] [Thread-1 (]: 1 of 3 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.09s]
[0m14:42:21.061747 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:42:21.062759 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customers_clean
[0m14:42:21.065206 [debug] [Thread-2 (]: On model.elt_assignment.customers_raw: Close
[0m14:42:21.066358 [debug] [Thread-4 (]: Began running node model.elt_assignment.customer_360
[0m14:42:21.067618 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd24902d4-668c-43ae-b377-5eec27c0a0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa7f09100>]}
[0m14:42:21.068041 [info ] [Thread-4 (]: 3 of 3 START sql table model gold.customer_360 ................................. [RUN]
[0m14:42:21.068843 [info ] [Thread-2 (]: 2 of 3 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.10s]
[0m14:42:21.072619 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.elt_assignment.customer_360'
[0m14:42:21.074103 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_raw
[0m14:42:21.074711 [debug] [Thread-4 (]: Began compiling node model.elt_assignment.customer_360
[0m14:42:21.077572 [debug] [Thread-4 (]: Writing injected SQL for node "model.elt_assignment.customer_360"
[0m14:42:21.079169 [debug] [Thread-4 (]: Began executing node model.elt_assignment.customer_360
[0m14:42:21.080895 [debug] [Thread-4 (]: Writing runtime sql for node "model.elt_assignment.customer_360"
[0m14:42:21.082076 [debug] [Thread-4 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:42:21.082401 [debug] [Thread-4 (]: On model.elt_assignment.customer_360: BEGIN
[0m14:42:21.082680 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:42:21.085510 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m14:42:21.085882 [debug] [Thread-4 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:42:21.086191 [debug] [Thread-4 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */

  
    

  create  table "airflow"."gold"."customer_360__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  cc.customer_hash,
  cc.age,
  cc.gender,
  CASE
    WHEN cc.age < 25 THEN 'Under 25'
    WHEN cc.age BETWEEN 25 AND 34 THEN '25-34'
    WHEN cc.age BETWEEN 35 AND 44 THEN '35-44'
    WHEN cc.age BETWEEN 45 AND 54 THEN '45-54'
    WHEN cc.age BETWEEN 55 AND 64 THEN '55-64'
    WHEN cc.age >= 65 THEN '65+'
    ELSE 'Unknown'
  END AS age_band,
  cc.tenure_months,
  CASE
    WHEN cc.tenure_months < 3     THEN 'New ( <3m )'
    WHEN cc.tenure_months < 12    THEN '4-12m'      -- NOTE: 3-month edge is excluded by design here
    WHEN cc.tenure_months < 24    THEN '12-24m'
    WHEN cc.tenure_months < 36    THEN '24-36m'
    ELSE '36m+'
  END AS tenure_band,
  cc.monthly_charges,
  cc.total_charges,
  cc.contract_type,
  cc.internet_service,
  cc.has_tech_support,
  CASE
    WHEN cc.has_tech_support IS TRUE  THEN 'Yes'
    WHEN cc.has_tech_support IS FALSE THEN 'No'
    ELSE 'Unknown'
  END AS tech_support_label,
  cc.is_churned,
  CASE
    WHEN cc.is_churned IS TRUE  THEN 'Churned'
    WHEN cc.is_churned IS FALSE THEN 'Active'
    ELSE 'Unknown'
  END AS churn_status,
  cc.monthly_charges AS arpu,
  (cc.monthly_charges * GREATEST(cc.tenure_months, 0))::NUMERIC(12,2) AS ltv_estimate,
  CASE
    WHEN cc.monthly_charges >= 100 THEN 'High'
    WHEN cc.monthly_charges >= 60  THEN 'Medium'
    ELSE 'Low'
  END AS revenue_bucket,
  cc._loaded_at
FROM "airflow"."silver"."customers_clean" AS cc;
  );
  
[0m14:42:21.086780 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 59: FROM "airflow"."silver"."customers_clean" AS cc;
                                                        ^

[0m14:42:21.087093 [debug] [Thread-4 (]: On model.elt_assignment.customer_360: ROLLBACK
[0m14:42:21.087601 [debug] [Thread-4 (]: On model.elt_assignment.customer_360: Close
[0m14:42:21.090325 [debug] [Thread-4 (]: Database Error in model customer_360 (models/gold/customer_360.sql)
  syntax error at or near ";"
  LINE 59: FROM "airflow"."silver"."customers_clean" AS cc;
                                                          ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql
[0m14:42:21.091030 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd24902d4-668c-43ae-b377-5eec27c0a0e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa9361730>]}
[0m14:42:21.091533 [error] [Thread-4 (]: 3 of 3 ERROR creating sql table model gold.customer_360 ........................ [[31mERROR[0m in 0.02s]
[0m14:42:21.092136 [debug] [Thread-4 (]: Finished running node model.elt_assignment.customer_360
[0m14:42:21.092590 [debug] [Thread-7 (]: Marking all children of 'model.elt_assignment.customer_360' to be skipped because of status 'error'.  Reason: Database Error in model customer_360 (models/gold/customer_360.sql)
  syntax error at or near ";"
  LINE 59: FROM "airflow"."silver"."customers_clean" AS cc;
                                                          ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql.
[0m14:42:21.093949 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:21.094260 [debug] [MainThread]: On master: BEGIN
[0m14:42:21.094508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:21.096814 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:42:21.097158 [debug] [MainThread]: On master: COMMIT
[0m14:42:21.097489 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:21.097826 [debug] [MainThread]: On master: COMMIT
[0m14:42:21.098222 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:42:21.098575 [debug] [MainThread]: On master: Close
[0m14:42:21.098921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:21.099220 [debug] [MainThread]: Connection 'list_airflow_bronze' was properly closed.
[0m14:42:21.099525 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m14:42:21.099826 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m14:42:21.100096 [debug] [MainThread]: Connection 'model.elt_assignment.customer_360' was properly closed.
[0m14:42:21.100422 [info ] [MainThread]: 
[0m14:42:21.100896 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m14:42:21.101605 [debug] [MainThread]: Command end result
[0m14:42:21.159045 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:42:21.161528 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:42:21.165949 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:42:21.166264 [info ] [MainThread]: 
[0m14:42:21.166815 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:42:21.167261 [info ] [MainThread]: 
[0m14:42:21.167745 [error] [MainThread]: [31mFailure in model customer_360 (models/gold/customer_360.sql)[0m
[0m14:42:21.168321 [error] [MainThread]:   Database Error in model customer_360 (models/gold/customer_360.sql)
  syntax error at or near ";"
  LINE 59: FROM "airflow"."silver"."customers_clean" AS cc;
                                                          ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql
[0m14:42:21.168653 [info ] [MainThread]: 
[0m14:42:21.169056 [info ] [MainThread]:   compiled code at target/compiled/elt_assignment/models/gold/customer_360.sql
[0m14:42:21.169434 [info ] [MainThread]: 
[0m14:42:21.169828 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:42:21.170685 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.855416, "process_in_blocks": "32", "process_kernel_time": 0.376384, "process_mem_max_rss": "128452", "process_out_blocks": "3366", "process_user_time": 1.77252}
[0m14:42:21.171129 [debug] [MainThread]: Command `dbt run` failed at 14:42:21.171071 after 0.86 seconds
[0m14:42:21.171462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa2a0530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa2a3e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa6f0e660>]}
[0m14:42:21.171785 [debug] [MainThread]: Flushing usage events
[0m14:42:22.649943 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:36.630268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908e56d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f3458b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff908e59d0>]}


============================== 14:44:36.636851 | 8fbaf610-ebe5-48e3-b870-552cf5d5f624 ==============================
[0m14:44:36.636851 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:44:36.637858 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'log_path': '/opt/airflow/dbt/logs', 'use_experimental_parser': 'False', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False', 'quiet': 'False', 'printer_width': '80', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'partial_parse': 'True', 'use_colors': 'True', 'empty': 'None'}
[0m14:44:36.726529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fbaf610-ebe5-48e3-b870-552cf5d5f624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e4c8f50>]}
[0m14:44:36.897181 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-pbzu80xg'
[0m14:44:36.897692 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:44:39.564844 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:44:39.567049 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:44:39.801828 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:44:39.806633 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:44:41.082790 [info ] [MainThread]: Installed from version 1.3.0
[0m14:44:41.083674 [info ] [MainThread]: Up to date!
[0m14:44:41.084224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8fbaf610-ebe5-48e3-b870-552cf5d5f624', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f345970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e3d5700>]}
[0m14:44:41.085647 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.492259, "process_in_blocks": "0", "process_kernel_time": 0.298689, "process_mem_max_rss": "105568", "process_out_blocks": "733", "process_user_time": 1.406371}
[0m14:44:41.086148 [debug] [MainThread]: Command `dbt deps` succeeded at 14:44:41.086076 after 4.49 seconds
[0m14:44:41.086502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e58a990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8f345970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e7643e0>]}
[0m14:44:41.086848 [debug] [MainThread]: Flushing usage events
[0m14:44:43.806434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:46.210467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c69a720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bec0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c048e30>]}


============================== 14:44:46.214903 | 390e8a46-6f0c-4269-9d34-cef1ede5387c ==============================
[0m14:44:46.214903 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:44:46.215711 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'cache_selected_only': 'False', 'invocation_command': 'dbt run --project-dir . --profiles-dir /opt/airflow/dbt', 'printer_width': '80', 'log_cache_events': 'False', 'log_path': 'logs', 'use_colors': 'True', 'fail_fast': 'False', 'introspect': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'write_json': 'True', 'empty': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt'}
[0m14:44:46.317221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '390e8a46-6f0c-4269-9d34-cef1ede5387c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7e3380>]}
[0m14:44:46.347509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '390e8a46-6f0c-4269-9d34-cef1ede5387c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b2d41d0>]}
[0m14:44:46.348095 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:44:46.393695 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:44:46.505411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:44:46.505976 [debug] [MainThread]: Partial parsing: updated file: elt_assignment://models/gold/customer_360.sql
[0m14:44:46.636249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '390e8a46-6f0c-4269-9d34-cef1ede5387c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a23f020>]}
[0m14:44:46.680009 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:44:46.683402 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:44:46.700484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '390e8a46-6f0c-4269-9d34-cef1ede5387c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a4e3920>]}
[0m14:44:46.701780 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m14:44:46.703176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390e8a46-6f0c-4269-9d34-cef1ede5387c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a20f110>]}
[0m14:44:46.706177 [info ] [MainThread]: 
[0m14:44:46.707379 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:44:46.708403 [info ] [MainThread]: 
[0m14:44:46.709762 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:44:46.714651 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:44:46.715730 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:44:46.721805 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:44:46.752592 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:44:46.753076 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:44:46.753325 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:44:46.753714 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:44:46.754126 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:44:46.754609 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:44:46.754992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:46.755374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:46.755712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:46.761211 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m14:44:46.761526 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m14:44:46.762555 [debug] [ThreadPool]: On list_airflow: Close
[0m14:44:46.763436 [debug] [ThreadPool]: On list_airflow: Close
[0m14:44:46.765985 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.011 seconds
[0m14:44:46.766877 [debug] [ThreadPool]: On list_airflow: Close
[0m14:44:46.768074 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_bronze)
[0m14:44:46.768461 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_gold)
[0m14:44:46.768883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_silver)
[0m14:44:46.773142 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:44:46.774576 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:44:46.775736 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:44:46.776098 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m14:44:46.776401 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m14:44:46.776694 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m14:44:46.776959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:46.777213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:46.777542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:44:46.780128 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:44:46.780405 [debug] [ThreadPool]: SQL status: BEGIN in 0.003 seconds
[0m14:44:46.780713 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:44:46.781006 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:44:46.781276 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:44:46.781611 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m14:44:46.781819 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:44:46.782316 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:44:46.782672 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:44:46.784199 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:44:46.785107 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m14:44:46.785426 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m14:44:46.786030 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m14:44:46.786930 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m14:44:46.787208 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m14:44:46.787714 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m14:44:46.788703 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m14:44:46.789557 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m14:44:46.793261 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:46.793805 [debug] [MainThread]: On master: BEGIN
[0m14:44:46.794171 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:44:46.809202 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m14:44:46.809731 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:46.810161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:44:46.834134 [debug] [MainThread]: SQL status: SELECT 0 in 0.024 seconds
[0m14:44:46.835295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390e8a46-6f0c-4269-9d34-cef1ede5387c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a305e50>]}
[0m14:44:46.835801 [debug] [MainThread]: On master: ROLLBACK
[0m14:44:46.836239 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:46.836623 [debug] [MainThread]: On master: BEGIN
[0m14:44:46.837232 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:44:46.837659 [debug] [MainThread]: On master: COMMIT
[0m14:44:46.838041 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:46.838319 [debug] [MainThread]: On master: COMMIT
[0m14:44:46.838757 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:46.839041 [debug] [MainThread]: On master: Close
[0m14:44:46.842532 [debug] [Thread-1 (]: Began running node model.elt_assignment.customer_360
[0m14:44:46.842828 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_clean
[0m14:44:46.843067 [debug] [Thread-3 (]: Began running node model.elt_assignment.customers_raw
[0m14:44:46.843507 [info ] [Thread-1 (]: 1 of 3 START sql table model gold.customer_360 ................................. [RUN]
[0m14:44:46.844136 [info ] [Thread-2 (]: 2 of 3 START sql table model silver.customers_clean ............................ [RUN]
[0m14:44:46.844727 [info ] [Thread-3 (]: 3 of 3 START sql table model bronze.customers_raw .............................. [RUN]
[0m14:44:46.845228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now model.elt_assignment.customer_360)
[0m14:44:46.845636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_bronze, now model.elt_assignment.customers_clean)
[0m14:44:46.846027 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airflow_gold, now model.elt_assignment.customers_raw)
[0m14:44:46.846400 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customer_360
[0m14:44:46.846755 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_clean
[0m14:44:46.847068 [debug] [Thread-3 (]: Began compiling node model.elt_assignment.customers_raw
[0m14:44:46.851276 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customer_360"
[0m14:44:46.853035 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m14:44:46.854088 [debug] [Thread-3 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m14:44:46.857467 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customer_360
[0m14:44:46.864551 [debug] [Thread-3 (]: Began executing node model.elt_assignment.customers_raw
[0m14:44:46.864784 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_clean
[0m14:44:46.887059 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customer_360"
[0m14:44:46.889912 [debug] [Thread-3 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m14:44:46.891595 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m14:44:46.895834 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:44:46.896133 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:44:46.896536 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: BEGIN
[0m14:44:46.896832 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:44:46.897142 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: BEGIN
[0m14:44:46.897485 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:44:46.897793 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: BEGIN
[0m14:44:46.898109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:44:46.898563 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:44:46.901042 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m14:44:46.901486 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:44:46.901884 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "airflow"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m14:44:46.902158 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:44:46.902653 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:44:46.903073 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */

  
    

  create  table "airflow"."gold"."customer_360__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  cc.customer_hash,
  cc.age,
  cc.gender,
  CASE
    WHEN cc.age < 25 THEN 'Under 25'
    WHEN cc.age BETWEEN 25 AND 34 THEN '25-34'
    WHEN cc.age BETWEEN 35 AND 44 THEN '35-44'
    WHEN cc.age BETWEEN 45 AND 54 THEN '45-54'
    WHEN cc.age BETWEEN 55 AND 64 THEN '55-64'
    WHEN cc.age >= 65 THEN '65+'
    ELSE 'Unknown'
  END AS age_band,
  cc.tenure_months,
  CASE
    WHEN cc.tenure_months < 3     THEN 'New ( <3m )'
    WHEN cc.tenure_months < 12    THEN '4-12m'      -- NOTE: 3-month edge is excluded by design here
    WHEN cc.tenure_months < 24    THEN '12-24m'
    WHEN cc.tenure_months < 36    THEN '24-36m'
    ELSE '36m+'
  END AS tenure_band,
  cc.monthly_charges,
  cc.total_charges,
  cc.contract_type,
  cc.internet_service,
  cc.has_tech_support,
  CASE
    WHEN cc.has_tech_support IS TRUE  THEN 'Yes'
    WHEN cc.has_tech_support IS FALSE THEN 'No'
    ELSE 'Unknown'
  END AS tech_support_label,
  cc.is_churned,
  CASE
    WHEN cc.is_churned IS TRUE  THEN 'Churned'
    WHEN cc.is_churned IS FALSE THEN 'Active'
    ELSE 'Unknown'
  END AS churn_status,
  cc.monthly_charges AS arpu,
  (cc.monthly_charges * GREATEST(cc.tenure_months, 0))::NUMERIC(12,2) AS ltv_estimate,
  CASE
    WHEN cc.monthly_charges >= 100 THEN 'High'
    WHEN cc.monthly_charges >= 60  THEN 'Medium'
    ELSE 'Low'
  END AS revenue_bucket,
  cc._loaded_at
FROM "silver"."customers_clean" AS cc;
  );
  
[0m14:44:46.903770 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 59: FROM "silver"."customers_clean" AS cc;
                                              ^

[0m14:44:46.904209 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: ROLLBACK
[0m14:44:46.904678 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m14:44:46.905167 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: Close
[0m14:44:46.905560 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:44:46.906856 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "airflow"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m14:44:46.907919 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.005 seconds
[0m14:44:46.913848 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.006 seconds
[0m14:44:46.914949 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:44:46.917935 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:44:46.918741 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m14:44:46.919389 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean" rename to "customers_clean__dbt_backup"
[0m14:44:46.921137 [debug] [Thread-1 (]: Database Error in model customer_360 (models/gold/customer_360.sql)
  syntax error at or near ";"
  LINE 59: FROM "silver"."customers_clean" AS cc;
                                                ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql
[0m14:44:46.922697 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:46.923055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390e8a46-6f0c-4269-9d34-cef1ede5387c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a080aa0>]}
[0m14:44:46.924837 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:44:46.925433 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model gold.customer_360 ........................ [[31mERROR[0m in 0.08s]
[0m14:44:46.926068 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m14:44:46.926500 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customer_360
[0m14:44:46.927073 [debug] [Thread-7 (]: Marking all children of 'model.elt_assignment.customer_360' to be skipped because of status 'error'.  Reason: Database Error in model customer_360 (models/gold/customer_360.sql)
  syntax error at or near ";"
  LINE 59: FROM "silver"."customers_clean" AS cc;
                                                ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql.
[0m14:44:46.927321 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:44:46.939422 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:44:46.939887 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:44:46.940200 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:44:46.941147 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:44:46.941378 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m14:44:46.945104 [debug] [Thread-2 (]: Applying DROP to: "airflow"."silver"."customers_clean__dbt_backup"
[0m14:44:46.947002 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:44:46.949902 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:44:46.950253 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m14:44:46.950570 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "airflow"."silver"."customers_clean__dbt_backup" cascade
[0m14:44:46.951093 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:44:46.952003 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:44:46.952359 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:44:46.952750 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:44:46.953621 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:44:46.953868 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:44:46.955245 [debug] [Thread-3 (]: Applying DROP to: "airflow"."bronze"."customers_raw__dbt_backup"
[0m14:44:46.956741 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: Close
[0m14:44:46.957193 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:44:46.957724 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390e8a46-6f0c-4269-9d34-cef1ede5387c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df048f0>]}
[0m14:44:46.958022 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "airflow"."bronze"."customers_raw__dbt_backup" cascade
[0m14:44:46.958556 [info ] [Thread-2 (]: 2 of 3 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.11s]
[0m14:44:46.959408 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_clean
[0m14:44:46.960306 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:44:46.961193 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: Close
[0m14:44:46.961624 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '390e8a46-6f0c-4269-9d34-cef1ede5387c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89110e90>]}
[0m14:44:46.962086 [info ] [Thread-3 (]: 3 of 3 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.12s]
[0m14:44:46.962693 [debug] [Thread-3 (]: Finished running node model.elt_assignment.customers_raw
[0m14:44:46.963919 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:46.964295 [debug] [MainThread]: On master: BEGIN
[0m14:44:46.964590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:44:46.967068 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:44:46.967389 [debug] [MainThread]: On master: COMMIT
[0m14:44:46.967681 [debug] [MainThread]: Using postgres connection "master"
[0m14:44:46.967921 [debug] [MainThread]: On master: COMMIT
[0m14:44:46.968206 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:44:46.968462 [debug] [MainThread]: On master: Close
[0m14:44:46.968853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:46.969123 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m14:44:46.969363 [debug] [MainThread]: Connection 'model.elt_assignment.customer_360' was properly closed.
[0m14:44:46.969681 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m14:44:46.970010 [info ] [MainThread]: 
[0m14:44:46.970431 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:44:46.971053 [debug] [MainThread]: Command end result
[0m14:44:47.038037 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:44:47.041660 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:44:47.047346 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:44:47.047739 [info ] [MainThread]: 
[0m14:44:47.048317 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:44:47.048762 [info ] [MainThread]: 
[0m14:44:47.049097 [error] [MainThread]: [31mFailure in model customer_360 (models/gold/customer_360.sql)[0m
[0m14:44:47.049670 [error] [MainThread]:   Database Error in model customer_360 (models/gold/customer_360.sql)
  syntax error at or near ";"
  LINE 59: FROM "silver"."customers_clean" AS cc;
                                                ^
  compiled code at target/run/elt_assignment/models/gold/customer_360.sql
[0m14:44:47.050234 [info ] [MainThread]: 
[0m14:44:47.050606 [info ] [MainThread]:   compiled code at target/compiled/elt_assignment/models/gold/customer_360.sql
[0m14:44:47.050902 [info ] [MainThread]: 
[0m14:44:47.051244 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:44:47.052250 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8738956, "process_in_blocks": "0", "process_kernel_time": 0.207757, "process_mem_max_rss": "128696", "process_out_blocks": "3365", "process_user_time": 1.677185}
[0m14:44:47.052684 [debug] [MainThread]: Command `dbt run` failed at 14:44:47.052620 after 0.87 seconds
[0m14:44:47.053006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89913470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891433e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89143080>]}
[0m14:44:47.053299 [debug] [MainThread]: Flushing usage events
[0m14:44:48.502900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:36.286245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a20d460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e754c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e75430>]}


============================== 14:45:36.293535 | f45e01e2-8694-4dc3-908e-892c158a6a92 ==============================
[0m14:45:36.293535 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:45:36.294330 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/opt/airflow/dbt/logs', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'no_print': 'None', 'use_colors': 'True', 'empty': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'debug': 'False', 'warn_error': 'None', 'invocation_command': 'dbt deps', 'use_experimental_parser': 'False', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'version_check': 'True', 'introspect': 'True', 'cache_selected_only': 'False'}
[0m14:45:36.391778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f45e01e2-8694-4dc3-908e-892c158a6a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894d6bd0>]}
[0m14:45:36.536021 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-s93wh2sq'
[0m14:45:36.536991 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:45:36.741899 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:45:36.744973 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:45:36.974749 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:45:36.981954 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:45:38.119359 [info ] [MainThread]: Installed from version 1.3.0
[0m14:45:38.120318 [info ] [MainThread]: Up to date!
[0m14:45:38.120914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f45e01e2-8694-4dc3-908e-892c158a6a92', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891f7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891f7980>]}
[0m14:45:38.122257 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.8766874, "process_in_blocks": "0", "process_kernel_time": 0.750331, "process_mem_max_rss": "105876", "process_out_blocks": "733", "process_user_time": 1.377459}
[0m14:45:38.122814 [debug] [MainThread]: Command `dbt deps` succeeded at 14:45:38.122744 after 1.88 seconds
[0m14:45:38.123279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89e754c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a04c230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff894d7c20>]}
[0m14:45:38.123706 [debug] [MainThread]: Flushing usage events
[0m14:45:39.569691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:42.061818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbaad5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba886540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba26cbf0>]}


============================== 14:45:42.066002 | 5b36dc1d-96da-4a57-9261-ba02c181aee1 ==============================
[0m14:45:42.066002 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:45:42.066684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'log_path': 'logs', 'empty': 'False', 'static_parser': 'True', 'no_print': 'None', 'write_json': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'introspect': 'True', 'warn_error': 'None', 'debug': 'False', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'invocation_command': 'dbt run --project-dir . --profiles-dir /opt/airflow/dbt', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False'}
[0m14:45:42.164608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b36dc1d-96da-4a57-9261-ba02c181aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a91ee0>]}
[0m14:45:42.195046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b36dc1d-96da-4a57-9261-ba02c181aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8a57680>]}
[0m14:45:42.195716 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:45:42.240212 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:45:42.351550 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:45:42.352121 [debug] [MainThread]: Partial parsing: updated file: elt_assignment://models/gold/customer_360.sql
[0m14:45:42.480211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b36dc1d-96da-4a57-9261-ba02c181aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb84ba960>]}
[0m14:45:42.526641 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:45:42.529953 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:45:42.544607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b36dc1d-96da-4a57-9261-ba02c181aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb875ba40>]}
[0m14:45:42.545009 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m14:45:42.545556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b36dc1d-96da-4a57-9261-ba02c181aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb847cc20>]}
[0m14:45:42.546607 [info ] [MainThread]: 
[0m14:45:42.546968 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:45:42.547219 [info ] [MainThread]: 
[0m14:45:42.547594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:45:42.549805 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:45:42.550375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:45:42.556329 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:45:42.580799 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:45:42.581112 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:45:42.581331 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:45:42.581652 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:45:42.581980 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:45:42.582287 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:45:42.582572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:42.582862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:42.583152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:42.588566 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m14:45:42.588887 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m14:45:42.589123 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m14:45:42.590019 [debug] [ThreadPool]: On list_airflow: Close
[0m14:45:42.590846 [debug] [ThreadPool]: On list_airflow: Close
[0m14:45:42.591586 [debug] [ThreadPool]: On list_airflow: Close
[0m14:45:42.593720 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_silver)
[0m14:45:42.594334 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_bronze)
[0m14:45:42.595052 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_gold)
[0m14:45:42.599107 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:45:42.600576 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:45:42.601746 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:45:42.602133 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m14:45:42.602462 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m14:45:42.602799 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m14:45:42.603086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:42.603366 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:42.603744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:45:42.609213 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:45:42.609632 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:45:42.609862 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:45:42.610233 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:45:42.610551 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:45:42.610910 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m14:45:42.611919 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:45:42.613293 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:45:42.613590 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:45:42.614532 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m14:45:42.614860 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:45:42.615301 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m14:45:42.615956 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:45:42.616835 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:45:42.617568 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m14:45:42.618297 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m14:45:42.618652 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m14:45:42.618924 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m14:45:42.622055 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:42.622421 [debug] [MainThread]: On master: BEGIN
[0m14:45:42.622695 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:45:42.624744 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:45:42.625101 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:42.625423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:45:42.627386 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:45:42.628204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b36dc1d-96da-4a57-9261-ba02c181aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb8317f50>]}
[0m14:45:42.628583 [debug] [MainThread]: On master: ROLLBACK
[0m14:45:42.628966 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:42.629230 [debug] [MainThread]: On master: BEGIN
[0m14:45:42.629649 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:45:42.629919 [debug] [MainThread]: On master: COMMIT
[0m14:45:42.630207 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:42.630461 [debug] [MainThread]: On master: COMMIT
[0m14:45:42.630797 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:45:42.631077 [debug] [MainThread]: On master: Close
[0m14:45:42.634165 [debug] [Thread-1 (]: Began running node model.elt_assignment.customer_360
[0m14:45:42.634467 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_clean
[0m14:45:42.634677 [debug] [Thread-3 (]: Began running node model.elt_assignment.customers_raw
[0m14:45:42.635198 [info ] [Thread-1 (]: 1 of 3 START sql table model gold.customer_360 ................................. [RUN]
[0m14:45:42.635921 [info ] [Thread-2 (]: 2 of 3 START sql table model silver.customers_clean ............................ [RUN]
[0m14:45:42.636505 [info ] [Thread-3 (]: 3 of 3 START sql table model bronze.customers_raw .............................. [RUN]
[0m14:45:42.637214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now model.elt_assignment.customer_360)
[0m14:45:42.637692 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_bronze, now model.elt_assignment.customers_clean)
[0m14:45:42.638127 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airflow_gold, now model.elt_assignment.customers_raw)
[0m14:45:42.638514 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customer_360
[0m14:45:42.638895 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_clean
[0m14:45:42.639265 [debug] [Thread-3 (]: Began compiling node model.elt_assignment.customers_raw
[0m14:45:42.644092 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customer_360"
[0m14:45:42.645576 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m14:45:42.646927 [debug] [Thread-3 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m14:45:42.649310 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customer_360
[0m14:45:42.657608 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_clean
[0m14:45:42.672415 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customer_360"
[0m14:45:42.672731 [debug] [Thread-3 (]: Began executing node model.elt_assignment.customers_raw
[0m14:45:42.674772 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m14:45:42.676957 [debug] [Thread-3 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m14:45:42.678648 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:45:42.679637 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: BEGIN
[0m14:45:42.679913 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:45:42.680267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:45:42.680520 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:45:42.680788 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: BEGIN
[0m14:45:42.681247 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: BEGIN
[0m14:45:42.681579 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:45:42.681843 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:45:42.684240 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m14:45:42.684541 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m14:45:42.684949 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:45:42.685207 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m14:45:42.685470 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:45:42.685804 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "airflow"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m14:45:42.686144 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:45:42.686451 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "airflow"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m14:45:42.687038 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */

  
    

  create  table "airflow"."gold"."customer_360__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  cc.customer_hash,
  cc.age,
  cc.gender,
  CASE
    WHEN cc.age < 25 THEN 'Under 25'
    WHEN cc.age BETWEEN 25 AND 34 THEN '25-34'
    WHEN cc.age BETWEEN 35 AND 44 THEN '35-44'
    WHEN cc.age BETWEEN 45 AND 54 THEN '45-54'
    WHEN cc.age BETWEEN 55 AND 64 THEN '55-64'
    WHEN cc.age >= 65 THEN '65+'
    ELSE 'Unknown'
  END AS age_band,
  cc.tenure_months,
  CASE
    WHEN cc.tenure_months < 3     THEN 'New ( <3m )'
    WHEN cc.tenure_months < 12    THEN '4-12m'      -- NOTE: 3-month edge is excluded by design here
    WHEN cc.tenure_months < 24    THEN '12-24m'
    WHEN cc.tenure_months < 36    THEN '24-36m'
    ELSE '36m+'
  END AS tenure_band,
  cc.monthly_charges,
  cc.total_charges,
  cc.contract_type,
  cc.internet_service,
  cc.has_tech_support,
  CASE
    WHEN cc.has_tech_support IS TRUE  THEN 'Yes'
    WHEN cc.has_tech_support IS FALSE THEN 'No'
    ELSE 'Unknown'
  END AS tech_support_label,
  cc.is_churned,
  CASE
    WHEN cc.is_churned IS TRUE  THEN 'Churned'
    WHEN cc.is_churned IS FALSE THEN 'Active'
    ELSE 'Unknown'
  END AS churn_status,
  cc.monthly_charges AS arpu,
  (cc.monthly_charges * GREATEST(cc.tenure_months, 0))::NUMERIC(12,2) AS ltv_estimate,
  CASE
    WHEN cc.monthly_charges >= 100 THEN 'High'
    WHEN cc.monthly_charges >= 60  THEN 'Medium'
    ELSE 'Low'
  END AS revenue_bucket,
  cc._loaded_at
FROM "silver"."customers_clean" AS cc
  );
  
[0m14:45:42.695437 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.009 seconds
[0m14:45:42.695815 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.008 seconds
[0m14:45:42.701971 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:45:42.702260 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.015 seconds
[0m14:45:42.703905 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:45:42.704254 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean" rename to "customers_clean__dbt_backup"
[0m14:45:42.705926 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:45:42.706286 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m14:45:42.706740 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
alter table "airflow"."gold"."customer_360" rename to "customer_360__dbt_backup"
[0m14:45:42.707356 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:42.708837 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:45:42.709110 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
alter table "airflow"."gold"."customer_360__dbt_tmp" rename to "customer_360"
[0m14:45:42.709568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:42.718778 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: COMMIT
[0m14:45:42.719316 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:45:42.719674 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: COMMIT
[0m14:45:42.720280 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m14:45:42.720563 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m14:45:42.724579 [debug] [Thread-1 (]: Applying DROP to: "airflow"."gold"."customer_360__dbt_backup"
[0m14:45:42.726663 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:45:42.730571 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:45:42.731020 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m14:45:42.731327 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
drop table if exists "airflow"."gold"."customer_360__dbt_backup" cascade
[0m14:45:42.731888 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:42.732986 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:45:42.733496 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:45:42.733915 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:45:42.734156 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:45:42.735701 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: Close
[0m14:45:42.737358 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m14:45:42.737707 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:45:42.738114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b36dc1d-96da-4a57-9261-ba02c181aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffbc1c67e0>]}
[0m14:45:42.779094 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:45:42.780516 [debug] [Thread-2 (]: Applying DROP to: "airflow"."silver"."customers_clean__dbt_backup"
[0m14:45:42.781104 [info ] [Thread-1 (]: 1 of 3 OK created sql table model gold.customer_360 ............................ [[32mSELECT 1000[0m in 0.10s]
[0m14:45:42.781778 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m14:45:42.782235 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:45:42.782739 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customer_360
[0m14:45:42.783215 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "airflow"."silver"."customers_clean__dbt_backup" cascade
[0m14:45:42.783479 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:45:42.785001 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:45:42.785375 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:45:42.785685 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:45:42.786123 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:45:42.787023 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: Close
[0m14:45:42.787598 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b36dc1d-96da-4a57-9261-ba02c181aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7319b50>]}
[0m14:45:42.787846 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:45:42.788271 [info ] [Thread-2 (]: 2 of 3 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.15s]
[0m14:45:42.790004 [debug] [Thread-3 (]: Applying DROP to: "airflow"."bronze"."customers_raw__dbt_backup"
[0m14:45:42.790533 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_clean
[0m14:45:42.791007 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:45:42.791469 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "airflow"."bronze"."customers_raw__dbt_backup" cascade
[0m14:45:42.793047 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:45:42.793943 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: Close
[0m14:45:42.794432 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5b36dc1d-96da-4a57-9261-ba02c181aee1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb77548c0>]}
[0m14:45:42.794949 [info ] [Thread-3 (]: 3 of 3 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.16s]
[0m14:45:42.795555 [debug] [Thread-3 (]: Finished running node model.elt_assignment.customers_raw
[0m14:45:42.796846 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:42.797169 [debug] [MainThread]: On master: BEGIN
[0m14:45:42.797421 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:45:42.799509 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:45:42.799857 [debug] [MainThread]: On master: COMMIT
[0m14:45:42.800197 [debug] [MainThread]: Using postgres connection "master"
[0m14:45:42.800463 [debug] [MainThread]: On master: COMMIT
[0m14:45:42.800790 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:45:42.801068 [debug] [MainThread]: On master: Close
[0m14:45:42.801405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:42.801654 [debug] [MainThread]: Connection 'model.elt_assignment.customer_360' was properly closed.
[0m14:45:42.801896 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m14:45:42.802247 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m14:45:42.802596 [info ] [MainThread]: 
[0m14:45:42.803063 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:45:42.803751 [debug] [MainThread]: Command end result
[0m14:45:42.826248 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:45:42.828553 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:45:42.833193 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:45:42.833470 [info ] [MainThread]: 
[0m14:45:42.834022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:42.834411 [info ] [MainThread]: 
[0m14:45:42.834742 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:45:42.835541 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8050479, "process_in_blocks": "0", "process_kernel_time": 0.166823, "process_mem_max_rss": "127744", "process_out_blocks": "3366", "process_user_time": 1.696369}
[0m14:45:42.835953 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:42.835884 after 0.81 seconds
[0m14:45:42.836250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9b9ef00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffba254380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb84517c0>]}
[0m14:45:42.836538 [debug] [MainThread]: Flushing usage events
[0m14:45:44.477056 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:46.486811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb95cd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e96ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96521b0>]}


============================== 14:45:46.492208 | ccd5cead-ff71-4877-bdd3-9a7b81566d29 ==============================
[0m14:45:46.492208 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:45:46.493249 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'debug': 'False', 'quiet': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'partial_parse': 'True', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dbt', 'printer_width': '80', 'log_path': 'logs', 'invocation_command': 'dbt test --project-dir . --profiles-dir /opt/airflow/dbt', 'static_parser': 'True', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'write_json': 'True', 'version_check': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m14:45:46.591515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccd5cead-ff71-4877-bdd3-9a7b81566d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9c5e660>]}
[0m14:45:46.621801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccd5cead-ff71-4877-bdd3-9a7b81566d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb89e0770>]}
[0m14:45:46.622435 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:45:46.668898 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:45:46.775380 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:46.775901 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:46.793690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccd5cead-ff71-4877-bdd3-9a7b81566d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e2f4a0>]}
[0m14:45:46.841405 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:45:46.843971 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:45:46.863777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccd5cead-ff71-4877-bdd3-9a7b81566d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7884680>]}
[0m14:45:46.864219 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m14:45:46.864700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccd5cead-ff71-4877-bdd3-9a7b81566d29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e085c0>]}
[0m14:45:46.865785 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:45:46.867118 [debug] [MainThread]: Command end result
[0m14:45:46.893822 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:45:46.896017 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:45:46.898985 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:45:46.899791 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.44674525, "process_in_blocks": "0", "process_kernel_time": 0.148001, "process_mem_max_rss": "117400", "process_out_blocks": "2185", "process_user_time": 1.427018}
[0m14:45:46.900232 [debug] [MainThread]: Command `dbt test` succeeded at 14:45:46.900164 after 0.45 seconds
[0m14:45:46.900579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb96521b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb9e306b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb7e2f800>]}
[0m14:45:46.900889 [debug] [MainThread]: Flushing usage events
[0m14:45:48.621681 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:20.084375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab29f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad95e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacbb5190>]}


============================== 14:49:20.089583 | 00339768-7739-4a30-96f6-97d36c912e9c ==============================
[0m14:49:20.089583 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:49:20.090841 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'empty': 'None', 'profiles_dir': '/opt/airflow/dbt', 'partial_parse': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'version_check': 'True', 'target_path': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'log_path': '/opt/airflow/dbt/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'cache_selected_only': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'printer_width': '80', 'static_parser': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'warn_error': 'None', 'invocation_command': 'dbt deps'}
[0m14:49:20.172950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00339768-7739-4a30-96f6-97d36c912e9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad7e270>]}
[0m14:49:20.311174 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-4ros87gh'
[0m14:49:20.311792 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:49:22.922326 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:49:22.924695 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:49:23.195868 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:49:23.202908 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:49:24.606799 [info ] [MainThread]: Installed from version 1.3.0
[0m14:49:24.607592 [info ] [MainThread]: Up to date!
[0m14:49:24.608172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '00339768-7739-4a30-96f6-97d36c912e9c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabfd340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaabfd5b0>]}
[0m14:49:24.609372 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.560315, "process_in_blocks": "0", "process_kernel_time": 0.322701, "process_mem_max_rss": "105700", "process_out_blocks": "733", "process_user_time": 1.383292}
[0m14:49:24.609834 [debug] [MainThread]: Command `dbt deps` succeeded at 14:49:24.609772 after 4.56 seconds
[0m14:49:24.610183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaad7ec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaadeeba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaadec410>]}
[0m14:49:24.610612 [debug] [MainThread]: Flushing usage events
[0m14:49:27.432641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:29.785269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaa2ec2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae05ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaf3dc70>]}


============================== 14:49:29.789262 | a0ee9c36-afec-449a-8d44-271198c66d82 ==============================
[0m14:49:29.789262 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:49:29.789987 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'static_parser': 'True', 'log_format': 'default', 'version_check': 'True', 'write_json': 'True', 'log_path': 'logs', 'printer_width': '80', 'fail_fast': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'introspect': 'True', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'target_path': 'None', 'profiles_dir': '/opt/airflow/dbt', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'invocation_command': 'dbt run --project-dir . --profiles-dir /opt/airflow/dbt', 'cache_selected_only': 'False'}
[0m14:49:29.894835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0ee9c36-afec-449a-8d44-271198c66d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa94d3170>]}
[0m14:49:29.926444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0ee9c36-afec-449a-8d44-271198c66d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffac64a780>]}
[0m14:49:29.927115 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:49:29.973539 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:49:30.074200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:49:30.076029 [debug] [MainThread]: Partial parsing: added file: elt_assignment://models/gold.yml
[0m14:49:30.114142 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'vw_customer_360' in the 'models' section of file 'models/gold.yml'
[0m14:49:30.164636 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m14:49:30.165375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a0ee9c36-afec-449a-8d44-271198c66d82', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffab349730>]}
[0m14:49:30.189331 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.elt_assignment.not_null_vw_customer_360_customer_hash.1740ff3523' (models/gold.yml) depends on a node named 'vw_customer_360' in package '' which was not found
[0m14:49:30.189874 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.elt_assignment.unique_vw_customer_360_customer_hash.0e9c8937eb' (models/gold.yml) depends on a node named 'vw_customer_360' in package '' which was not found
[0m14:49:30.190280 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.elt_assignment.accepted_values_vw_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.e4fd1fdecb' (models/gold.yml) depends on a node named 'vw_customer_360' in package '' which was not found
[0m14:49:30.190693 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.elt_assignment.accepted_values_vw_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.b857d0ed40' (models/gold.yml) depends on a node named 'vw_customer_360' in package '' which was not found
[0m14:49:30.191062 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.elt_assignment.accepted_values_vw_customer_360_tech_support_label__Yes__No__Unknown.d57bdda4c1' (models/gold.yml) depends on a node named 'vw_customer_360' in package '' which was not found
[0m14:49:30.191423 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.elt_assignment.accepted_values_vw_customer_360_churn_status__Churned__Active__Unknown.3076627921' (models/gold.yml) depends on a node named 'vw_customer_360' in package '' which was not found
[0m14:49:30.191780 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.elt_assignment.accepted_values_vw_customer_360_revenue_bucket__High__Medium__Low.2251f8e8ce' (models/gold.yml) depends on a node named 'vw_customer_360' in package '' which was not found
[0m14:49:30.234090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a0ee9c36-afec-449a-8d44-271198c66d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8ed2270>]}
[0m14:49:30.293571 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:49:30.296521 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:49:30.312277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a0ee9c36-afec-449a-8d44-271198c66d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f1e030>]}
[0m14:49:30.312702 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m14:49:30.313272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0ee9c36-afec-449a-8d44-271198c66d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa93821b0>]}
[0m14:49:30.314359 [info ] [MainThread]: 
[0m14:49:30.314736 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:49:30.315146 [info ] [MainThread]: 
[0m14:49:30.315644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:49:30.317918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:49:30.324064 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:49:30.324838 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:49:30.350769 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:49:30.351068 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:49:30.351522 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:49:30.351833 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:49:30.352138 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:49:30.352431 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:49:30.352705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:30.352970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:30.353222 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:30.360331 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m14:49:30.360603 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m14:49:30.360799 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m14:49:30.361718 [debug] [ThreadPool]: On list_airflow: Close
[0m14:49:30.362485 [debug] [ThreadPool]: On list_airflow: Close
[0m14:49:30.363258 [debug] [ThreadPool]: On list_airflow: Close
[0m14:49:30.365314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_gold)
[0m14:49:30.365835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_silver)
[0m14:49:30.366327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_bronze)
[0m14:49:30.370158 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:49:30.371324 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:49:30.372613 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:49:30.373053 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m14:49:30.373505 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m14:49:30.373813 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m14:49:30.375114 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:30.375446 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:30.375753 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:30.379026 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:49:30.379610 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:49:30.379872 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:49:30.380336 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:49:30.380807 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:49:30.381490 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:49:30.382219 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:49:30.382646 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:49:30.383284 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m14:49:30.384981 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m14:49:30.385337 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:49:30.386489 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m14:49:30.387041 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:49:30.388213 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m14:49:30.388871 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m14:49:30.389888 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m14:49:30.390598 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m14:49:30.393597 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m14:49:30.397653 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:30.398199 [debug] [MainThread]: On master: BEGIN
[0m14:49:30.398700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:30.410167 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m14:49:30.410717 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:30.411603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:49:30.422312 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m14:49:30.424073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a0ee9c36-afec-449a-8d44-271198c66d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8f8ed50>]}
[0m14:49:30.424790 [debug] [MainThread]: On master: ROLLBACK
[0m14:49:30.425417 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:30.425785 [debug] [MainThread]: On master: BEGIN
[0m14:49:30.426511 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:49:30.427308 [debug] [MainThread]: On master: COMMIT
[0m14:49:30.427952 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:30.428345 [debug] [MainThread]: On master: COMMIT
[0m14:49:30.428888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:49:30.429304 [debug] [MainThread]: On master: Close
[0m14:49:30.434532 [debug] [Thread-1 (]: Began running node model.elt_assignment.customer_360
[0m14:49:30.434982 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_clean
[0m14:49:30.435266 [debug] [Thread-3 (]: Began running node model.elt_assignment.customers_raw
[0m14:49:30.436125 [info ] [Thread-1 (]: 1 of 3 START sql table model gold.customer_360 ................................. [RUN]
[0m14:49:30.436859 [info ] [Thread-2 (]: 2 of 3 START sql table model silver.customers_clean ............................ [RUN]
[0m14:49:30.437358 [info ] [Thread-3 (]: 3 of 3 START sql table model bronze.customers_raw .............................. [RUN]
[0m14:49:30.437976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_bronze, now model.elt_assignment.customer_360)
[0m14:49:30.438418 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now model.elt_assignment.customers_clean)
[0m14:49:30.438831 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airflow_gold, now model.elt_assignment.customers_raw)
[0m14:49:30.439388 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customer_360
[0m14:49:30.439886 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_clean
[0m14:49:30.440425 [debug] [Thread-3 (]: Began compiling node model.elt_assignment.customers_raw
[0m14:49:30.445868 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customer_360"
[0m14:49:30.448138 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m14:49:30.449848 [debug] [Thread-3 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m14:49:30.452709 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customer_360
[0m14:49:30.459695 [debug] [Thread-3 (]: Began executing node model.elt_assignment.customers_raw
[0m14:49:30.460141 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_clean
[0m14:49:30.486093 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customer_360"
[0m14:49:30.488661 [debug] [Thread-3 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m14:49:30.493935 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m14:49:30.496737 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:49:30.497473 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: BEGIN
[0m14:49:30.498014 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:49:30.498325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:30.498599 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:49:30.498878 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: BEGIN
[0m14:49:30.499484 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: BEGIN
[0m14:49:30.500424 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:49:30.501582 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:49:30.502513 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:49:30.503187 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:49:30.503678 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */

  
    

  create  table "airflow"."gold"."customer_360__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  cc.customer_hash,
  cc.age,
  cc.gender,
  CASE
    WHEN cc.age < 25 THEN 'Under 25'
    WHEN cc.age BETWEEN 25 AND 34 THEN '25-34'
    WHEN cc.age BETWEEN 35 AND 44 THEN '35-44'
    WHEN cc.age BETWEEN 45 AND 54 THEN '45-54'
    WHEN cc.age BETWEEN 55 AND 64 THEN '55-64'
    WHEN cc.age >= 65 THEN '65+'
    ELSE 'Unknown'
  END AS age_band,
  cc.tenure_months,
  CASE
    WHEN cc.tenure_months < 3     THEN 'New ( <3m )'
    WHEN cc.tenure_months < 12    THEN '4-12m'      -- NOTE: 3-month edge is excluded by design here
    WHEN cc.tenure_months < 24    THEN '12-24m'
    WHEN cc.tenure_months < 36    THEN '24-36m'
    ELSE '36m+'
  END AS tenure_band,
  cc.monthly_charges,
  cc.total_charges,
  cc.contract_type,
  cc.internet_service,
  cc.has_tech_support,
  CASE
    WHEN cc.has_tech_support IS TRUE  THEN 'Yes'
    WHEN cc.has_tech_support IS FALSE THEN 'No'
    ELSE 'Unknown'
  END AS tech_support_label,
  cc.is_churned,
  CASE
    WHEN cc.is_churned IS TRUE  THEN 'Churned'
    WHEN cc.is_churned IS FALSE THEN 'Active'
    ELSE 'Unknown'
  END AS churn_status,
  cc.monthly_charges AS arpu,
  (cc.monthly_charges * GREATEST(cc.tenure_months, 0))::NUMERIC(12,2) AS ltv_estimate,
  CASE
    WHEN cc.monthly_charges >= 100 THEN 'High'
    WHEN cc.monthly_charges >= 60  THEN 'Medium'
    ELSE 'Low'
  END AS revenue_bucket,
  cc._loaded_at
FROM "silver"."customers_clean" AS cc
  );
  
[0m14:49:30.511663 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m14:49:30.512396 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:49:30.514243 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "airflow"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m14:49:30.516321 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m14:49:30.516859 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:49:30.517426 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "airflow"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m14:49:30.521180 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.017 seconds
[0m14:49:30.535913 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.021 seconds
[0m14:49:30.540542 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:49:30.541112 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.023 seconds
[0m14:49:30.671283 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:49:30.671852 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
alter table "airflow"."gold"."customer_360" rename to "customer_360__dbt_backup"
[0m14:49:30.674189 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:49:30.674679 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean" rename to "customers_clean__dbt_backup"
[0m14:49:30.675379 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m14:49:30.675765 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:49:30.678077 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:49:30.678455 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
alter table "airflow"."gold"."customer_360__dbt_tmp" rename to "customer_360"
[0m14:49:30.679020 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:49:30.689751 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: COMMIT
[0m14:49:30.690597 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:49:30.691109 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: COMMIT
[0m14:49:30.692190 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:49:30.692543 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m14:49:30.696886 [debug] [Thread-1 (]: Applying DROP to: "airflow"."gold"."customer_360__dbt_backup"
[0m14:49:30.699250 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:49:30.702743 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:49:30.703339 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m14:49:30.703774 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
drop table if exists "airflow"."gold"."customer_360__dbt_backup" cascade
[0m14:49:30.704540 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:49:30.705934 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:49:30.706392 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:49:30.706832 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:49:30.707601 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:49:30.707897 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:49:30.708158 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.032 seconds
[0m14:49:30.709842 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: Close
[0m14:49:30.711537 [debug] [Thread-2 (]: Applying DROP to: "airflow"."silver"."customers_clean__dbt_backup"
[0m14:49:30.713398 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:49:30.714845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ee9c36-afec-449a-8d44-271198c66d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacc3bfe0>]}
[0m14:49:30.715399 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:49:30.715782 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m14:49:30.716256 [info ] [Thread-1 (]: 1 of 3 OK created sql table model gold.customer_360 ............................ [[32mSELECT 1000[0m in 0.28s]
[0m14:49:30.716936 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "airflow"."silver"."customers_clean__dbt_backup" cascade
[0m14:49:30.717677 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customer_360
[0m14:49:30.717952 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:49:30.719730 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:49:30.720025 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:49:30.720450 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:49:30.721417 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: Close
[0m14:49:30.721778 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:49:30.722335 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ee9c36-afec-449a-8d44-271198c66d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81b4770>]}
[0m14:49:30.723096 [info ] [Thread-2 (]: 2 of 3 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.28s]
[0m14:49:30.723464 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:49:30.723957 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_clean
[0m14:49:30.725813 [debug] [Thread-3 (]: Applying DROP to: "airflow"."bronze"."customers_raw__dbt_backup"
[0m14:49:30.726744 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:49:30.727104 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "airflow"."bronze"."customers_raw__dbt_backup" cascade
[0m14:49:30.728573 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:49:30.729585 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: Close
[0m14:49:30.730151 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a0ee9c36-afec-449a-8d44-271198c66d82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa81a22d0>]}
[0m14:49:30.730725 [info ] [Thread-3 (]: 3 of 3 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.29s]
[0m14:49:30.731388 [debug] [Thread-3 (]: Finished running node model.elt_assignment.customers_raw
[0m14:49:30.732557 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:30.732848 [debug] [MainThread]: On master: BEGIN
[0m14:49:30.733103 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:30.735665 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:49:30.736054 [debug] [MainThread]: On master: COMMIT
[0m14:49:30.736409 [debug] [MainThread]: Using postgres connection "master"
[0m14:49:30.736773 [debug] [MainThread]: On master: COMMIT
[0m14:49:30.737156 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:49:30.737444 [debug] [MainThread]: On master: Close
[0m14:49:30.737808 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:30.738090 [debug] [MainThread]: Connection 'model.elt_assignment.customer_360' was properly closed.
[0m14:49:30.738380 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m14:49:30.738614 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m14:49:30.738925 [info ] [MainThread]: 
[0m14:49:30.739416 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m14:49:30.740146 [debug] [MainThread]: Command end result
[0m14:49:30.764885 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:49:30.767338 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:49:30.773222 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:49:30.773589 [info ] [MainThread]: 
[0m14:49:30.774204 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:49:30.774656 [info ] [MainThread]: 
[0m14:49:30.775140 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:49:30.775788 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:49:30.776842 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0216203, "process_in_blocks": "0", "process_kernel_time": 0.166977, "process_mem_max_rss": "127188", "process_out_blocks": "3478", "process_user_time": 1.888363}
[0m14:49:30.777340 [debug] [MainThread]: Command `dbt run` succeeded at 14:49:30.777270 after 1.02 seconds
[0m14:49:30.777739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad2759a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffaaecb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffa8d87a10>]}
[0m14:49:30.778104 [debug] [MainThread]: Flushing usage events
[0m14:49:32.607244 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:49:35.061690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c6b58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8df4b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ccd6270>]}


============================== 14:49:35.067896 | b7074a79-f33e-4979-9019-b845f33954d4 ==============================
[0m14:49:35.067896 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:49:35.068802 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'fail_fast': 'False', 'target_path': 'None', 'warn_error': 'None', 'quiet': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'profiles_dir': '/opt/airflow/dbt', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt test --project-dir . --profiles-dir /opt/airflow/dbt', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'static_parser': 'True', 'introspect': 'True', 'no_print': 'None', 'empty': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'log_path': 'logs', 'debug': 'False'}
[0m14:49:35.191061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7074a79-f33e-4979-9019-b845f33954d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ae3f2c0>]}
[0m14:49:35.227905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b7074a79-f33e-4979-9019-b845f33954d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c639d00>]}
[0m14:49:35.228649 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:49:35.285543 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:49:35.421477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:35.421954 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:35.445307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7074a79-f33e-4979-9019-b845f33954d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ad69e50>]}
[0m14:49:35.509632 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:49:35.512411 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:49:35.536164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7074a79-f33e-4979-9019-b845f33954d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a7bd760>]}
[0m14:49:35.536676 [info ] [MainThread]: Found 3 models, 1 source, 550 macros
[0m14:49:35.537294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7074a79-f33e-4979-9019-b845f33954d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8d6930>]}
[0m14:49:35.538407 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m14:49:35.539733 [debug] [MainThread]: Command end result
[0m14:49:35.562085 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:49:35.564502 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:49:35.567507 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:49:35.568357 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.544292, "process_in_blocks": "384", "process_kernel_time": 0.314102, "process_mem_max_rss": "117532", "process_out_blocks": "2268", "process_user_time": 1.540407}
[0m14:49:35.568778 [debug] [MainThread]: Command `dbt test` succeeded at 14:49:35.568709 after 0.54 seconds
[0m14:49:35.569131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8bbe4350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b99a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8e8290a0>]}
[0m14:49:35.569480 [debug] [MainThread]: Flushing usage events
[0m14:49:40.450099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:52:21.655890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad5bfb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5a4a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae5a4b00>]}


============================== 14:52:21.660921 | aa55023f-c854-4f68-979f-5af644c21bf8 ==============================
[0m14:52:21.660921 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:52:21.661794 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'static_parser': 'True', 'use_colors': 'True', 'version_check': 'True', 'empty': 'None', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'log_cache_events': 'False', 'target_path': 'None', 'log_format': 'default', 'log_path': '/opt/airflow/dbt/logs', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt deps', 'cache_selected_only': 'False'}
[0m14:52:21.746394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa55023f-c854-4f68-979f-5af644c21bf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffae04a960>]}
[0m14:52:21.907382 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ffupl7w7'
[0m14:52:21.907925 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:52:25.035434 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:52:25.037695 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:52:25.558161 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:52:25.564112 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:52:26.817903 [info ] [MainThread]: Installed from version 1.3.0
[0m14:52:26.818623 [info ] [MainThread]: Up to date!
[0m14:52:26.819161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aa55023f-c854-4f68-979f-5af644c21bf8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad07a7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffacfe68d0>]}
[0m14:52:26.820601 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 5.2079644, "process_in_blocks": "0", "process_kernel_time": 0.366063, "process_mem_max_rss": "105696", "process_out_blocks": "733", "process_user_time": 1.39511}
[0m14:52:26.821182 [debug] [MainThread]: Command `dbt deps` succeeded at 14:52:26.821094 after 5.21 seconds
[0m14:52:26.821599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffb1bbb020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad1150d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffffad0827b0>]}
[0m14:52:26.821933 [debug] [MainThread]: Flushing usage events
[0m14:52:28.477188 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:52:30.219216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85541550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff877d59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff850fe960>]}


============================== 14:52:30.223369 | 5f91fa76-9455-4147-88d2-65cf75c64c45 ==============================
[0m14:52:30.223369 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:52:30.224118 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'warn_error': 'None', 'invocation_command': 'dbt run --project-dir . --profiles-dir /opt/airflow/dbt', 'debug': 'False', 'profiles_dir': '/opt/airflow/dbt', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'static_parser': 'True', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'indirect_selection': 'eager', 'empty': 'False', 'printer_width': '80', 'introspect': 'True', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'write_json': 'True'}
[0m14:52:30.323064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5f91fa76-9455-4147-88d2-65cf75c64c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85a78d70>]}
[0m14:52:30.360042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5f91fa76-9455-4147-88d2-65cf75c64c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83a1a720>]}
[0m14:52:30.360775 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:30.405445 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:52:30.530096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:52:30.530771 [debug] [MainThread]: Partial parsing: updated file: elt_assignment://models/gold.yml
[0m14:52:30.614407 [warn ] [MainThread]: [[33mWARNING[0m][MissingArgumentsPropertyInGenericTestDeprecation]: Deprecated
functionality
Found top-level arguments to test `accepted_values`. Arguments to generic tests
should be nested under the `arguments` property.`
[0m14:52:30.615117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5f91fa76-9455-4147-88d2-65cf75c64c45', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8460b950>]}
[0m14:52:30.677025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f91fa76-9455-4147-88d2-65cf75c64c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff839093a0>]}
[0m14:52:30.735136 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:52:30.737943 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:52:30.755840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f91fa76-9455-4147-88d2-65cf75c64c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff836f6300>]}
[0m14:52:30.756327 [info ] [MainThread]: Found 3 models, 7 data tests, 1 source, 550 macros
[0m14:52:30.756878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f91fa76-9455-4147-88d2-65cf75c64c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8344f380>]}
[0m14:52:30.757992 [info ] [MainThread]: 
[0m14:52:30.758436 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:30.758824 [info ] [MainThread]: 
[0m14:52:30.759324 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:30.761970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:52:30.762424 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:52:30.769084 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m14:52:30.795487 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:52:30.795808 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:52:30.796028 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m14:52:30.796357 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:52:30.796680 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:52:30.796997 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m14:52:30.797317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:30.797609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:30.797875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:30.805400 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m14:52:30.805665 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m14:52:30.805870 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m14:52:30.806793 [debug] [ThreadPool]: On list_airflow: Close
[0m14:52:30.807572 [debug] [ThreadPool]: On list_airflow: Close
[0m14:52:30.808338 [debug] [ThreadPool]: On list_airflow: Close
[0m14:52:30.810487 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_silver)
[0m14:52:30.811109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_gold)
[0m14:52:30.811790 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_bronze)
[0m14:52:30.815234 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:52:30.817920 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:52:30.819056 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:52:30.819390 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m14:52:30.819676 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m14:52:30.819941 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m14:52:30.820258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:30.820538 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:30.820795 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:30.824668 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:52:30.825204 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m14:52:30.825481 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:52:30.825813 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:52:30.826138 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:52:30.826376 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:52:30.826629 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:52:30.827041 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:52:30.827498 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m14:52:30.829313 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:52:30.829514 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:52:30.829713 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:52:30.830614 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m14:52:30.831412 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m14:52:30.832147 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m14:52:30.832523 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m14:52:30.832764 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m14:52:30.833028 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m14:52:30.837569 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:30.837980 [debug] [MainThread]: On master: BEGIN
[0m14:52:30.838247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:30.841475 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m14:52:30.841867 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:30.842234 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:30.844980 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m14:52:30.845996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f91fa76-9455-4147-88d2-65cf75c64c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff83477680>]}
[0m14:52:30.846468 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:30.846851 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:30.847157 [debug] [MainThread]: On master: BEGIN
[0m14:52:30.847669 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:52:30.847913 [debug] [MainThread]: On master: COMMIT
[0m14:52:30.848137 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:30.848337 [debug] [MainThread]: On master: COMMIT
[0m14:52:30.848598 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:30.848795 [debug] [MainThread]: On master: Close
[0m14:52:30.851809 [debug] [Thread-1 (]: Began running node model.elt_assignment.customer_360
[0m14:52:30.852098 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_clean
[0m14:52:30.852343 [debug] [Thread-3 (]: Began running node model.elt_assignment.customers_raw
[0m14:52:30.852746 [info ] [Thread-1 (]: 1 of 3 START sql table model gold.customer_360 ................................. [RUN]
[0m14:52:30.853363 [info ] [Thread-2 (]: 2 of 3 START sql table model silver.customers_clean ............................ [RUN]
[0m14:52:30.853828 [info ] [Thread-3 (]: 3 of 3 START sql table model bronze.customers_raw .............................. [RUN]
[0m14:52:30.854223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_gold, now model.elt_assignment.customer_360)
[0m14:52:30.854566 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now model.elt_assignment.customers_clean)
[0m14:52:30.854871 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airflow_bronze, now model.elt_assignment.customers_raw)
[0m14:52:30.855168 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customer_360
[0m14:52:30.855463 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_clean
[0m14:52:30.855771 [debug] [Thread-3 (]: Began compiling node model.elt_assignment.customers_raw
[0m14:52:30.860035 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customer_360"
[0m14:52:30.861147 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m14:52:30.862219 [debug] [Thread-3 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m14:52:30.865137 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customer_360
[0m14:52:30.878469 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_clean
[0m14:52:30.885941 [debug] [Thread-3 (]: Began executing node model.elt_assignment.customers_raw
[0m14:52:30.886371 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customer_360"
[0m14:52:30.888010 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m14:52:30.889636 [debug] [Thread-3 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m14:52:30.892992 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:52:30.893243 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:52:30.893603 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:52:30.893813 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: BEGIN
[0m14:52:30.894104 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: BEGIN
[0m14:52:30.894402 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: BEGIN
[0m14:52:30.894699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:30.894991 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:52:30.895261 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:52:30.898248 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m14:52:30.898566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:52:30.898939 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:52:30.899206 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m14:52:30.899496 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:52:30.899809 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "airflow"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m14:52:30.900110 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:52:30.900429 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */

  
    

  create  table "airflow"."gold"."customer_360__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  cc.customer_hash,
  cc.age,
  cc.gender,
  CASE
    WHEN cc.age < 25 THEN 'Under 25'
    WHEN cc.age BETWEEN 25 AND 34 THEN '25-34'
    WHEN cc.age BETWEEN 35 AND 44 THEN '35-44'
    WHEN cc.age BETWEEN 45 AND 54 THEN '45-54'
    WHEN cc.age BETWEEN 55 AND 64 THEN '55-64'
    WHEN cc.age >= 65 THEN '65+'
    ELSE 'Unknown'
  END AS age_band,
  cc.tenure_months,
  CASE
    WHEN cc.tenure_months < 3     THEN 'New ( <3m )'
    WHEN cc.tenure_months < 12    THEN '4-12m'      -- NOTE: 3-month edge is excluded by design here
    WHEN cc.tenure_months < 24    THEN '12-24m'
    WHEN cc.tenure_months < 36    THEN '24-36m'
    ELSE '36m+'
  END AS tenure_band,
  cc.monthly_charges,
  cc.total_charges,
  cc.contract_type,
  cc.internet_service,
  cc.has_tech_support,
  CASE
    WHEN cc.has_tech_support IS TRUE  THEN 'Yes'
    WHEN cc.has_tech_support IS FALSE THEN 'No'
    ELSE 'Unknown'
  END AS tech_support_label,
  cc.is_churned,
  CASE
    WHEN cc.is_churned IS TRUE  THEN 'Churned'
    WHEN cc.is_churned IS FALSE THEN 'Active'
    ELSE 'Unknown'
  END AS churn_status,
  cc.monthly_charges AS arpu,
  (cc.monthly_charges * GREATEST(cc.tenure_months, 0))::NUMERIC(12,2) AS ltv_estimate,
  CASE
    WHEN cc.monthly_charges >= 100 THEN 'High'
    WHEN cc.monthly_charges >= 60  THEN 'Medium'
    ELSE 'Low'
  END AS revenue_bucket,
  cc._loaded_at
FROM "silver"."customers_clean" AS cc
  );
  
[0m14:52:30.900994 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "airflow"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m14:52:30.907700 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.006 seconds
[0m14:52:30.913871 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:52:30.914207 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.013 seconds
[0m14:52:30.914469 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.014 seconds
[0m14:52:30.914674 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m14:52:30.917727 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:52:30.960015 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:52:30.960743 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
alter table "airflow"."gold"."customer_360" rename to "customer_360__dbt_backup"
[0m14:52:30.961160 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean" rename to "customers_clean__dbt_backup"
[0m14:52:30.961934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:52:30.963887 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:52:30.964347 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
alter table "airflow"."gold"."customer_360__dbt_tmp" rename to "customer_360"
[0m14:52:30.964872 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:52:30.974785 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: COMMIT
[0m14:52:30.975453 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:52:30.975816 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: COMMIT
[0m14:52:30.976693 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:52:30.976909 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.015 seconds
[0m14:52:30.980733 [debug] [Thread-1 (]: Applying DROP to: "airflow"."gold"."customer_360__dbt_backup"
[0m14:52:30.982689 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:52:30.985495 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m14:52:30.985866 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m14:52:30.986195 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
drop table if exists "airflow"."gold"."customer_360__dbt_backup" cascade
[0m14:52:30.986793 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:52:30.987839 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:52:30.988209 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:52:30.988590 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m14:52:30.989382 [debug] [Thread-2 (]: SQL status: COMMIT in 0.000 seconds
[0m14:52:30.989726 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.029 seconds
[0m14:52:30.989948 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:52:30.991347 [debug] [Thread-2 (]: Applying DROP to: "airflow"."silver"."customers_clean__dbt_backup"
[0m14:52:30.992939 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:52:30.994383 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: Close
[0m14:52:30.994821 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m14:52:30.995086 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m14:52:30.996658 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f91fa76-9455-4147-88d2-65cf75c64c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff858a55e0>]}
[0m14:52:30.997206 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "airflow"."silver"."customers_clean__dbt_backup" cascade
[0m14:52:30.998319 [info ] [Thread-1 (]: 1 of 3 OK created sql table model gold.customer_360 ............................ [[32mSELECT 1000[0m in 0.14s]
[0m14:52:30.998706 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:52:30.999316 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customer_360
[0m14:52:31.000298 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:52:31.000542 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:52:31.001070 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:52:31.002054 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: Close
[0m14:52:31.002382 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m14:52:31.002894 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f91fa76-9455-4147-88d2-65cf75c64c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81471790>]}
[0m14:52:31.003484 [info ] [Thread-2 (]: 2 of 3 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.15s]
[0m14:52:31.003787 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:52:31.004202 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_clean
[0m14:52:31.005727 [debug] [Thread-3 (]: Applying DROP to: "airflow"."bronze"."customers_raw__dbt_backup"
[0m14:52:31.006398 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m14:52:31.006687 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "airflow"."bronze"."customers_raw__dbt_backup" cascade
[0m14:52:31.008394 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:52:31.009694 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: Close
[0m14:52:31.010229 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5f91fa76-9455-4147-88d2-65cf75c64c45', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8148c860>]}
[0m14:52:31.010851 [info ] [Thread-3 (]: 3 of 3 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.16s]
[0m14:52:31.011614 [debug] [Thread-3 (]: Finished running node model.elt_assignment.customers_raw
[0m14:52:31.013198 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:31.013701 [debug] [MainThread]: On master: BEGIN
[0m14:52:31.014088 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:31.017820 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:52:31.018189 [debug] [MainThread]: On master: COMMIT
[0m14:52:31.018521 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:31.018790 [debug] [MainThread]: On master: COMMIT
[0m14:52:31.019109 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:31.019381 [debug] [MainThread]: On master: Close
[0m14:52:31.019744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:31.020023 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m14:52:31.020287 [debug] [MainThread]: Connection 'model.elt_assignment.customer_360' was properly closed.
[0m14:52:31.020538 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m14:52:31.020891 [info ] [MainThread]: 
[0m14:52:31.021394 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m14:52:31.022087 [debug] [MainThread]: Command end result
[0m14:52:31.047308 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:52:31.049760 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:52:31.054134 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:52:31.054438 [info ] [MainThread]: 
[0m14:52:31.054945 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:31.055293 [info ] [MainThread]: 
[0m14:52:31.055641 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:52:31.056055 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- MissingArgumentsPropertyInGenericTestDeprecation: 5 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:52:31.056861 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.86762244, "process_in_blocks": "0", "process_kernel_time": 0.175289, "process_mem_max_rss": "127276", "process_out_blocks": "3486", "process_user_time": 1.763914}
[0m14:52:31.057248 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:31.057186 after 0.87 seconds
[0m14:52:31.057575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85086060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff85087440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff81578bf0>]}
[0m14:52:31.057869 [debug] [MainThread]: Flushing usage events
[0m14:52:32.571499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:52:34.560759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b241af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a8364e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a869460>]}


============================== 14:52:34.565404 | 97ba1bea-1d71-4086-82de-4f27f6019249 ==============================
[0m14:52:34.565404 [info ] [MainThread]: Running with dbt=1.10.11
[0m14:52:34.566123 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'invocation_command': 'dbt test --project-dir . --profiles-dir /opt/airflow/dbt', 'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'write_json': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/opt/airflow/dbt', 'use_colors': 'True', 'static_parser': 'True', 'empty': 'None', 'no_print': 'None', 'version_check': 'True', 'target_path': 'None', 'indirect_selection': 'eager', 'log_path': 'logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None'}
[0m14:52:34.658463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '97ba1bea-1d71-4086-82de-4f27f6019249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff89b41e20>]}
[0m14:52:34.688010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '97ba1bea-1d71-4086-82de-4f27f6019249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff891d7c80>]}
[0m14:52:34.688580 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m14:52:34.731826 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m14:52:34.847258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:34.847714 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:34.870895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '97ba1bea-1d71-4086-82de-4f27f6019249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0721e0>]}
[0m14:52:34.923213 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:52:34.925679 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:52:34.945811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '97ba1bea-1d71-4086-82de-4f27f6019249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b7e3f0>]}
[0m14:52:34.946281 [info ] [MainThread]: Found 3 models, 7 data tests, 1 source, 550 macros
[0m14:52:34.946827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97ba1bea-1d71-4086-82de-4f27f6019249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b49610>]}
[0m14:52:34.948009 [info ] [MainThread]: 
[0m14:52:34.948417 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:34.948762 [info ] [MainThread]: 
[0m14:52:34.949212 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:34.949998 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_silver'
[0m14:52:34.950388 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_bronze'
[0m14:52:34.957434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_gold'
[0m14:52:34.972173 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:52:34.972476 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:52:34.972670 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:52:34.972956 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m14:52:34.973248 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m14:52:34.973577 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m14:52:34.973878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:34.974162 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:34.974603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:34.978054 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:52:34.978361 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:52:34.978611 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m14:52:34.978890 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m14:52:34.979172 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m14:52:34.979472 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m14:52:34.979727 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m14:52:34.980027 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m14:52:34.980344 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m14:52:34.982083 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:52:34.982343 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m14:52:34.982633 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m14:52:34.983499 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m14:52:34.984307 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m14:52:34.984980 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m14:52:34.985402 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m14:52:34.985783 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m14:52:34.986086 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m14:52:34.989858 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:34.990286 [debug] [MainThread]: On master: BEGIN
[0m14:52:34.990579 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:34.992764 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:52:34.993080 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:34.993435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:34.995228 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m14:52:34.996128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '97ba1bea-1d71-4086-82de-4f27f6019249', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88bfaba0>]}
[0m14:52:34.996527 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:34.996907 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:34.997181 [debug] [MainThread]: On master: BEGIN
[0m14:52:34.997756 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:52:34.998085 [debug] [MainThread]: On master: COMMIT
[0m14:52:34.998382 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:34.998654 [debug] [MainThread]: On master: COMMIT
[0m14:52:34.998982 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:34.999259 [debug] [MainThread]: On master: Close
[0m14:52:35.002181 [debug] [Thread-1 (]: Began running node test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a
[0m14:52:35.002489 [debug] [Thread-2 (]: Began running node test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248
[0m14:52:35.002741 [debug] [Thread-3 (]: Began running node test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75
[0m14:52:35.003015 [debug] [Thread-4 (]: Began running node test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e
[0m14:52:35.003242 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown  [RUN]
[0m14:52:35.003867 [info ] [Thread-2 (]: 2 of 7 START test accepted_values_customer_360_churn_status__Churned__Active__Unknown  [RUN]
[0m14:52:35.004343 [info ] [Thread-3 (]: 3 of 7 START test accepted_values_customer_360_revenue_bucket__High__Medium__Low  [RUN]
[0m14:52:35.004764 [info ] [Thread-4 (]: 4 of 7 START test accepted_values_customer_360_tech_support_label__Yes__No__Unknown  [RUN]
[0m14:52:35.005233 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a)
[0m14:52:35.005606 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_bronze, now test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248)
[0m14:52:35.005940 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airflow_gold, now test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75)
[0m14:52:35.006426 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e'
[0m14:52:35.006769 [debug] [Thread-1 (]: Began compiling node test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a
[0m14:52:35.007106 [debug] [Thread-2 (]: Began compiling node test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248
[0m14:52:35.007409 [debug] [Thread-3 (]: Began compiling node test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75
[0m14:52:35.007720 [debug] [Thread-4 (]: Began compiling node test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e
[0m14:52:35.017568 [debug] [Thread-1 (]: Writing injected SQL for node "test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a"
[0m14:52:35.021291 [debug] [Thread-2 (]: Writing injected SQL for node "test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248"
[0m14:52:35.025397 [debug] [Thread-3 (]: Writing injected SQL for node "test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75"
[0m14:52:35.028580 [debug] [Thread-4 (]: Writing injected SQL for node "test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e"
[0m14:52:35.033573 [debug] [Thread-1 (]: Began executing node test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a
[0m14:52:35.034463 [debug] [Thread-2 (]: Began executing node test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248
[0m14:52:35.041559 [debug] [Thread-3 (]: Began executing node test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75
[0m14:52:35.045413 [debug] [Thread-1 (]: Writing runtime sql for node "test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a"
[0m14:52:35.045995 [debug] [Thread-4 (]: Began executing node test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e
[0m14:52:35.047479 [debug] [Thread-2 (]: Writing runtime sql for node "test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248"
[0m14:52:35.049067 [debug] [Thread-3 (]: Writing runtime sql for node "test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75"
[0m14:52:35.051818 [debug] [Thread-4 (]: Writing runtime sql for node "test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e"
[0m14:52:35.055062 [debug] [Thread-1 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a"
[0m14:52:35.055654 [debug] [Thread-2 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248"
[0m14:52:35.055928 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a: BEGIN
[0m14:52:35.056209 [debug] [Thread-4 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e"
[0m14:52:35.056504 [debug] [Thread-3 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75"
[0m14:52:35.056732 [debug] [Thread-2 (]: On test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248: BEGIN
[0m14:52:35.057156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:35.057608 [debug] [Thread-4 (]: On test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e: BEGIN
[0m14:52:35.058063 [debug] [Thread-3 (]: On test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75: BEGIN
[0m14:52:35.058494 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:52:35.059114 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:52:35.059550 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:52:35.061508 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:52:35.061997 [debug] [Thread-1 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a"
[0m14:52:35.062235 [debug] [Thread-2 (]: SQL status: BEGIN in 0.004 seconds
[0m14:52:35.062591 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        age_band as value_field,
        count(*) as n_records

    from "airflow"."gold"."customer_360"
    group by age_band

)

select *
from all_values
where value_field not in (
    'Under 25','25-34','35-44','45-54','55-64','65+','Unknown'
)



  
  
      
    ) dbt_internal_test
[0m14:52:35.062843 [debug] [Thread-4 (]: SQL status: BEGIN in 0.004 seconds
[0m14:52:35.063071 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m14:52:35.063293 [debug] [Thread-2 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248"
[0m14:52:35.063821 [debug] [Thread-4 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e"
[0m14:52:35.064144 [debug] [Thread-3 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75"
[0m14:52:35.064506 [debug] [Thread-2 (]: On test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        churn_status as value_field,
        count(*) as n_records

    from "airflow"."gold"."customer_360"
    group by churn_status

)

select *
from all_values
where value_field not in (
    'Churned','Active','Unknown'
)



  
  
      
    ) dbt_internal_test
[0m14:52:35.064817 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:52:35.065126 [debug] [Thread-4 (]: On test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        tech_support_label as value_field,
        count(*) as n_records

    from "airflow"."gold"."customer_360"
    group by tech_support_label

)

select *
from all_values
where value_field not in (
    'Yes','No','Unknown'
)



  
  
      
    ) dbt_internal_test
[0m14:52:35.065479 [debug] [Thread-3 (]: On test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        revenue_bucket as value_field,
        count(*) as n_records

    from "airflow"."gold"."customer_360"
    group by revenue_bucket

)

select *
from all_values
where value_field not in (
    'High','Medium','Low'
)



  
  
      
    ) dbt_internal_test
[0m14:52:35.068134 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a: ROLLBACK
[0m14:52:35.068433 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:52:35.069088 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a: Close
[0m14:52:35.069971 [debug] [Thread-2 (]: On test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248: ROLLBACK
[0m14:52:35.070258 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:52:35.070485 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:52:35.070961 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown  [[32mPASS[0m in 0.07s]
[0m14:52:35.071683 [debug] [Thread-2 (]: On test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248: Close
[0m14:52:35.072500 [debug] [Thread-4 (]: On test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e: ROLLBACK
[0m14:52:35.073363 [debug] [Thread-3 (]: On test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75: ROLLBACK
[0m14:52:35.073830 [debug] [Thread-1 (]: Finished running node test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a
[0m14:52:35.074332 [info ] [Thread-2 (]: 2 of 7 PASS accepted_values_customer_360_churn_status__Churned__Active__Unknown  [[32mPASS[0m in 0.07s]
[0m14:52:35.075747 [debug] [Thread-4 (]: On test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e: Close
[0m14:52:35.076072 [debug] [Thread-3 (]: On test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75: Close
[0m14:52:35.076342 [debug] [Thread-1 (]: Began running node test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1
[0m14:52:35.076854 [debug] [Thread-2 (]: Finished running node test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248
[0m14:52:35.077347 [info ] [Thread-4 (]: 4 of 7 PASS accepted_values_customer_360_tech_support_label__Yes__No__Unknown .. [[32mPASS[0m in 0.07s]
[0m14:52:35.078014 [info ] [Thread-3 (]: 3 of 7 PASS accepted_values_customer_360_revenue_bucket__High__Medium__Low ..... [[32mPASS[0m in 0.07s]
[0m14:52:35.078451 [info ] [Thread-1 (]: 5 of 7 START test accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_  [RUN]
[0m14:52:35.078961 [debug] [Thread-2 (]: Began running node test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b
[0m14:52:35.079431 [debug] [Thread-4 (]: Finished running node test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e
[0m14:52:35.079866 [debug] [Thread-3 (]: Finished running node test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75
[0m14:52:35.080249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a, now test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1)
[0m14:52:35.080662 [info ] [Thread-2 (]: 6 of 7 START test not_null_customer_360_customer_hash .......................... [RUN]
[0m14:52:35.081162 [debug] [Thread-4 (]: Began running node test.elt_assignment.unique_customer_360_customer_hash.14c41e246e
[0m14:52:35.081689 [debug] [Thread-1 (]: Began compiling node test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1
[0m14:52:35.082033 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248, now test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b)
[0m14:52:35.082367 [info ] [Thread-4 (]: 7 of 7 START test unique_customer_360_customer_hash ............................ [RUN]
[0m14:52:35.086368 [debug] [Thread-1 (]: Writing injected SQL for node "test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1"
[0m14:52:35.086797 [debug] [Thread-2 (]: Began compiling node test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b
[0m14:52:35.087175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e, now test.elt_assignment.unique_customer_360_customer_hash.14c41e246e)
[0m14:52:35.091004 [debug] [Thread-2 (]: Writing injected SQL for node "test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b"
[0m14:52:35.091496 [debug] [Thread-4 (]: Began compiling node test.elt_assignment.unique_customer_360_customer_hash.14c41e246e
[0m14:52:35.091915 [debug] [Thread-1 (]: Began executing node test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1
[0m14:52:35.095119 [debug] [Thread-4 (]: Writing injected SQL for node "test.elt_assignment.unique_customer_360_customer_hash.14c41e246e"
[0m14:52:35.096612 [debug] [Thread-1 (]: Writing runtime sql for node "test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1"
[0m14:52:35.097094 [debug] [Thread-2 (]: Began executing node test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b
[0m14:52:35.100123 [debug] [Thread-2 (]: Writing runtime sql for node "test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b"
[0m14:52:35.100790 [debug] [Thread-4 (]: Began executing node test.elt_assignment.unique_customer_360_customer_hash.14c41e246e
[0m14:52:35.101482 [debug] [Thread-1 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1"
[0m14:52:35.102866 [debug] [Thread-4 (]: Writing runtime sql for node "test.elt_assignment.unique_customer_360_customer_hash.14c41e246e"
[0m14:52:35.103358 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1: BEGIN
[0m14:52:35.103789 [debug] [Thread-2 (]: Using postgres connection "test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b"
[0m14:52:35.104216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:35.105768 [debug] [Thread-2 (]: On test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b: BEGIN
[0m14:52:35.106338 [debug] [Thread-4 (]: Using postgres connection "test.elt_assignment.unique_customer_360_customer_hash.14c41e246e"
[0m14:52:35.106734 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:52:35.107108 [debug] [Thread-4 (]: On test.elt_assignment.unique_customer_360_customer_hash.14c41e246e: BEGIN
[0m14:52:35.107715 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:52:35.108583 [debug] [Thread-1 (]: SQL status: BEGIN in 0.004 seconds
[0m14:52:35.108966 [debug] [Thread-1 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1"
[0m14:52:35.109444 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        tenure_band as value_field,
        count(*) as n_records

    from "airflow"."gold"."customer_360"
    group by tenure_band

)

select *
from all_values
where value_field not in (
    'New ( <3m )','4-12m','12-24m','24-36m','36m+'
)



  
  
      
    ) dbt_internal_test
[0m14:52:35.109745 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m14:52:35.110186 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m14:52:35.110471 [debug] [Thread-2 (]: Using postgres connection "test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b"
[0m14:52:35.110858 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:52:35.111116 [debug] [Thread-4 (]: Using postgres connection "test.elt_assignment.unique_customer_360_customer_hash.14c41e246e"
[0m14:52:35.111645 [debug] [Thread-2 (]: On test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_hash
from "airflow"."gold"."customer_360"
where customer_hash is null



  
  
      
    ) dbt_internal_test
[0m14:52:35.112749 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1: ROLLBACK
[0m14:52:35.113103 [debug] [Thread-4 (]: On test.elt_assignment.unique_customer_360_customer_hash.14c41e246e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.unique_customer_360_customer_hash.14c41e246e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_hash as unique_field,
    count(*) as n_records

from "airflow"."gold"."customer_360"
where customer_hash is not null
group by customer_hash
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:52:35.113711 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1: Close
[0m14:52:35.114002 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:52:35.114470 [info ] [Thread-1 (]: 5 of 7 PASS accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_  [[32mPASS[0m in 0.03s]
[0m14:52:35.114850 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:52:35.115700 [debug] [Thread-2 (]: On test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b: ROLLBACK
[0m14:52:35.116176 [debug] [Thread-1 (]: Finished running node test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1
[0m14:52:35.117033 [debug] [Thread-4 (]: On test.elt_assignment.unique_customer_360_customer_hash.14c41e246e: ROLLBACK
[0m14:52:35.117440 [debug] [Thread-2 (]: On test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b: Close
[0m14:52:35.117943 [debug] [Thread-4 (]: On test.elt_assignment.unique_customer_360_customer_hash.14c41e246e: Close
[0m14:52:35.118287 [info ] [Thread-2 (]: 6 of 7 PASS not_null_customer_360_customer_hash ................................ [[32mPASS[0m in 0.04s]
[0m14:52:35.118823 [info ] [Thread-4 (]: 7 of 7 PASS unique_customer_360_customer_hash .................................. [[32mPASS[0m in 0.03s]
[0m14:52:35.119304 [debug] [Thread-2 (]: Finished running node test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b
[0m14:52:35.119684 [debug] [Thread-4 (]: Finished running node test.elt_assignment.unique_customer_360_customer_hash.14c41e246e
[0m14:52:35.121002 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:35.121403 [debug] [MainThread]: On master: BEGIN
[0m14:52:35.121714 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:35.124130 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:52:35.124499 [debug] [MainThread]: On master: COMMIT
[0m14:52:35.124792 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:35.125068 [debug] [MainThread]: On master: COMMIT
[0m14:52:35.125421 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:52:35.125688 [debug] [MainThread]: On master: Close
[0m14:52:35.126031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:35.126889 [debug] [MainThread]: Connection 'test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1' was properly closed.
[0m14:52:35.127197 [debug] [MainThread]: Connection 'test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b' was properly closed.
[0m14:52:35.127452 [debug] [MainThread]: Connection 'test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75' was properly closed.
[0m14:52:35.127747 [debug] [MainThread]: Connection 'test.elt_assignment.unique_customer_360_customer_hash.14c41e246e' was properly closed.
[0m14:52:35.128040 [info ] [MainThread]: 
[0m14:52:35.128549 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m14:52:35.129525 [debug] [MainThread]: Command end result
[0m14:52:35.152174 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m14:52:35.154282 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m14:52:35.160337 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m14:52:35.160651 [info ] [MainThread]: 
[0m14:52:35.161197 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:35.161601 [info ] [MainThread]: 
[0m14:52:35.161981 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:52:35.162863 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.63341516, "process_in_blocks": "0", "process_kernel_time": 0.123892, "process_mem_max_rss": "126672", "process_out_blocks": "2369", "process_user_time": 1.570634}
[0m14:52:35.163298 [debug] [MainThread]: Command `dbt test` succeeded at 14:52:35.163219 after 0.63 seconds
[0m14:52:35.163672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8b0fca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8a1edc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff88b7eb70>]}
[0m14:52:35.164026 [debug] [MainThread]: Flushing usage events
[0m14:52:36.669796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:03:55.648382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dfd9310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8dda1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8cc958b0>]}


============================== 15:03:55.653349 | 704f0a1d-4d15-4405-9097-94429d7d7a9c ==============================
[0m15:03:55.653349 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:03:55.654504 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'printer_width': '80', 'invocation_command': 'dbt deps', 'indirect_selection': 'eager', 'log_format': 'default', 'profiles_dir': '/opt/airflow/dbt', 'debug': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'static_parser': 'True', 'use_colors': 'True', 'empty': 'None', 'log_path': '/opt/airflow/dbt/logs', 'write_json': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'fail_fast': 'False'}
[0m15:03:55.755217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '704f0a1d-4d15-4405-9097-94429d7d7a9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c9f76b0>]}
[0m15:03:55.954853 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-39992qj3'
[0m15:03:55.955414 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:03:57.842662 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:03:57.845007 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:03:58.093352 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:03:58.101223 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:04:00.146942 [info ] [MainThread]: Installed from version 1.3.0
[0m15:04:00.147720 [info ] [MainThread]: Up to date!
[0m15:04:00.148367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '704f0a1d-4d15-4405-9097-94429d7d7a9c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8bdeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8c8bf050>]}
[0m15:04:00.149697 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 4.546175, "process_in_blocks": "552", "process_kernel_time": 0.665742, "process_mem_max_rss": "105836", "process_out_blocks": "733", "process_user_time": 1.462829}
[0m15:04:00.150182 [debug] [MainThread]: Command `dbt deps` succeeded at 15:04:00.150103 after 4.55 seconds
[0m15:04:00.150527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8db50980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8ca920c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff8caf9550>]}
[0m15:04:00.150844 [debug] [MainThread]: Flushing usage events
[0m15:04:01.719347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:04.032254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff95cd63c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94f658b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9611cbf0>]}


============================== 15:04:04.036900 | 105af346-f4e7-4d34-a715-3bf685bc3c23 ==============================
[0m15:04:04.036900 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:04:04.038005 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'write_json': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'empty': 'False', 'printer_width': '80', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'no_print': 'None', 'introspect': 'True', 'log_format': 'default', 'log_path': 'logs', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'profiles_dir': '/opt/airflow/dbt', 'warn_error': 'None', 'invocation_command': 'dbt run --project-dir . --profiles-dir /opt/airflow/dbt', 'log_cache_events': 'False', 'debug': 'False', 'target_path': 'None', 'indirect_selection': 'eager'}
[0m15:04:04.151263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '105af346-f4e7-4d34-a715-3bf685bc3c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff970f0500>]}
[0m15:04:04.182890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '105af346-f4e7-4d34-a715-3bf685bc3c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff94ba9940>]}
[0m15:04:04.183624 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:04:04.236695 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:04:04.364464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:04.365238 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:04.389655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '105af346-f4e7-4d34-a715-3bf685bc3c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93d08f20>]}
[0m15:04:04.445066 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m15:04:04.447849 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m15:04:04.465082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '105af346-f4e7-4d34-a715-3bf685bc3c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff938aaa80>]}
[0m15:04:04.465638 [info ] [MainThread]: Found 3 models, 7 data tests, 1 source, 550 macros
[0m15:04:04.466419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '105af346-f4e7-4d34-a715-3bf685bc3c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93b6cc20>]}
[0m15:04:04.467796 [info ] [MainThread]: 
[0m15:04:04.468316 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:04:04.468819 [info ] [MainThread]: 
[0m15:04:04.469377 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:04:04.472334 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:04:04.472915 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:04:04.481861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m15:04:04.506194 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:04:04.506489 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:04:04.506690 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m15:04:04.506993 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:04:04.507313 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:04:04.507602 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m15:04:04.507901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:04.508211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:04.508489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:04.516948 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m15:04:04.517263 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m15:04:04.517460 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.009 seconds
[0m15:04:04.518460 [debug] [ThreadPool]: On list_airflow: Close
[0m15:04:04.519229 [debug] [ThreadPool]: On list_airflow: Close
[0m15:04:04.520087 [debug] [ThreadPool]: On list_airflow: Close
[0m15:04:04.522358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_silver)
[0m15:04:04.522871 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_bronze)
[0m15:04:04.526672 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m15:04:04.526964 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_airflow, now list_airflow_gold)
[0m15:04:04.528577 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m15:04:04.529014 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m15:04:04.530296 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m15:04:04.530701 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m15:04:04.531386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:04.532155 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m15:04:04.532717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:04.533580 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:04:04.537161 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:04:04.537486 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:04:04.537907 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m15:04:04.538251 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m15:04:04.538552 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m15:04:04.538875 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:04:04.539161 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m15:04:04.539702 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m15:04:04.540589 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:04:04.545298 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.004 seconds
[0m15:04:04.546677 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m15:04:04.547017 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m15:04:04.547230 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m15:04:04.548079 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m15:04:04.548263 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m15:04:04.548976 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m15:04:04.549405 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m15:04:04.550511 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m15:04:04.554179 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:04.554612 [debug] [MainThread]: On master: BEGIN
[0m15:04:04.554942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:04.558139 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:04:04.558517 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:04.558787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:04:04.561018 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m15:04:04.561892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '105af346-f4e7-4d34-a715-3bf685bc3c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff93a242f0>]}
[0m15:04:04.562342 [debug] [MainThread]: On master: ROLLBACK
[0m15:04:04.562687 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:04.563112 [debug] [MainThread]: On master: BEGIN
[0m15:04:04.563741 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:04:04.564179 [debug] [MainThread]: On master: COMMIT
[0m15:04:04.564471 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:04.564769 [debug] [MainThread]: On master: COMMIT
[0m15:04:04.565156 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:04:04.565541 [debug] [MainThread]: On master: Close
[0m15:04:04.572825 [debug] [Thread-1 (]: Began running node model.elt_assignment.customer_360
[0m15:04:04.573199 [debug] [Thread-2 (]: Began running node model.elt_assignment.customers_clean
[0m15:04:04.573450 [debug] [Thread-3 (]: Began running node model.elt_assignment.customers_raw
[0m15:04:04.574733 [info ] [Thread-1 (]: 1 of 3 START sql table model gold.customer_360 ................................. [RUN]
[0m15:04:04.575788 [info ] [Thread-2 (]: 2 of 3 START sql table model silver.customers_clean ............................ [RUN]
[0m15:04:04.577479 [info ] [Thread-3 (]: 3 of 3 START sql table model bronze.customers_raw .............................. [RUN]
[0m15:04:04.585402 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airflow_bronze, now model.elt_assignment.customers_raw)
[0m15:04:04.584315 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_gold, now model.elt_assignment.customers_clean)
[0m15:04:04.582446 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now model.elt_assignment.customer_360)
[0m15:04:04.587184 [debug] [Thread-3 (]: Began compiling node model.elt_assignment.customers_raw
[0m15:04:04.587695 [debug] [Thread-2 (]: Began compiling node model.elt_assignment.customers_clean
[0m15:04:04.614276 [debug] [Thread-2 (]: Writing injected SQL for node "model.elt_assignment.customers_clean"
[0m15:04:04.604447 [debug] [Thread-3 (]: Writing injected SQL for node "model.elt_assignment.customers_raw"
[0m15:04:04.588221 [debug] [Thread-1 (]: Began compiling node model.elt_assignment.customer_360
[0m15:04:04.621547 [debug] [Thread-1 (]: Writing injected SQL for node "model.elt_assignment.customer_360"
[0m15:04:04.622836 [debug] [Thread-2 (]: Began executing node model.elt_assignment.customers_clean
[0m15:04:04.635650 [debug] [Thread-3 (]: Began executing node model.elt_assignment.customers_raw
[0m15:04:04.658352 [debug] [Thread-2 (]: Writing runtime sql for node "model.elt_assignment.customers_clean"
[0m15:04:04.658690 [debug] [Thread-1 (]: Began executing node model.elt_assignment.customer_360
[0m15:04:04.660579 [debug] [Thread-3 (]: Writing runtime sql for node "model.elt_assignment.customers_raw"
[0m15:04:04.662636 [debug] [Thread-1 (]: Writing runtime sql for node "model.elt_assignment.customer_360"
[0m15:04:04.667317 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m15:04:04.670838 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: BEGIN
[0m15:04:04.672753 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m15:04:04.679381 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: BEGIN
[0m15:04:04.674780 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m15:04:04.673639 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:04.680442 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:04.681431 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: BEGIN
[0m15:04:04.684723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:04.689638 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m15:04:04.690948 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m15:04:04.691356 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m15:04:04.692472 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m15:04:04.693312 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */

  
    

  create  table "airflow"."bronze"."customers_raw__dbt_tmp"
  
  
    as
  
  (
    -- Reference table created directly by Airflow/SQL COPY
-- dbt will just treat this as a source, not transform
select * from bronze.customers_raw
  );
  
[0m15:04:04.693677 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:04:04.694405 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */

  
    

  create  table "airflow"."silver"."customers_clean__dbt_tmp"
  
  
    as
  
  (
    WITH b AS (
  SELECT
    customerid,
    age,
    gender,
    tenure,
    monthlycharges,
    contracttype,
    internetservice,
    totalcharges,
    techsupport,
    churn
  FROM bronze.customers_raw
)
SELECT
  md5((customerid)::text) AS customer_hash,
  COALESCE(NULLIF(LOWER(gender), ''), 'unknown')   AS gender,
  COALESCE((age)::int, 0)                          AS age,
  GREATEST(COALESCE((tenure)::int, 0), 0)          AS tenure_months,
  COALESCE((monthlycharges)::numeric(10,2), 0.00)  AS monthly_charges,
  COALESCE(NULLIF(contracttype, ''), 'Unknown')    AS contract_type,
  COALESCE(NULLIF(internetservice, ''), 'Unknown') AS internet_service,
  COALESCE((totalcharges)::numeric(12,2), 0.00)    AS total_charges,
  CASE 
    WHEN LOWER(COALESCE(techsupport, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(techsupport, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS has_tech_support,
  CASE 
    WHEN LOWER(COALESCE(churn, '')) = 'yes' THEN TRUE
    WHEN LOWER(COALESCE(churn, '')) = 'no'  THEN FALSE
    ELSE NULL
  END                                                AS is_churned,
  CURRENT_TIMESTAMP                                  AS _loaded_at
FROM b
  );
  
[0m15:04:04.697013 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m15:04:04.700826 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */

  
    

  create  table "airflow"."gold"."customer_360__dbt_tmp"
  
  
    as
  
  (
    

SELECT
  cc.customer_hash,
  cc.age,
  cc.gender,
  CASE
    WHEN cc.age < 25 THEN 'Under 25'
    WHEN cc.age BETWEEN 25 AND 34 THEN '25-34'
    WHEN cc.age BETWEEN 35 AND 44 THEN '35-44'
    WHEN cc.age BETWEEN 45 AND 54 THEN '45-54'
    WHEN cc.age BETWEEN 55 AND 64 THEN '55-64'
    WHEN cc.age >= 65 THEN '65+'
    ELSE 'Unknown'
  END AS age_band,
  cc.tenure_months,
  CASE
    WHEN cc.tenure_months < 3     THEN 'New ( <3m )'
    WHEN cc.tenure_months < 12    THEN '4-12m'      -- NOTE: 3-month edge is excluded by design here
    WHEN cc.tenure_months < 24    THEN '12-24m'
    WHEN cc.tenure_months < 36    THEN '24-36m'
    ELSE '36m+'
  END AS tenure_band,
  cc.monthly_charges,
  cc.total_charges,
  cc.contract_type,
  cc.internet_service,
  cc.has_tech_support,
  CASE
    WHEN cc.has_tech_support IS TRUE  THEN 'Yes'
    WHEN cc.has_tech_support IS FALSE THEN 'No'
    ELSE 'Unknown'
  END AS tech_support_label,
  cc.is_churned,
  CASE
    WHEN cc.is_churned IS TRUE  THEN 'Churned'
    WHEN cc.is_churned IS FALSE THEN 'Active'
    ELSE 'Unknown'
  END AS churn_status,
  cc.monthly_charges AS arpu,
  (cc.monthly_charges * GREATEST(cc.tenure_months, 0))::NUMERIC(12,2) AS ltv_estimate,
  CASE
    WHEN cc.monthly_charges >= 100 THEN 'High'
    WHEN cc.monthly_charges >= 60  THEN 'Medium'
    ELSE 'Low'
  END AS revenue_bucket,
  cc._loaded_at
FROM "silver"."customers_clean" AS cc
  );
  
[0m15:04:04.710587 [debug] [Thread-3 (]: SQL status: SELECT 1000 in 0.015 seconds
[0m15:04:04.722424 [debug] [Thread-2 (]: SQL status: SELECT 1000 in 0.024 seconds
[0m15:04:04.724485 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m15:04:04.724802 [debug] [Thread-1 (]: SQL status: SELECT 1000 in 0.023 seconds
[0m15:04:04.728255 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m15:04:04.730674 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw" rename to "customers_raw__dbt_backup"
[0m15:04:04.737214 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m15:04:04.739412 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean" rename to "customers_clean__dbt_backup"
[0m15:04:04.742117 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
alter table "airflow"."gold"."customer_360" rename to "customer_360__dbt_backup"
[0m15:04:04.744561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:04:04.748348 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m15:04:04.752526 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
alter table "airflow"."gold"."customer_360__dbt_tmp" rename to "customer_360"
[0m15:04:04.754617 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:04:04.771804 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: COMMIT
[0m15:04:04.772818 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m15:04:04.774062 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: COMMIT
[0m15:04:04.777376 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:04:04.777853 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.034 seconds
[0m15:04:04.783897 [debug] [Thread-1 (]: Applying DROP to: "airflow"."gold"."customer_360__dbt_backup"
[0m15:04:04.788114 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m15:04:04.791878 [debug] [Thread-1 (]: Using postgres connection "model.elt_assignment.customer_360"
[0m15:04:04.792458 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
alter table "airflow"."silver"."customers_clean__dbt_tmp" rename to "customers_clean"
[0m15:04:04.792864 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customer_360"} */
drop table if exists "airflow"."gold"."customer_360__dbt_backup" cascade
[0m15:04:04.793629 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:04:04.794751 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m15:04:04.795244 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m15:04:04.795593 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: COMMIT
[0m15:04:04.798563 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:04:04.798946 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.058 seconds
[0m15:04:04.800899 [debug] [Thread-2 (]: Applying DROP to: "airflow"."silver"."customers_clean__dbt_backup"
[0m15:04:04.801278 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:04:04.803402 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m15:04:04.803941 [debug] [Thread-2 (]: Using postgres connection "model.elt_assignment.customers_clean"
[0m15:04:04.805839 [debug] [Thread-1 (]: On model.elt_assignment.customer_360: Close
[0m15:04:04.806291 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
alter table "airflow"."bronze"."customers_raw__dbt_tmp" rename to "customers_raw"
[0m15:04:04.806639 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_clean"} */
drop table if exists "airflow"."silver"."customers_clean__dbt_backup" cascade
[0m15:04:04.808374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '105af346-f4e7-4d34-a715-3bf685bc3c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975311c0>]}
[0m15:04:04.808818 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:04:04.811229 [info ] [Thread-1 (]: 1 of 3 OK created sql table model gold.customer_360 ............................ [[32mSELECT 1000[0m in 0.22s]
[0m15:04:04.811803 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:04:04.812747 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m15:04:04.813332 [debug] [Thread-1 (]: Finished running node model.elt_assignment.customer_360
[0m15:04:04.814331 [debug] [Thread-2 (]: On model.elt_assignment.customers_clean: Close
[0m15:04:04.814793 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m15:04:04.815859 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '105af346-f4e7-4d34-a715-3bf685bc3c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91a92330>]}
[0m15:04:04.817925 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: COMMIT
[0m15:04:04.818652 [info ] [Thread-2 (]: 2 of 3 OK created sql table model silver.customers_clean ....................... [[32mSELECT 1000[0m in 0.23s]
[0m15:04:04.819712 [debug] [Thread-2 (]: Finished running node model.elt_assignment.customers_clean
[0m15:04:04.820017 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m15:04:04.822039 [debug] [Thread-3 (]: Applying DROP to: "airflow"."bronze"."customers_raw__dbt_backup"
[0m15:04:04.822610 [debug] [Thread-3 (]: Using postgres connection "model.elt_assignment.customers_raw"
[0m15:04:04.822929 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "model.elt_assignment.customers_raw"} */
drop table if exists "airflow"."bronze"."customers_raw__dbt_backup" cascade
[0m15:04:04.824961 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m15:04:04.825870 [debug] [Thread-3 (]: On model.elt_assignment.customers_raw: Close
[0m15:04:04.826505 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '105af346-f4e7-4d34-a715-3bf685bc3c23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff91b7d640>]}
[0m15:04:04.827177 [info ] [Thread-3 (]: 3 of 3 OK created sql table model bronze.customers_raw ......................... [[32mSELECT 1000[0m in 0.24s]
[0m15:04:04.827859 [debug] [Thread-3 (]: Finished running node model.elt_assignment.customers_raw
[0m15:04:04.829242 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:04.829567 [debug] [MainThread]: On master: BEGIN
[0m15:04:04.829842 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:04.833559 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m15:04:04.834001 [debug] [MainThread]: On master: COMMIT
[0m15:04:04.834358 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:04.834627 [debug] [MainThread]: On master: COMMIT
[0m15:04:04.834965 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:04:04.835243 [debug] [MainThread]: On master: Close
[0m15:04:04.835622 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:04.835986 [debug] [MainThread]: Connection 'model.elt_assignment.customers_raw' was properly closed.
[0m15:04:04.836326 [debug] [MainThread]: Connection 'model.elt_assignment.customer_360' was properly closed.
[0m15:04:04.836622 [debug] [MainThread]: Connection 'model.elt_assignment.customers_clean' was properly closed.
[0m15:04:04.837018 [info ] [MainThread]: 
[0m15:04:04.837654 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m15:04:04.838421 [debug] [MainThread]: Command end result
[0m15:04:04.863363 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m15:04:04.865753 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m15:04:04.870374 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m15:04:04.870687 [info ] [MainThread]: 
[0m15:04:04.871312 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:04.871688 [info ] [MainThread]: 
[0m15:04:04.872019 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:04:04.872978 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.87453836, "process_in_blocks": "8", "process_kernel_time": 0.371931, "process_mem_max_rss": "125804", "process_out_blocks": "2356", "process_user_time": 1.754108}
[0m15:04:04.873449 [debug] [MainThread]: Command `dbt run` succeeded at 15:04:04.873389 after 0.88 seconds
[0m15:04:04.873782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff96cba930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff975311c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff949a7920>]}
[0m15:04:04.874093 [debug] [MainThread]: Flushing usage events
[0m15:04:06.656779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:04:08.920795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d487020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9f47d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9d207440>]}


============================== 15:04:08.925333 | 0a0fc370-3ee4-4dd7-95d8-040e53550f8f ==============================
[0m15:04:08.925333 [info ] [MainThread]: Running with dbt=1.10.11
[0m15:04:08.926072 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'write_json': 'True', 'no_print': 'None', 'profiles_dir': '/opt/airflow/dbt', 'cache_selected_only': 'False', 'printer_width': '80', 'target_path': 'None', 'log_format': 'default', 'quiet': 'False', 'version_check': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'use_colors': 'True', 'debug': 'False', 'empty': 'None', 'log_path': 'logs', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt test --project-dir . --profiles-dir /opt/airflow/dbt'}
[0m15:04:09.021283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a0fc370-3ee4-4dd7-95d8-040e53550f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9ed48530>]}
[0m15:04:09.051621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a0fc370-3ee4-4dd7-95d8-040e53550f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9bab70b0>]}
[0m15:04:09.052196 [info ] [MainThread]: Registered adapter: postgres=1.8.2
[0m15:04:09.097717 [debug] [MainThread]: checksum: 5335e1629744fab92fa7809c625edbb36f0d7063a879d6215c971798f27e66f9, vars: {}, profile: , target: , version: 1.10.11
[0m15:04:09.209290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:04:09.209695 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:04:09.234041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a0fc370-3ee4-4dd7-95d8-040e53550f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c4cfce0>]}
[0m15:04:09.288803 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m15:04:09.291168 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m15:04:09.314075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a0fc370-3ee4-4dd7-95d8-040e53550f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b9a7080>]}
[0m15:04:09.314527 [info ] [MainThread]: Found 3 models, 7 data tests, 1 source, 550 macros
[0m15:04:09.315081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a0fc370-3ee4-4dd7-95d8-040e53550f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b401340>]}
[0m15:04:09.316240 [info ] [MainThread]: 
[0m15:04:09.316639 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:04:09.316903 [info ] [MainThread]: 
[0m15:04:09.317307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:04:09.318104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_gold'
[0m15:04:09.318569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_bronze'
[0m15:04:09.325748 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow_silver'
[0m15:04:09.341755 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m15:04:09.342127 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m15:04:09.342352 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m15:04:09.342678 [debug] [ThreadPool]: On list_airflow_gold: BEGIN
[0m15:04:09.342991 [debug] [ThreadPool]: On list_airflow_bronze: BEGIN
[0m15:04:09.343299 [debug] [ThreadPool]: On list_airflow_silver: BEGIN
[0m15:04:09.343601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:09.343875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:09.344174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:04:09.348257 [debug] [ThreadPool]: SQL status: BEGIN in 0.004 seconds
[0m15:04:09.348787 [debug] [ThreadPool]: Using postgres connection "list_airflow_bronze"
[0m15:04:09.349254 [debug] [ThreadPool]: On list_airflow_bronze: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_bronze"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'bronze'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'bronze'
  
[0m15:04:09.349812 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:04:09.350048 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:04:09.350325 [debug] [ThreadPool]: Using postgres connection "list_airflow_gold"
[0m15:04:09.350606 [debug] [ThreadPool]: Using postgres connection "list_airflow_silver"
[0m15:04:09.350903 [debug] [ThreadPool]: On list_airflow_gold: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_gold"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'gold'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'gold'
  
[0m15:04:09.351260 [debug] [ThreadPool]: On list_airflow_silver: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "list_airflow_silver"} */
select
      'airflow' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'silver'
    union all
    select
      'airflow' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'silver'
  
[0m15:04:09.351475 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:04:09.352763 [debug] [ThreadPool]: On list_airflow_bronze: ROLLBACK
[0m15:04:09.353169 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.001 seconds
[0m15:04:09.353355 [debug] [ThreadPool]: On list_airflow_bronze: Close
[0m15:04:09.354083 [debug] [ThreadPool]: On list_airflow_gold: ROLLBACK
[0m15:04:09.354293 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.002 seconds
[0m15:04:09.355914 [debug] [ThreadPool]: On list_airflow_gold: Close
[0m15:04:09.356889 [debug] [ThreadPool]: On list_airflow_silver: ROLLBACK
[0m15:04:09.357647 [debug] [ThreadPool]: On list_airflow_silver: Close
[0m15:04:09.361437 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:09.361824 [debug] [MainThread]: On master: BEGIN
[0m15:04:09.362120 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:04:09.365507 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:04:09.365922 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:09.366297 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:04:09.368760 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m15:04:09.369744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a0fc370-3ee4-4dd7-95d8-040e53550f8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9b454800>]}
[0m15:04:09.370186 [debug] [MainThread]: On master: ROLLBACK
[0m15:04:09.370577 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:09.370873 [debug] [MainThread]: On master: BEGIN
[0m15:04:09.371312 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:04:09.371631 [debug] [MainThread]: On master: COMMIT
[0m15:04:09.371911 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:09.372215 [debug] [MainThread]: On master: COMMIT
[0m15:04:09.372537 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:04:09.372793 [debug] [MainThread]: On master: Close
[0m15:04:09.375997 [debug] [Thread-1 (]: Began running node test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a
[0m15:04:09.376334 [debug] [Thread-2 (]: Began running node test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248
[0m15:04:09.376596 [debug] [Thread-3 (]: Began running node test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75
[0m15:04:09.376881 [debug] [Thread-4 (]: Began running node test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e
[0m15:04:09.377137 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown  [RUN]
[0m15:04:09.377775 [info ] [Thread-2 (]: 2 of 7 START test accepted_values_customer_360_churn_status__Churned__Active__Unknown  [RUN]
[0m15:04:09.378207 [info ] [Thread-3 (]: 3 of 7 START test accepted_values_customer_360_revenue_bucket__High__Medium__Low  [RUN]
[0m15:04:09.378695 [info ] [Thread-4 (]: 4 of 7 START test accepted_values_customer_360_tech_support_label__Yes__No__Unknown  [RUN]
[0m15:04:09.379193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_airflow_silver, now test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a)
[0m15:04:09.379562 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_airflow_gold, now test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248)
[0m15:04:09.379903 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_airflow_bronze, now test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75)
[0m15:04:09.380383 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e'
[0m15:04:09.380701 [debug] [Thread-1 (]: Began compiling node test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a
[0m15:04:09.381008 [debug] [Thread-2 (]: Began compiling node test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248
[0m15:04:09.381367 [debug] [Thread-3 (]: Began compiling node test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75
[0m15:04:09.381736 [debug] [Thread-4 (]: Began compiling node test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e
[0m15:04:09.394641 [debug] [Thread-1 (]: Writing injected SQL for node "test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a"
[0m15:04:09.397677 [debug] [Thread-2 (]: Writing injected SQL for node "test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248"
[0m15:04:09.410559 [debug] [Thread-3 (]: Writing injected SQL for node "test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75"
[0m15:04:09.423330 [debug] [Thread-4 (]: Writing injected SQL for node "test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e"
[0m15:04:09.429470 [debug] [Thread-2 (]: Began executing node test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248
[0m15:04:09.431907 [debug] [Thread-1 (]: Began executing node test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a
[0m15:04:09.447957 [debug] [Thread-2 (]: Writing runtime sql for node "test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248"
[0m15:04:09.450251 [debug] [Thread-1 (]: Writing runtime sql for node "test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a"
[0m15:04:09.450690 [debug] [Thread-4 (]: Began executing node test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e
[0m15:04:09.450993 [debug] [Thread-3 (]: Began executing node test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75
[0m15:04:09.454909 [debug] [Thread-4 (]: Writing runtime sql for node "test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e"
[0m15:04:09.457544 [debug] [Thread-3 (]: Writing runtime sql for node "test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75"
[0m15:04:09.458051 [debug] [Thread-1 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a"
[0m15:04:09.458408 [debug] [Thread-2 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248"
[0m15:04:09.460872 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a: BEGIN
[0m15:04:09.461585 [debug] [Thread-4 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e"
[0m15:04:09.461923 [debug] [Thread-2 (]: On test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248: BEGIN
[0m15:04:09.462359 [debug] [Thread-3 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75"
[0m15:04:09.462711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:09.463078 [debug] [Thread-4 (]: On test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e: BEGIN
[0m15:04:09.463394 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:09.463712 [debug] [Thread-3 (]: On test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75: BEGIN
[0m15:04:09.464323 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:04:09.465007 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:09.467303 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:04:09.467988 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m15:04:09.468462 [debug] [Thread-1 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a"
[0m15:04:09.468903 [debug] [Thread-2 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248"
[0m15:04:09.469347 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        age_band as value_field,
        count(*) as n_records

    from "airflow"."gold"."customer_360"
    group by age_band

)

select *
from all_values
where value_field not in (
    'Under 25','25-34','35-44','45-54','55-64','65+','Unknown'
)



  
  
      
    ) dbt_internal_test
[0m15:04:09.469659 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m15:04:09.469984 [debug] [Thread-2 (]: On test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        churn_status as value_field,
        count(*) as n_records

    from "airflow"."gold"."customer_360"
    group by churn_status

)

select *
from all_values
where value_field not in (
    'Churned','Active','Unknown'
)



  
  
      
    ) dbt_internal_test
[0m15:04:09.470236 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m15:04:09.471555 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:04:09.471984 [debug] [Thread-4 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e"
[0m15:04:09.472641 [debug] [Thread-3 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75"
[0m15:04:09.475412 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a: ROLLBACK
[0m15:04:09.475738 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:04:09.476103 [debug] [Thread-4 (]: On test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        tech_support_label as value_field,
        count(*) as n_records

    from "airflow"."gold"."customer_360"
    group by tech_support_label

)

select *
from all_values
where value_field not in (
    'Yes','No','Unknown'
)



  
  
      
    ) dbt_internal_test
[0m15:04:09.476457 [debug] [Thread-3 (]: On test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        revenue_bucket as value_field,
        count(*) as n_records

    from "airflow"."gold"."customer_360"
    group by revenue_bucket

)

select *
from all_values
where value_field not in (
    'High','Medium','Low'
)



  
  
      
    ) dbt_internal_test
[0m15:04:09.476925 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a: Close
[0m15:04:09.477733 [debug] [Thread-2 (]: On test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248: ROLLBACK
[0m15:04:09.478651 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown  [[32mPASS[0m in 0.10s]
[0m15:04:09.478954 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:04:09.479227 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:04:09.479793 [debug] [Thread-2 (]: On test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248: Close
[0m15:04:09.480142 [debug] [Thread-1 (]: Finished running node test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a
[0m15:04:09.481048 [debug] [Thread-3 (]: On test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75: ROLLBACK
[0m15:04:09.481885 [debug] [Thread-4 (]: On test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e: ROLLBACK
[0m15:04:09.482381 [info ] [Thread-2 (]: 2 of 7 PASS accepted_values_customer_360_churn_status__Churned__Active__Unknown  [[32mPASS[0m in 0.10s]
[0m15:04:09.482844 [debug] [Thread-1 (]: Began running node test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1
[0m15:04:09.483301 [debug] [Thread-3 (]: On test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75: Close
[0m15:04:09.483615 [debug] [Thread-4 (]: On test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e: Close
[0m15:04:09.483910 [debug] [Thread-2 (]: Finished running node test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248
[0m15:04:09.484264 [info ] [Thread-1 (]: 5 of 7 START test accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_  [RUN]
[0m15:04:09.484896 [info ] [Thread-3 (]: 3 of 7 PASS accepted_values_customer_360_revenue_bucket__High__Medium__Low ..... [[32mPASS[0m in 0.10s]
[0m15:04:09.485434 [info ] [Thread-4 (]: 4 of 7 PASS accepted_values_customer_360_tech_support_label__Yes__No__Unknown .. [[32mPASS[0m in 0.11s]
[0m15:04:09.485924 [debug] [Thread-2 (]: Began running node test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b
[0m15:04:09.486349 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.elt_assignment.accepted_values_customer_360_age_band__Under_25__25_34__35_44__45_54__55_64__65___Unknown.2e3c29f23a, now test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1)
[0m15:04:09.486778 [debug] [Thread-3 (]: Finished running node test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75
[0m15:04:09.487172 [debug] [Thread-4 (]: Finished running node test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e
[0m15:04:09.487484 [info ] [Thread-2 (]: 6 of 7 START test not_null_customer_360_customer_hash .......................... [RUN]
[0m15:04:09.487921 [debug] [Thread-1 (]: Began compiling node test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1
[0m15:04:09.488278 [debug] [Thread-3 (]: Began running node test.elt_assignment.unique_customer_360_customer_hash.14c41e246e
[0m15:04:09.488758 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.elt_assignment.accepted_values_customer_360_churn_status__Churned__Active__Unknown.f155ba1248, now test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b)
[0m15:04:09.492637 [debug] [Thread-1 (]: Writing injected SQL for node "test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1"
[0m15:04:09.493054 [info ] [Thread-3 (]: 7 of 7 START test unique_customer_360_customer_hash ............................ [RUN]
[0m15:04:09.493536 [debug] [Thread-2 (]: Began compiling node test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b
[0m15:04:09.495117 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.elt_assignment.accepted_values_customer_360_revenue_bucket__High__Medium__Low.52a2bc8a75, now test.elt_assignment.unique_customer_360_customer_hash.14c41e246e)
[0m15:04:09.498814 [debug] [Thread-2 (]: Writing injected SQL for node "test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b"
[0m15:04:09.499270 [debug] [Thread-1 (]: Began executing node test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1
[0m15:04:09.499561 [debug] [Thread-3 (]: Began compiling node test.elt_assignment.unique_customer_360_customer_hash.14c41e246e
[0m15:04:09.502224 [debug] [Thread-1 (]: Writing runtime sql for node "test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1"
[0m15:04:09.505815 [debug] [Thread-3 (]: Writing injected SQL for node "test.elt_assignment.unique_customer_360_customer_hash.14c41e246e"
[0m15:04:09.506099 [debug] [Thread-2 (]: Began executing node test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b
[0m15:04:09.509308 [debug] [Thread-2 (]: Writing runtime sql for node "test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b"
[0m15:04:09.509626 [debug] [Thread-1 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1"
[0m15:04:09.510587 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1: BEGIN
[0m15:04:09.510948 [debug] [Thread-3 (]: Began executing node test.elt_assignment.unique_customer_360_customer_hash.14c41e246e
[0m15:04:09.511203 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:04:09.511516 [debug] [Thread-2 (]: Using postgres connection "test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b"
[0m15:04:09.513704 [debug] [Thread-3 (]: Writing runtime sql for node "test.elt_assignment.unique_customer_360_customer_hash.14c41e246e"
[0m15:04:09.514245 [debug] [Thread-2 (]: On test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b: BEGIN
[0m15:04:09.515953 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:04:09.516497 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m15:04:09.516798 [debug] [Thread-3 (]: Using postgres connection "test.elt_assignment.unique_customer_360_customer_hash.14c41e246e"
[0m15:04:09.517194 [debug] [Thread-1 (]: Using postgres connection "test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1"
[0m15:04:09.517533 [debug] [Thread-3 (]: On test.elt_assignment.unique_customer_360_customer_hash.14c41e246e: BEGIN
[0m15:04:09.517879 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        tenure_band as value_field,
        count(*) as n_records

    from "airflow"."gold"."customer_360"
    group by tenure_band

)

select *
from all_values
where value_field not in (
    'New ( <3m )','4-12m','12-24m','24-36m','36m+'
)



  
  
      
    ) dbt_internal_test
[0m15:04:09.518205 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:04:09.518588 [debug] [Thread-2 (]: SQL status: BEGIN in 0.003 seconds
[0m15:04:09.519119 [debug] [Thread-2 (]: Using postgres connection "test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b"
[0m15:04:09.519400 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:04:09.519930 [debug] [Thread-2 (]: On test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_hash
from "airflow"."gold"."customer_360"
where customer_hash is null



  
  
      
    ) dbt_internal_test
[0m15:04:09.521167 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1: ROLLBACK
[0m15:04:09.521645 [debug] [Thread-3 (]: SQL status: BEGIN in 0.003 seconds
[0m15:04:09.522025 [debug] [Thread-1 (]: On test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1: Close
[0m15:04:09.522279 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:04:09.522479 [debug] [Thread-3 (]: Using postgres connection "test.elt_assignment.unique_customer_360_customer_hash.14c41e246e"
[0m15:04:09.522949 [info ] [Thread-1 (]: 5 of 7 PASS accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_  [[32mPASS[0m in 0.04s]
[0m15:04:09.523999 [debug] [Thread-2 (]: On test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b: ROLLBACK
[0m15:04:09.524340 [debug] [Thread-3 (]: On test.elt_assignment.unique_customer_360_customer_hash.14c41e246e: /* {"app": "dbt", "dbt_version": "1.10.11", "profile_name": "elt_assignment", "target_name": "dev", "node_id": "test.elt_assignment.unique_customer_360_customer_hash.14c41e246e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    customer_hash as unique_field,
    count(*) as n_records

from "airflow"."gold"."customer_360"
where customer_hash is not null
group by customer_hash
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:04:09.524743 [debug] [Thread-1 (]: Finished running node test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1
[0m15:04:09.525148 [debug] [Thread-2 (]: On test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b: Close
[0m15:04:09.525825 [info ] [Thread-2 (]: 6 of 7 PASS not_null_customer_360_customer_hash ................................ [[32mPASS[0m in 0.04s]
[0m15:04:09.526510 [debug] [Thread-2 (]: Finished running node test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b
[0m15:04:09.528537 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:04:09.529493 [debug] [Thread-3 (]: On test.elt_assignment.unique_customer_360_customer_hash.14c41e246e: ROLLBACK
[0m15:04:09.529860 [debug] [Thread-3 (]: On test.elt_assignment.unique_customer_360_customer_hash.14c41e246e: Close
[0m15:04:09.530278 [info ] [Thread-3 (]: 7 of 7 PASS unique_customer_360_customer_hash .................................. [[32mPASS[0m in 0.04s]
[0m15:04:09.530782 [debug] [Thread-3 (]: Finished running node test.elt_assignment.unique_customer_360_customer_hash.14c41e246e
[0m15:04:09.531896 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:09.532225 [debug] [MainThread]: On master: BEGIN
[0m15:04:09.532470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:04:09.535017 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:04:09.535399 [debug] [MainThread]: On master: COMMIT
[0m15:04:09.535722 [debug] [MainThread]: Using postgres connection "master"
[0m15:04:09.535982 [debug] [MainThread]: On master: COMMIT
[0m15:04:09.536368 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:04:09.536625 [debug] [MainThread]: On master: Close
[0m15:04:09.536956 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:04:09.537429 [debug] [MainThread]: Connection 'test.elt_assignment.not_null_customer_360_customer_hash.876bcf8c1b' was properly closed.
[0m15:04:09.537850 [debug] [MainThread]: Connection 'test.elt_assignment.unique_customer_360_customer_hash.14c41e246e' was properly closed.
[0m15:04:09.538270 [debug] [MainThread]: Connection 'test.elt_assignment.accepted_values_customer_360_tenure_band__New_3m___4_12m__12_24m__24_36m__36m_.98fb1653c1' was properly closed.
[0m15:04:09.538516 [debug] [MainThread]: Connection 'test.elt_assignment.accepted_values_customer_360_tech_support_label__Yes__No__Unknown.77f92bb56e' was properly closed.
[0m15:04:09.538909 [info ] [MainThread]: 
[0m15:04:09.539440 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m15:04:09.540489 [debug] [MainThread]: Command end result
[0m15:04:09.565674 [debug] [MainThread]: Wrote artifact WritableManifest to ./target/manifest.json
[0m15:04:09.568130 [debug] [MainThread]: Wrote artifact SemanticManifest to ./target/semantic_manifest.json
[0m15:04:09.574180 [debug] [MainThread]: Wrote artifact RunExecutionResult to ./target/run_results.json
[0m15:04:09.574708 [info ] [MainThread]: 
[0m15:04:09.575657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:04:09.576164 [info ] [MainThread]: 
[0m15:04:09.576626 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m15:04:09.577668 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.68683517, "process_in_blocks": "0", "process_kernel_time": 0.166443, "process_mem_max_rss": "126556", "process_out_blocks": "2369", "process_user_time": 1.556501}
[0m15:04:09.578265 [debug] [MainThread]: Command `dbt test` succeeded at 15:04:09.578133 after 0.69 seconds
[0m15:04:09.578975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7e3ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7e00b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0xffff9c7e2270>]}
[0m15:04:09.579459 [debug] [MainThread]: Flushing usage events
[0m15:04:11.253530 [debug] [MainThread]: An error was encountered while trying to flush usage events
